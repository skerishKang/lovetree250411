{"version":3,"file":"CreatePost-BrlQG9QN.js","sources":["../../src/components/CreatePost.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { createPost } from '../features/posts/postsSlice';\r\nimport { RootState } from '../features/store';\r\n\r\nconst CreatePost: React.FC = () => {\r\n  const dispatch = useDispatch();\r\n  const [content, setContent] = useState('');\r\n  const [image, setImage] = useState<File | null>(null);\r\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const { loading } = useSelector((state: RootState) => state.posts);\r\n  const { user } = useSelector((state: RootState) => state.auth);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!content.trim()) return;\r\n\r\n    const formData = new FormData();\r\n    formData.append('content', content);\r\n    if (image) {\r\n      formData.append('image', image);\r\n    }\r\n\r\n    try {\r\n      await dispatch(createPost(formData)).unwrap();\r\n      setContent('');\r\n      setImage(null);\r\n      setPreviewUrl(null);\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n    } catch (error) {\r\n      console.error('게시물 작성 실패:', error);\r\n    }\r\n  };\r\n\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      setImage(file);\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        setPreviewUrl(reader.result as string);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const handleRemoveImage = () => {\r\n    setImage(null);\r\n    setPreviewUrl(null);\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  if (!user) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-md p-4 mb-4\">\r\n      <form onSubmit={handleSubmit}>\r\n        <textarea\r\n          value={content}\r\n          onChange={(e) => setContent(e.target.value)}\r\n          placeholder=\"무슨 생각을 하고 계신가요?\"\r\n          className=\"w-full p-2 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          rows={4}\r\n        />\r\n        {previewUrl && (\r\n          <div className=\"relative mb-4\">\r\n            <img\r\n              src={previewUrl}\r\n              alt=\"미리보기\"\r\n              className=\"w-full rounded-lg\"\r\n              loading=\"lazy\"\r\n            />\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleRemoveImage}\r\n              className=\"absolute top-2 right-2 p-1 bg-black bg-opacity-50 rounded-full text-white hover:bg-opacity-70\"\r\n            >\r\n              <svg\r\n                className=\"w-5 h-5\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M6 18L18 6M6 6l12 12\"\r\n                />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        )}\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center\">\r\n            <input\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              onChange={handleImageChange}\r\n              ref={fileInputRef}\r\n              className=\"hidden\"\r\n              id=\"image-upload\"\r\n            />\r\n            <label\r\n              htmlFor=\"image-upload\"\r\n              className=\"p-2 text-gray-500 hover:text-blue-500 cursor-pointer\"\r\n            >\r\n              <svg\r\n                className=\"w-6 h-6\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\r\n                />\r\n              </svg>\r\n            </label>\r\n          </div>\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loading || !content.trim()}\r\n            className=\"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-300\"\r\n          >\r\n            {loading ? '게시 중...' : '게시하기'}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CreatePost; "],"names":["CreatePost","dispatch","useDispatch","content","setContent","useState","image","setImage","previewUrl","setPreviewUrl","fileInputRef","useRef","loading","useSelector","state","user","handleSubmit","e","formData","createPost","error","handleImageChange","file","_a","reader","handleRemoveImage","jsxs","jsx"],"mappings":"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"}
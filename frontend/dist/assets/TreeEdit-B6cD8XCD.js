import{r as f,i as wc,R as _,j as C,k as Mn,l as Zt,u as Ec,a as Sc,c as Hs,d as Vs,f as Nc,g as ze,e as Cc,m as Ti,n as $i}from"./index-Bv4-c3_I.js";import{s as _c}from"./authSelectors-BIIj14MV.js";function Se(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Se(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Bs={exports:{}},Us={},Ys={exports:{}},Xs={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var on=f;function Dc(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tc=typeof Object.is=="function"?Object.is:Dc,$c=on.useState,Rc=on.useEffect,Ac=on.useLayoutEffect,Mc=on.useDebugValue;function Ic(e,t){var n=t(),r=$c({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return Ac(function(){o.value=n,o.getSnapshot=t,qr(o)&&i({inst:o})},[e,n,t]),Rc(function(){return qr(o)&&i({inst:o}),e(function(){qr(o)&&i({inst:o})})},[e]),Mc(n),n}function qr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Tc(e,n)}catch{return!0}}function kc(e,t){return t()}var Pc=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?kc:Ic;Xs.useSyncExternalStore=on.useSyncExternalStore!==void 0?on.useSyncExternalStore:Pc;Ys.exports=Xs;var Lc=Ys.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ir=f,Oc=Lc;function jc(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var zc=typeof Object.is=="function"?Object.is:jc,Fc=Oc.useSyncExternalStore,Hc=Ir.useRef,Vc=Ir.useEffect,Bc=Ir.useMemo,Uc=Ir.useDebugValue;Us.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=Hc(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=Bc(function(){function l(h){if(!u){if(u=!0,c=h,h=r(h),o!==void 0&&s.hasValue){var v=s.value;if(o(v,h))return d=v}return d=h}if(v=d,zc(c,h))return v;var p=r(h);return o!==void 0&&o(v,p)?(c=h,v):(c=h,d=p)}var u=!1,c,d,g=n===void 0?null:n;return[function(){return l(t())},g===null?void 0:function(){return l(g())}]},[t,n,r,o]);var a=Fc(e,i[0],i[1]);return Vc(function(){s.hasValue=!0,s.value=a},[a]),Uc(a),a};Bs.exports=Us;var Yc=Bs.exports;const Xc=wc(Yc),Wc={},Ri=e=>{let t;const n=new Set,r=(c,d)=>{const g=typeof c=="function"?c(t):c;if(!Object.is(g,t)){const h=t;t=d??(typeof g!="object"||g===null)?g:Object.assign({},t,g),n.forEach(v=>v(t,h))}},o=()=>t,l={setState:r,getState:o,getInitialState:()=>u,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(Wc?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,o,l);return l},qc=e=>e?Ri(e):Ri,{useDebugValue:Gc}=_,{useSyncExternalStoreWithSelector:Kc}=Xc,Zc=e=>e;function Ws(e,t=Zc,n){const r=Kc(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Gc(r),r}const Ai=(e,t)=>{const n=qc(e),r=(o,i=t)=>Ws(n,o,i);return Object.assign(r,n),r},Qc=(e,t)=>e?Ai(e,t):Ai;function xe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var Jc={value:()=>{}};function kr(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ur(n)}function ur(e){this._=e}function eu(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ur.prototype=kr.prototype={constructor:ur,on:function(e,t){var n=this._,r=eu(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=tu(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=Mi(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Mi(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ur(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function tu(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function Mi(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Jc,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var yo="http://www.w3.org/1999/xhtml";const Ii={svg:"http://www.w3.org/2000/svg",xhtml:yo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Pr(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ii.hasOwnProperty(t)?{space:Ii[t],local:e}:e}function nu(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===yo&&t.documentElement.namespaceURI===yo?t.createElement(e):t.createElementNS(n,e)}}function ru(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function qs(e){var t=Pr(e);return(t.local?ru:nu)(t)}function ou(){}function Xo(e){return e==null?ou:function(){return this.querySelector(e)}}function iu(e){typeof e!="function"&&(e=Xo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),l,u,c=0;c<s;++c)(l=i[c])&&(u=e.call(l,l.__data__,c,i))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new Ae(r,this._parents)}function su(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function au(){return[]}function Gs(e){return e==null?au:function(){return this.querySelectorAll(e)}}function lu(e){return function(){return su(e.apply(this,arguments))}}function cu(e){typeof e=="function"?e=lu(e):e=Gs(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,u=0;u<a;++u)(l=s[u])&&(r.push(e.call(l,l.__data__,u,s)),o.push(l));return new Ae(r,o)}function Ks(e){return function(){return this.matches(e)}}function Zs(e){return function(t){return t.matches(e)}}var uu=Array.prototype.find;function du(e){return function(){return uu.call(this.children,e)}}function fu(){return this.firstElementChild}function hu(e){return this.select(e==null?fu:du(typeof e=="function"?e:Zs(e)))}var gu=Array.prototype.filter;function pu(){return Array.from(this.children)}function mu(e){return function(){return gu.call(this.children,e)}}function yu(e){return this.selectAll(e==null?pu:mu(typeof e=="function"?e:Zs(e)))}function vu(e){typeof e!="function"&&(e=Ks(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,u=0;u<s;++u)(l=i[u])&&e.call(l,l.__data__,u,i)&&a.push(l);return new Ae(r,this._parents)}function Qs(e){return new Array(e.length)}function bu(){return new Ae(this._enter||this._groups.map(Qs),this._parents)}function mr(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}mr.prototype={constructor:mr,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function xu(e){return function(){return e}}function wu(e,t,n,r,o,i){for(var s=0,a,l=t.length,u=i.length;s<u;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new mr(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function Eu(e,t,n,r,o,i,s){var a,l,u=new Map,c=t.length,d=i.length,g=new Array(c),h;for(a=0;a<c;++a)(l=t[a])&&(g[a]=h=s.call(l,l.__data__,a,t)+"",u.has(h)?o[a]=l:u.set(h,l));for(a=0;a<d;++a)h=s.call(e,i[a],a,i)+"",(l=u.get(h))?(r[a]=l,l.__data__=i[a],u.delete(h)):n[a]=new mr(e,i[a]);for(a=0;a<c;++a)(l=t[a])&&u.get(g[a])===l&&(o[a]=l)}function Su(e){return e.__data__}function Nu(e,t){if(!arguments.length)return Array.from(this,Su);var n=t?Eu:wu,r=this._parents,o=this._groups;typeof e!="function"&&(e=xu(e));for(var i=o.length,s=new Array(i),a=new Array(i),l=new Array(i),u=0;u<i;++u){var c=r[u],d=o[u],g=d.length,h=Cu(e.call(c,c&&c.__data__,u,r)),v=h.length,p=a[u]=new Array(v),y=s[u]=new Array(v),b=l[u]=new Array(g);n(c,d,p,y,b,h,t);for(var w=0,E=0,x,R;w<v;++w)if(x=p[w]){for(w>=E&&(E=w+1);!(R=y[E])&&++E<v;);x._next=R||null}}return s=new Ae(s,r),s._enter=a,s._exit=l,s}function Cu(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function _u(){return new Ae(this._exit||this._groups.map(Qs),this._parents)}function Du(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Tu(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var u=n[l],c=r[l],d=u.length,g=a[l]=new Array(d),h,v=0;v<d;++v)(h=u[v]||c[v])&&(g[v]=h);for(;l<o;++l)a[l]=n[l];return new Ae(a,this._parents)}function $u(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Ru(e){e||(e=Au);function t(d,g){return d&&g?e(d.__data__,g.__data__):!d-!g}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,l=o[i]=new Array(a),u,c=0;c<a;++c)(u=s[c])&&(l[c]=u);l.sort(t)}return new Ae(o,this._parents).order()}function Au(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Mu(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Iu(){return Array.from(this)}function ku(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Pu(){let e=0;for(const t of this)++e;return e}function Lu(){return!this.node()}function Ou(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function ju(e){return function(){this.removeAttribute(e)}}function zu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Fu(e,t){return function(){this.setAttribute(e,t)}}function Hu(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Vu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Bu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Uu(e,t){var n=Pr(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?zu:ju:typeof t=="function"?n.local?Bu:Vu:n.local?Hu:Fu)(n,t))}function Js(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Yu(e){return function(){this.style.removeProperty(e)}}function Xu(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Wu(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function qu(e,t,n){return arguments.length>1?this.each((t==null?Yu:typeof t=="function"?Wu:Xu)(e,t,n??"")):sn(this.node(),e)}function sn(e,t){return e.style.getPropertyValue(t)||Js(e).getComputedStyle(e,null).getPropertyValue(t)}function Gu(e){return function(){delete this[e]}}function Ku(e,t){return function(){this[e]=t}}function Zu(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Qu(e,t){return arguments.length>1?this.each((t==null?Gu:typeof t=="function"?Zu:Ku)(e,t)):this.node()[e]}function ea(e){return e.trim().split(/^|\s+/)}function Wo(e){return e.classList||new ta(e)}function ta(e){this._node=e,this._names=ea(e.getAttribute("class")||"")}ta.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function na(e,t){for(var n=Wo(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function ra(e,t){for(var n=Wo(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Ju(e){return function(){na(this,e)}}function ed(e){return function(){ra(this,e)}}function td(e,t){return function(){(t.apply(this,arguments)?na:ra)(this,e)}}function nd(e,t){var n=ea(e+"");if(arguments.length<2){for(var r=Wo(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?td:t?Ju:ed)(n,t))}function rd(){this.textContent=""}function od(e){return function(){this.textContent=e}}function id(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function sd(e){return arguments.length?this.each(e==null?rd:(typeof e=="function"?id:od)(e)):this.node().textContent}function ad(){this.innerHTML=""}function ld(e){return function(){this.innerHTML=e}}function cd(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ud(e){return arguments.length?this.each(e==null?ad:(typeof e=="function"?cd:ld)(e)):this.node().innerHTML}function dd(){this.nextSibling&&this.parentNode.appendChild(this)}function fd(){return this.each(dd)}function hd(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gd(){return this.each(hd)}function pd(e){var t=typeof e=="function"?e:qs(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function md(){return null}function yd(e,t){var n=typeof e=="function"?e:qs(e),r=t==null?md:typeof t=="function"?t:Xo(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function vd(){var e=this.parentNode;e&&e.removeChild(this)}function bd(){return this.each(vd)}function xd(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wd(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ed(e){return this.select(e?wd:xd)}function Sd(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Nd(e){return function(t){e.call(this,t,this.__data__)}}function Cd(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function _d(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Dd(e,t,n){return function(){var r=this.__on,o,i=Nd(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function Td(e,t,n){var r=Cd(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(o=0,c=a[l];o<i;++o)if((s=r[o]).type===c.type&&s.name===c.name)return c.value}return}for(a=t?Dd:_d,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function oa(e,t,n){var r=Js(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function $d(e,t){return function(){return oa(this,e,t)}}function Rd(e,t){return function(){return oa(this,e,t.apply(this,arguments))}}function Ad(e,t){return this.each((typeof t=="function"?Rd:$d)(e,t))}function*Md(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var ia=[null];function Ae(e,t){this._groups=e,this._parents=t}function Vn(){return new Ae([[document.documentElement]],ia)}function Id(){return this}Ae.prototype=Vn.prototype={constructor:Ae,select:iu,selectAll:cu,selectChild:hu,selectChildren:yu,filter:vu,data:Nu,enter:bu,exit:_u,join:Du,merge:Tu,selection:Id,order:$u,sort:Ru,call:Mu,nodes:Iu,node:ku,size:Pu,empty:Lu,each:Ou,attr:Uu,style:qu,property:Qu,classed:nd,text:sd,html:ud,raise:fd,lower:gd,append:pd,insert:yd,remove:bd,clone:Ed,datum:Sd,on:Td,dispatch:Ad,[Symbol.iterator]:Md};function We(e){return typeof e=="string"?new Ae([[document.querySelector(e)]],[document.documentElement]):new Ae([[e]],ia)}function kd(e){let t;for(;t=e.sourceEvent;)e=t;return e}function rt(e,t){if(e=kd(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Pd={passive:!1},In={capture:!0,passive:!1};function Gr(e){e.stopImmediatePropagation()}function Jt(e){e.preventDefault(),e.stopImmediatePropagation()}function sa(e){var t=e.document.documentElement,n=We(e).on("dragstart.drag",Jt,In);"onselectstart"in t?n.on("selectstart.drag",Jt,In):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function aa(e,t){var n=e.document.documentElement,r=We(e).on("dragstart.drag",null);t&&(r.on("click.drag",Jt,In),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Zn=e=>()=>e;function vo(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}vo.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Ld(e){return!e.ctrlKey&&!e.button}function Od(){return this.parentNode}function jd(e,t){return t??{x:e.x,y:e.y}}function zd(){return navigator.maxTouchPoints||"ontouchstart"in this}function Fd(){var e=Ld,t=Od,n=jd,r=zd,o={},i=kr("start","drag","end"),s=0,a,l,u,c,d=0;function g(x){x.on("mousedown.drag",h).filter(r).on("touchstart.drag",y).on("touchmove.drag",b,Pd).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(x,R){if(!(c||!e.call(this,x,R))){var $=E(this,t.call(this,x,R),x,R,"mouse");$&&(We(x.view).on("mousemove.drag",v,In).on("mouseup.drag",p,In),sa(x.view),Gr(x),u=!1,a=x.clientX,l=x.clientY,$("start",x))}}function v(x){if(Jt(x),!u){var R=x.clientX-a,$=x.clientY-l;u=R*R+$*$>d}o.mouse("drag",x)}function p(x){We(x.view).on("mousemove.drag mouseup.drag",null),aa(x.view,u),Jt(x),o.mouse("end",x)}function y(x,R){if(e.call(this,x,R)){var $=x.changedTouches,I=t.call(this,x,R),k=$.length,A,z;for(A=0;A<k;++A)(z=E(this,I,x,R,$[A].identifier,$[A]))&&(Gr(x),z("start",x,$[A]))}}function b(x){var R=x.changedTouches,$=R.length,I,k;for(I=0;I<$;++I)(k=o[R[I].identifier])&&(Jt(x),k("drag",x,R[I]))}function w(x){var R=x.changedTouches,$=R.length,I,k;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),I=0;I<$;++I)(k=o[R[I].identifier])&&(Gr(x),k("end",x,R[I]))}function E(x,R,$,I,k,A){var z=i.copy(),P=rt(A||$,R),B,H,m;if((m=n.call(x,new vo("beforestart",{sourceEvent:$,target:g,identifier:k,active:s,x:P[0],y:P[1],dx:0,dy:0,dispatch:z}),I))!=null)return B=m.x-P[0]||0,H=m.y-P[1]||0,function T(S,D,L){var N=P,M;switch(S){case"start":o[k]=T,M=s++;break;case"end":delete o[k],--s;case"drag":P=rt(L||D,R),M=s;break}z.call(S,x,new vo(S,{sourceEvent:D,subject:m,target:g,identifier:k,active:M,x:P[0]+B,y:P[1]+H,dx:P[0]-N[0],dy:P[1]-N[1],dispatch:z}),I)}}return g.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Zn(!!x),g):e},g.container=function(x){return arguments.length?(t=typeof x=="function"?x:Zn(x),g):t},g.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Zn(x),g):n},g.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Zn(!!x),g):r},g.on=function(){var x=i.on.apply(i,arguments);return x===i?g:x},g.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,g):Math.sqrt(d)},g}function qo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function la(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Bn(){}var kn=.7,yr=1/kn,en="\\s*([+-]?\\d+)\\s*",Pn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Hd=/^#([0-9a-f]{3,8})$/,Vd=new RegExp(`^rgb\\(${en},${en},${en}\\)$`),Bd=new RegExp(`^rgb\\(${ot},${ot},${ot}\\)$`),Ud=new RegExp(`^rgba\\(${en},${en},${en},${Pn}\\)$`),Yd=new RegExp(`^rgba\\(${ot},${ot},${ot},${Pn}\\)$`),Xd=new RegExp(`^hsl\\(${Pn},${ot},${ot}\\)$`),Wd=new RegExp(`^hsla\\(${Pn},${ot},${ot},${Pn}\\)$`),ki={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qo(Bn,Ln,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Pi,formatHex:Pi,formatHex8:qd,formatHsl:Gd,formatRgb:Li,toString:Li});function Pi(){return this.rgb().formatHex()}function qd(){return this.rgb().formatHex8()}function Gd(){return ca(this).formatHsl()}function Li(){return this.rgb().formatRgb()}function Ln(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Hd.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Oi(t):n===3?new De(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Vd.exec(e))?new De(t[1],t[2],t[3],1):(t=Bd.exec(e))?new De(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ud.exec(e))?Qn(t[1],t[2],t[3],t[4]):(t=Yd.exec(e))?Qn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Xd.exec(e))?Fi(t[1],t[2]/100,t[3]/100,1):(t=Wd.exec(e))?Fi(t[1],t[2]/100,t[3]/100,t[4]):ki.hasOwnProperty(e)?Oi(ki[e]):e==="transparent"?new De(NaN,NaN,NaN,0):null}function Oi(e){return new De(e>>16&255,e>>8&255,e&255,1)}function Qn(e,t,n,r){return r<=0&&(e=t=n=NaN),new De(e,t,n,r)}function Kd(e){return e instanceof Bn||(e=Ln(e)),e?(e=e.rgb(),new De(e.r,e.g,e.b,e.opacity)):new De}function bo(e,t,n,r){return arguments.length===1?Kd(e):new De(e,t,n,r??1)}function De(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}qo(De,bo,la(Bn,{brighter(e){return e=e==null?yr:Math.pow(yr,e),new De(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?kn:Math.pow(kn,e),new De(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new De(Bt(this.r),Bt(this.g),Bt(this.b),vr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ji,formatHex:ji,formatHex8:Zd,formatRgb:zi,toString:zi}));function ji(){return`#${Ft(this.r)}${Ft(this.g)}${Ft(this.b)}`}function Zd(){return`#${Ft(this.r)}${Ft(this.g)}${Ft(this.b)}${Ft((isNaN(this.opacity)?1:this.opacity)*255)}`}function zi(){const e=vr(this.opacity);return`${e===1?"rgb(":"rgba("}${Bt(this.r)}, ${Bt(this.g)}, ${Bt(this.b)}${e===1?")":`, ${e})`}`}function vr(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Bt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ft(e){return e=Bt(e),(e<16?"0":"")+e.toString(16)}function Fi(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new qe(e,t,n,r)}function ca(e){if(e instanceof qe)return new qe(e.h,e.s,e.l,e.opacity);if(e instanceof Bn||(e=Ln(e)),!e)return new qe;if(e instanceof qe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new qe(s,a,l,e.opacity)}function Qd(e,t,n,r){return arguments.length===1?ca(e):new qe(e,t,n,r??1)}function qe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}qo(qe,Qd,la(Bn,{brighter(e){return e=e==null?yr:Math.pow(yr,e),new qe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?kn:Math.pow(kn,e),new qe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new De(Kr(e>=240?e-240:e+120,o,r),Kr(e,o,r),Kr(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new qe(Hi(this.h),Jn(this.s),Jn(this.l),vr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=vr(this.opacity);return`${e===1?"hsl(":"hsla("}${Hi(this.h)}, ${Jn(this.s)*100}%, ${Jn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Hi(e){return e=(e||0)%360,e<0?e+360:e}function Jn(e){return Math.max(0,Math.min(1,e||0))}function Kr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const ua=e=>()=>e;function Jd(e,t){return function(n){return e+n*t}}function ef(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function tf(e){return(e=+e)==1?da:function(t,n){return n-t?ef(t,n,e):ua(isNaN(t)?n:t)}}function da(e,t){var n=t-e;return n?Jd(e,n):ua(isNaN(e)?t:e)}const Vi=function e(t){var n=tf(t);function r(o,i){var s=n((o=bo(o)).r,(i=bo(i)).r),a=n(o.g,i.g),l=n(o.b,i.b),u=da(o.opacity,i.opacity);return function(c){return o.r=s(c),o.g=a(c),o.b=l(c),o.opacity=u(c),o+""}}return r.gamma=e,r}(1);function Nt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var xo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Zr=new RegExp(xo.source,"g");function nf(e){return function(){return e}}function rf(e){return function(t){return e(t)+""}}function of(e,t){var n=xo.lastIndex=Zr.lastIndex=0,r,o,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=xo.exec(e))&&(o=Zr.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:Nt(r,o)})),n=Zr.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?rf(l[0].x):nf(t):(t=l.length,function(u){for(var c=0,d;c<t;++c)a[(d=l[c]).i]=d.x(u);return a.join("")})}var Bi=180/Math.PI,wo={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function fa(e,t,n,r,o,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*Bi,skewX:Math.atan(l)*Bi,scaleX:s,scaleY:a}}var er;function sf(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?wo:fa(t.a,t.b,t.c,t.d,t.e,t.f)}function af(e){return e==null||(er||(er=document.createElementNS("http://www.w3.org/2000/svg","g")),er.setAttribute("transform",e),!(e=er.transform.baseVal.consolidate()))?wo:(e=e.matrix,fa(e.a,e.b,e.c,e.d,e.e,e.f))}function ha(e,t,n,r){function o(u){return u.length?u.pop()+" ":""}function i(u,c,d,g,h,v){if(u!==d||c!==g){var p=h.push("translate(",null,t,null,n);v.push({i:p-4,x:Nt(u,d)},{i:p-2,x:Nt(c,g)})}else(d||g)&&h.push("translate("+d+t+g+n)}function s(u,c,d,g){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),g.push({i:d.push(o(d)+"rotate(",null,r)-2,x:Nt(u,c)})):c&&d.push(o(d)+"rotate("+c+r)}function a(u,c,d,g){u!==c?g.push({i:d.push(o(d)+"skewX(",null,r)-2,x:Nt(u,c)}):c&&d.push(o(d)+"skewX("+c+r)}function l(u,c,d,g,h,v){if(u!==d||c!==g){var p=h.push(o(h)+"scale(",null,",",null,")");v.push({i:p-4,x:Nt(u,d)},{i:p-2,x:Nt(c,g)})}else(d!==1||g!==1)&&h.push(o(h)+"scale("+d+","+g+")")}return function(u,c){var d=[],g=[];return u=e(u),c=e(c),i(u.translateX,u.translateY,c.translateX,c.translateY,d,g),s(u.rotate,c.rotate,d,g),a(u.skewX,c.skewX,d,g),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,g),u=c=null,function(h){for(var v=-1,p=g.length,y;++v<p;)d[(y=g[v]).i]=y.x(h);return d.join("")}}}var lf=ha(sf,"px, ","px)","deg)"),cf=ha(af,", ",")",")"),uf=1e-12;function Ui(e){return((e=Math.exp(e))+1/e)/2}function df(e){return((e=Math.exp(e))-1/e)/2}function ff(e){return((e=Math.exp(2*e))-1)/(e+1)}const hf=function e(t,n,r){function o(i,s){var a=i[0],l=i[1],u=i[2],c=s[0],d=s[1],g=s[2],h=c-a,v=d-l,p=h*h+v*v,y,b;if(p<uf)b=Math.log(g/u)/t,y=function(I){return[a+I*h,l+I*v,u*Math.exp(t*I*b)]};else{var w=Math.sqrt(p),E=(g*g-u*u+r*p)/(2*u*n*w),x=(g*g-u*u-r*p)/(2*g*n*w),R=Math.log(Math.sqrt(E*E+1)-E),$=Math.log(Math.sqrt(x*x+1)-x);b=($-R)/t,y=function(I){var k=I*b,A=Ui(R),z=u/(n*w)*(A*ff(t*k+R)-df(R));return[a+z*h,l+z*v,u*A/Ui(t*k+R)]}}return y.duration=b*1e3*t/Math.SQRT2,y}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},o}(Math.SQRT2,2,4);var an=0,Cn=0,vn=0,ga=1e3,br,_n,xr=0,Yt=0,Lr=0,On=typeof performance=="object"&&performance.now?performance:Date,pa=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Go(){return Yt||(pa(gf),Yt=On.now()+Lr)}function gf(){Yt=0}function wr(){this._call=this._time=this._next=null}wr.prototype=ma.prototype={constructor:wr,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Go():+n)+(t==null?0:+t),!this._next&&_n!==this&&(_n?_n._next=this:br=this,_n=this),this._call=e,this._time=n,Eo()},stop:function(){this._call&&(this._call=null,this._time=1/0,Eo())}};function ma(e,t,n){var r=new wr;return r.restart(e,t,n),r}function pf(){Go(),++an;for(var e=br,t;e;)(t=Yt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--an}function Yi(){Yt=(xr=On.now())+Lr,an=Cn=0;try{pf()}finally{an=0,yf(),Yt=0}}function mf(){var e=On.now(),t=e-xr;t>ga&&(Lr-=t,xr=e)}function yf(){for(var e,t=br,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:br=n);_n=e,Eo(r)}function Eo(e){if(!an){Cn&&(Cn=clearTimeout(Cn));var t=e-Yt;t>24?(e<1/0&&(Cn=setTimeout(Yi,e-On.now()-Lr)),vn&&(vn=clearInterval(vn))):(vn||(xr=On.now(),vn=setInterval(mf,ga)),an=1,pa(Yi))}}function Xi(e,t,n){var r=new wr;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var vf=kr("start","end","cancel","interrupt"),bf=[],ya=0,Wi=1,So=2,dr=3,qi=4,No=5,fr=6;function Or(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;xf(e,n,{name:t,index:r,group:o,on:vf,tween:bf,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:ya})}function Ko(e,t){var n=Ze(e,t);if(n.state>ya)throw new Error("too late; already scheduled");return n}function st(e,t){var n=Ze(e,t);if(n.state>dr)throw new Error("too late; already running");return n}function Ze(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function xf(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=ma(i,0,n.time);function i(u){n.state=Wi,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var c,d,g,h;if(n.state!==Wi)return l();for(c in r)if(h=r[c],h.name===n.name){if(h.state===dr)return Xi(s);h.state===qi?(h.state=fr,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=fr,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(Xi(function(){n.state===dr&&(n.state=qi,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=So,n.on.call("start",e,e.__data__,n.index,n.group),n.state===So){for(n.state=dr,o=new Array(g=n.tween.length),c=0,d=-1;c<g;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=h);o.length=d+1}}function a(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=No,1),d=-1,g=o.length;++d<g;)o[d].call(e,c);n.state===No&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=fr,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function hr(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>So&&r.state<No,r.state=fr,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function wf(e){return this.each(function(){hr(this,e)})}function Ef(e,t){var n,r;return function(){var o=st(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function Sf(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=st(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},l=0,u=o.length;l<u;++l)if(o[l].name===t){o[l]=a;break}l===u&&o.push(a)}i.tween=o}}function Nf(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ze(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?Ef:Sf)(n,e,t))}function Zo(e,t,n){var r=e._id;return e.each(function(){var o=st(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Ze(o,r).value[t]}}function va(e,t){var n;return(typeof t=="number"?Nt:t instanceof Ln?Vi:(n=Ln(t))?(t=n,Vi):of)(e,t)}function Cf(e){return function(){this.removeAttribute(e)}}function _f(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Df(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function Tf(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function $f(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function Rf(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function Af(e,t){var n=Pr(e),r=n==="transform"?cf:va;return this.attrTween(e,typeof t=="function"?(n.local?Rf:$f)(n,r,Zo(this,"attr."+e,t)):t==null?(n.local?_f:Cf)(n):(n.local?Tf:Df)(n,r,t))}function Mf(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function If(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function kf(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&If(e,i)),n}return o._value=t,o}function Pf(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Mf(e,i)),n}return o._value=t,o}function Lf(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Pr(e);return this.tween(n,(r.local?kf:Pf)(r,t))}function Of(e,t){return function(){Ko(this,e).delay=+t.apply(this,arguments)}}function jf(e,t){return t=+t,function(){Ko(this,e).delay=t}}function zf(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Of:jf)(t,e)):Ze(this.node(),t).delay}function Ff(e,t){return function(){st(this,e).duration=+t.apply(this,arguments)}}function Hf(e,t){return t=+t,function(){st(this,e).duration=t}}function Vf(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ff:Hf)(t,e)):Ze(this.node(),t).duration}function Bf(e,t){if(typeof t!="function")throw new Error;return function(){st(this,e).ease=t}}function Uf(e){var t=this._id;return arguments.length?this.each(Bf(t,e)):Ze(this.node(),t).ease}function Yf(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;st(this,e).ease=n}}function Xf(e){if(typeof e!="function")throw new Error;return this.each(Yf(this._id,e))}function Wf(e){typeof e!="function"&&(e=Ks(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,u=0;u<s;++u)(l=i[u])&&e.call(l,l.__data__,u,i)&&a.push(l);return new pt(r,this._parents,this._name,this._id)}function qf(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l=t[a],u=n[a],c=l.length,d=s[a]=new Array(c),g,h=0;h<c;++h)(g=l[h]||u[h])&&(d[h]=g);for(;a<r;++a)s[a]=t[a];return new pt(s,this._parents,this._name,this._id)}function Gf(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Kf(e,t,n){var r,o,i=Gf(t)?Ko:st;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function Zf(e,t){var n=this._id;return arguments.length<2?Ze(this.node(),n).on.on(e):this.each(Kf(n,e,t))}function Qf(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Jf(){return this.on("end.remove",Qf(this._id))}function eh(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Xo(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],l=a.length,u=i[s]=new Array(l),c,d,g=0;g<l;++g)(c=a[g])&&(d=e.call(c,c.__data__,g,a))&&("__data__"in c&&(d.__data__=c.__data__),u[g]=d,Or(u[g],t,n,g,u,Ze(c,n)));return new pt(i,this._parents,t,n)}function th(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Gs(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l=r[a],u=l.length,c,d=0;d<u;++d)if(c=l[d]){for(var g=e.call(c,c.__data__,d,l),h,v=Ze(c,n),p=0,y=g.length;p<y;++p)(h=g[p])&&Or(h,t,n,p,g,v);i.push(g),s.push(c)}return new pt(i,s,t,n)}var nh=Vn.prototype.constructor;function rh(){return new nh(this._groups,this._parents)}function oh(e,t){var n,r,o;return function(){var i=sn(this,e),s=(this.style.removeProperty(e),sn(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function ba(e){return function(){this.style.removeProperty(e)}}function ih(e,t,n){var r,o=n+"",i;return function(){var s=sn(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function sh(e,t,n){var r,o,i;return function(){var s=sn(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),sn(this,e))),s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a))}}function ah(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var l=st(this,e),u=l.on,c=l.value[i]==null?a||(a=ba(t)):void 0;(u!==n||o!==c)&&(r=(n=u).copy()).on(s,o=c),l.on=r}}function lh(e,t,n){var r=(e+="")=="transform"?lf:va;return t==null?this.styleTween(e,oh(e,r)).on("end.style."+e,ba(e)):typeof t=="function"?this.styleTween(e,sh(e,r,Zo(this,"style."+e,t))).each(ah(this._id,e)):this.styleTween(e,ih(e,r,t),n).on("end.style."+e,null)}function ch(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function uh(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&ch(e,s,n)),r}return i._value=t,i}function dh(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,uh(e,t,n??""))}function fh(e){return function(){this.textContent=e}}function hh(e){return function(){var t=e(this);this.textContent=t??""}}function gh(e){return this.tween("text",typeof e=="function"?hh(Zo(this,"text",e)):fh(e==null?"":e+""))}function ph(e){return function(t){this.textContent=e.call(this,t)}}function mh(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&ph(o)),t}return r._value=e,r}function yh(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,mh(e))}function vh(){for(var e=this._name,t=this._id,n=xa(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,u=0;u<a;++u)if(l=s[u]){var c=Ze(l,t);Or(l,e,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new pt(r,this._parents,e,n)}function bh(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--o===0&&i()}};n.each(function(){var u=st(this,r),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),u.on=t}),o===0&&i()})}var xh=0;function pt(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function xa(){return++xh}var dt=Vn.prototype;pt.prototype={constructor:pt,select:eh,selectAll:th,selectChild:dt.selectChild,selectChildren:dt.selectChildren,filter:Wf,merge:qf,selection:rh,transition:vh,call:dt.call,nodes:dt.nodes,node:dt.node,size:dt.size,empty:dt.empty,each:dt.each,on:Zf,attr:Af,attrTween:Lf,style:lh,styleTween:dh,text:gh,textTween:yh,remove:Jf,tween:Nf,delay:zf,duration:Vf,ease:Uf,easeVarying:Xf,end:bh,[Symbol.iterator]:dt[Symbol.iterator]};function wh(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Eh={time:null,delay:0,duration:250,ease:wh};function Sh(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Nh(e){var t,n;e instanceof pt?(t=e._id,e=e._name):(t=xa(),(n=Eh).time=Go(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,u=0;u<a;++u)(l=s[u])&&Or(l,e,t,u,s,n||Sh(l,t));return new pt(r,this._parents,e,t)}Vn.prototype.interrupt=wf;Vn.prototype.transition=Nh;const tr=e=>()=>e;function Ch(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function ft(e,t,n){this.k=e,this.x=t,this.y=n}ft.prototype={constructor:ft,scale:function(e){return e===1?this:new ft(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ft(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var At=new ft(1,0,0);ft.prototype;function Qr(e){e.stopImmediatePropagation()}function bn(e){e.preventDefault(),e.stopImmediatePropagation()}function _h(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Dh(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Gi(){return this.__zoom||At}function Th(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function $h(){return navigator.maxTouchPoints||"ontouchstart"in this}function Rh(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Ah(){var e=_h,t=Dh,n=Rh,r=Th,o=$h,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=hf,u=kr("start","zoom","end"),c,d,g,h=500,v=150,p=0,y=10;function b(m){m.property("__zoom",Gi).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",z).filter(o).on("touchstart.zoom",P).on("touchmove.zoom",B).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(m,T,S,D){var L=m.selection?m.selection():m;L.property("__zoom",Gi),m!==L?R(m,T,S,D):L.interrupt().each(function(){$(this,arguments).event(D).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},b.scaleBy=function(m,T,S,D){b.scaleTo(m,function(){var L=this.__zoom.k,N=typeof T=="function"?T.apply(this,arguments):T;return L*N},S,D)},b.scaleTo=function(m,T,S,D){b.transform(m,function(){var L=t.apply(this,arguments),N=this.__zoom,M=S==null?x(L):typeof S=="function"?S.apply(this,arguments):S,F=N.invert(M),O=typeof T=="function"?T.apply(this,arguments):T;return n(E(w(N,O),M,F),L,s)},S,D)},b.translateBy=function(m,T,S,D){b.transform(m,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),s)},null,D)},b.translateTo=function(m,T,S,D,L){b.transform(m,function(){var N=t.apply(this,arguments),M=this.__zoom,F=D==null?x(N):typeof D=="function"?D.apply(this,arguments):D;return n(At.translate(F[0],F[1]).scale(M.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof S=="function"?-S.apply(this,arguments):-S),N,s)},D,L)};function w(m,T){return T=Math.max(i[0],Math.min(i[1],T)),T===m.k?m:new ft(T,m.x,m.y)}function E(m,T,S){var D=T[0]-S[0]*m.k,L=T[1]-S[1]*m.k;return D===m.x&&L===m.y?m:new ft(m.k,D,L)}function x(m){return[(+m[0][0]+ +m[1][0])/2,(+m[0][1]+ +m[1][1])/2]}function R(m,T,S,D){m.on("start.zoom",function(){$(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){$(this,arguments).event(D).end()}).tween("zoom",function(){var L=this,N=arguments,M=$(L,N).event(D),F=t.apply(L,N),O=S==null?x(F):typeof S=="function"?S.apply(L,N):S,X=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),Y=L.__zoom,K=typeof T=="function"?T.apply(L,N):T,J=l(Y.invert(O).concat(X/Y.k),K.invert(O).concat(X/K.k));return function(ee){if(ee===1)ee=K;else{var j=J(ee),U=X/j[2];ee=new ft(U,O[0]-j[0]*U,O[1]-j[1]*U)}M.zoom(null,ee)}})}function $(m,T,S){return!S&&m.__zooming||new I(m,T)}function I(m,T){this.that=m,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(m,T),this.taps=0}I.prototype={event:function(m){return m&&(this.sourceEvent=m),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(m,T){return this.mouse&&m!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&m!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&m!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(m){var T=We(this.that).datum();u.call(m,this.that,new Ch(m,{sourceEvent:this.sourceEvent,target:b,transform:this.that.__zoom,dispatch:u}),T)}};function k(m,...T){if(!e.apply(this,arguments))return;var S=$(this,T).event(m),D=this.__zoom,L=Math.max(i[0],Math.min(i[1],D.k*Math.pow(2,r.apply(this,arguments)))),N=rt(m);if(S.wheel)(S.mouse[0][0]!==N[0]||S.mouse[0][1]!==N[1])&&(S.mouse[1]=D.invert(S.mouse[0]=N)),clearTimeout(S.wheel);else{if(D.k===L)return;S.mouse=[N,D.invert(N)],hr(this),S.start()}bn(m),S.wheel=setTimeout(M,v),S.zoom("mouse",n(E(w(D,L),S.mouse[0],S.mouse[1]),S.extent,s));function M(){S.wheel=null,S.end()}}function A(m,...T){if(g||!e.apply(this,arguments))return;var S=m.currentTarget,D=$(this,T,!0).event(m),L=We(m.view).on("mousemove.zoom",O,!0).on("mouseup.zoom",X,!0),N=rt(m,S),M=m.clientX,F=m.clientY;sa(m.view),Qr(m),D.mouse=[N,this.__zoom.invert(N)],hr(this),D.start();function O(Y){if(bn(Y),!D.moved){var K=Y.clientX-M,J=Y.clientY-F;D.moved=K*K+J*J>p}D.event(Y).zoom("mouse",n(E(D.that.__zoom,D.mouse[0]=rt(Y,S),D.mouse[1]),D.extent,s))}function X(Y){L.on("mousemove.zoom mouseup.zoom",null),aa(Y.view,D.moved),bn(Y),D.event(Y).end()}}function z(m,...T){if(e.apply(this,arguments)){var S=this.__zoom,D=rt(m.changedTouches?m.changedTouches[0]:m,this),L=S.invert(D),N=S.k*(m.shiftKey?.5:2),M=n(E(w(S,N),D,L),t.apply(this,T),s);bn(m),a>0?We(this).transition().duration(a).call(R,M,D,m):We(this).call(b.transform,M,D,m)}}function P(m,...T){if(e.apply(this,arguments)){var S=m.touches,D=S.length,L=$(this,T,m.changedTouches.length===D).event(m),N,M,F,O;for(Qr(m),M=0;M<D;++M)F=S[M],O=rt(F,this),O=[O,this.__zoom.invert(O),F.identifier],L.touch0?!L.touch1&&L.touch0[2]!==O[2]&&(L.touch1=O,L.taps=0):(L.touch0=O,N=!0,L.taps=1+!!c);c&&(c=clearTimeout(c)),N&&(L.taps<2&&(d=O[0],c=setTimeout(function(){c=null},h)),hr(this),L.start())}}function B(m,...T){if(this.__zooming){var S=$(this,T).event(m),D=m.changedTouches,L=D.length,N,M,F,O;for(bn(m),N=0;N<L;++N)M=D[N],F=rt(M,this),S.touch0&&S.touch0[2]===M.identifier?S.touch0[0]=F:S.touch1&&S.touch1[2]===M.identifier&&(S.touch1[0]=F);if(M=S.that.__zoom,S.touch1){var X=S.touch0[0],Y=S.touch0[1],K=S.touch1[0],J=S.touch1[1],ee=(ee=K[0]-X[0])*ee+(ee=K[1]-X[1])*ee,j=(j=J[0]-Y[0])*j+(j=J[1]-Y[1])*j;M=w(M,Math.sqrt(ee/j)),F=[(X[0]+K[0])/2,(X[1]+K[1])/2],O=[(Y[0]+J[0])/2,(Y[1]+J[1])/2]}else if(S.touch0)F=S.touch0[0],O=S.touch0[1];else return;S.zoom("touch",n(E(M,F,O),S.extent,s))}}function H(m,...T){if(this.__zooming){var S=$(this,T).event(m),D=m.changedTouches,L=D.length,N,M;for(Qr(m),g&&clearTimeout(g),g=setTimeout(function(){g=null},h),N=0;N<L;++N)M=D[N],S.touch0&&S.touch0[2]===M.identifier?delete S.touch0:S.touch1&&S.touch1[2]===M.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(M=rt(M,this),Math.hypot(d[0]-M[0],d[1]-M[1])<y)){var F=We(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return b.wheelDelta=function(m){return arguments.length?(r=typeof m=="function"?m:tr(+m),b):r},b.filter=function(m){return arguments.length?(e=typeof m=="function"?m:tr(!!m),b):e},b.touchable=function(m){return arguments.length?(o=typeof m=="function"?m:tr(!!m),b):o},b.extent=function(m){return arguments.length?(t=typeof m=="function"?m:tr([[+m[0][0],+m[0][1]],[+m[1][0],+m[1][1]]]),b):t},b.scaleExtent=function(m){return arguments.length?(i[0]=+m[0],i[1]=+m[1],b):[i[0],i[1]]},b.translateExtent=function(m){return arguments.length?(s[0][0]=+m[0][0],s[1][0]=+m[1][0],s[0][1]=+m[0][1],s[1][1]=+m[1][1],b):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},b.constrain=function(m){return arguments.length?(n=m,b):n},b.duration=function(m){return arguments.length?(a=+m,b):a},b.interpolate=function(m){return arguments.length?(l=m,b):l},b.on=function(){var m=u.on.apply(u,arguments);return m===u?b:m},b.clickDistance=function(m){return arguments.length?(p=(m=+m)*m,b):Math.sqrt(p)},b.tapDistance=function(m){return arguments.length?(y=+m,b):y},b}const jr=f.createContext(null),Mh=jr.Provider,mt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},wa=mt.error001();function ce(e,t){const n=f.useContext(jr);if(n===null)throw new Error(wa);return Ws(n,e,t)}const me=()=>{const e=f.useContext(jr);if(e===null)throw new Error(wa);return f.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Ih=e=>e.userSelectionActive?"none":"all";function Qo({position:e,children:t,className:n,style:r,...o}){const i=ce(Ih),s=`${e}`.split("-");return _.createElement("div",{className:Se(["react-flow__panel",n,...s]),style:{...r,pointerEvents:i},...o},t)}function kh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:_.createElement(Qo,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},_.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Ph=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:u,...c})=>{const d=f.useRef(null),[g,h]=f.useState({x:0,y:0,width:0,height:0}),v=Se(["react-flow__edge-textwrapper",u]);return f.useEffect(()=>{if(d.current){const p=d.current.getBBox();h({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),typeof n>"u"||!n?null:_.createElement("g",{transform:`translate(${e-g.width/2} ${t-g.height/2})`,className:v,visibility:g.width?"visible":"hidden",...c},o&&_.createElement("rect",{width:g.width+2*s[0],x:-s[0],y:-s[1],height:g.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),_.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:d,style:r},n),l)};var Lh=f.memo(Ph);const Jo=e=>({width:e.offsetWidth,height:e.offsetHeight}),ln=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ei=(e={x:0,y:0},t)=>({x:ln(e.x,t[0][0],t[1][0]),y:ln(e.y,t[0][1],t[1][1])}),Ki=(e,t,n)=>e<t?ln(Math.abs(e-t),1,50)/50:e>n?-ln(Math.abs(e-n),1,50)/50:0,Ea=(e,t)=>{const n=Ki(e.x,35,t.width-35)*20,r=Ki(e.y,35,t.height-35)*20;return[n,r]},Sa=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Oh=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ti=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),jh=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Zi=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Co=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},zh=e=>He(e.width)&&He(e.height)&&He(e.x)&&He(e.y),He=e=>!isNaN(e)&&isFinite(e),ue=Symbol.for("internals"),Na=["Enter"," ","Escape"],Fh=(e,t)=>{},Hh=e=>"nativeEvent"in e;function _o(e){var o,i;const t=Hh(e)?e.nativeEvent:e,n=((i=(o=t.composedPath)==null?void 0:o.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const Ca=e=>"clientX"in e,Mt=(e,t)=>{var i,s;const n=Ca(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,o=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},Er=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Un=({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:g,interactionWidth:h=20})=>_.createElement(_.Fragment,null,_.createElement("path",{id:e,style:c,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:g}),h&&_.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),o&&He(n)&&He(r)?_.createElement(Lh,{x:n,y:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u}):null);Un.displayName="BaseEdge";function xn(e,t,n){return n===void 0?n:r=>{const o=t().edges.find(i=>i.id===e);o&&n(r,{...o})}}function _a({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function Da({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const l=e*.125+o*.375+s*.375+n*.125,u=t*.125+i*.375+a*.375+r*.125,c=Math.abs(l-e),d=Math.abs(u-t);return[l,u,c,d]}var It;(function(e){e.Strict="strict",e.Loose="loose"})(It||(It={}));var Ht;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ht||(Ht={}));var jn;(function(e){e.Partial="partial",e.Full="full"})(jn||(jn={}));var Dt;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Dt||(Dt={}));var Sr;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Sr||(Sr={}));var G;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(G||(G={}));function Qi({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===G.Left||e===G.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Ta({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:i=G.Top}){const[s,a]=Qi({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,u]=Qi({pos:i,x1:r,y1:o,x2:e,y2:t}),[c,d,g,h]=Da({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${a} ${l},${u} ${r},${o}`,c,d,g,h]}const ni=f.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=G.Bottom,targetPosition:i=G.Top,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:g,markerEnd:h,markerStart:v,interactionWidth:p})=>{const[y,b,w]=Ta({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i});return _.createElement(Un,{path:y,labelX:b,labelY:w,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:g,markerEnd:h,markerStart:v,interactionWidth:p})});ni.displayName="SimpleBezierEdge";const Ji={[G.Left]:{x:-1,y:0},[G.Right]:{x:1,y:0},[G.Top]:{x:0,y:-1},[G.Bottom]:{x:0,y:1}},Vh=({source:e,sourcePosition:t=G.Bottom,target:n})=>t===G.Left||t===G.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},es=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Bh({source:e,sourcePosition:t=G.Bottom,target:n,targetPosition:r=G.Top,center:o,offset:i}){const s=Ji[t],a=Ji[r],l={x:e.x+s.x*i,y:e.y+s.y*i},u={x:n.x+a.x*i,y:n.y+a.y*i},c=Vh({source:l,sourcePosition:t,target:u}),d=c.x!==0?"x":"y",g=c[d];let h=[],v,p;const y={x:0,y:0},b={x:0,y:0},[w,E,x,R]=_a({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[d]*a[d]===-1){v=o.x??w,p=o.y??E;const I=[{x:v,y:l.y},{x:v,y:u.y}],k=[{x:l.x,y:p},{x:u.x,y:p}];s[d]===g?h=d==="x"?I:k:h=d==="x"?k:I}else{const I=[{x:l.x,y:u.y}],k=[{x:u.x,y:l.y}];if(d==="x"?h=s.x===g?k:I:h=s.y===g?I:k,t===r){const H=Math.abs(e[d]-n[d]);if(H<=i){const m=Math.min(i-1,i-H);s[d]===g?y[d]=(l[d]>e[d]?-1:1)*m:b[d]=(u[d]>n[d]?-1:1)*m}}if(t!==r){const H=d==="x"?"y":"x",m=s[d]===a[H],T=l[H]>u[H],S=l[H]<u[H];(s[d]===1&&(!m&&T||m&&S)||s[d]!==1&&(!m&&S||m&&T))&&(h=d==="x"?I:k)}const A={x:l.x+y.x,y:l.y+y.y},z={x:u.x+b.x,y:u.y+b.y},P=Math.max(Math.abs(A.x-h[0].x),Math.abs(z.x-h[0].x)),B=Math.max(Math.abs(A.y-h[0].y),Math.abs(z.y-h[0].y));P>=B?(v=(A.x+z.x)/2,p=h[0].y):(v=h[0].x,p=(A.y+z.y)/2)}return[[e,{x:l.x+y.x,y:l.y+y.y},...h,{x:u.x+b.x,y:u.y+b.y},n],v,p,x,R]}function Uh(e,t,n,r){const o=Math.min(es(e,t)/2,es(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const u=e.x<n.x?-1:1,c=e.y<n.y?1:-1;return`L ${i+o*u},${s}Q ${i},${s} ${i},${s+o*c}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+o*l}Q ${i},${s} ${i+o*a},${s}`}function Do({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:i=G.Top,borderRadius:s=5,centerX:a,centerY:l,offset:u=20}){const[c,d,g,h,v]=Bh({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:l},offset:u});return[c.reduce((y,b,w)=>{let E="";return w>0&&w<c.length-1?E=Uh(c[w-1],b,c[w+1],s):E=`${w===0?"M":"L"}${b.x} ${b.y}`,y+=E,y},""),d,g,h,v]}const zr=f.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,sourcePosition:d=G.Bottom,targetPosition:g=G.Top,markerEnd:h,markerStart:v,pathOptions:p,interactionWidth:y})=>{const[b,w,E]=Do({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:r,targetPosition:g,borderRadius:p==null?void 0:p.borderRadius,offset:p==null?void 0:p.offset});return _.createElement(Un,{path:b,labelX:w,labelY:E,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:h,markerStart:v,interactionWidth:y})});zr.displayName="SmoothStepEdge";const ri=f.memo(e=>{var t;return _.createElement(zr,{...e,pathOptions:f.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});ri.displayName="StepEdge";function Yh({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=_a({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const oi=f.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:g,interactionWidth:h})=>{const[v,p,y]=Yh({sourceX:e,sourceY:t,targetX:n,targetY:r});return _.createElement(Un,{path:v,labelX:p,labelY:y,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:g,interactionWidth:h})});oi.displayName="StraightEdge";function nr(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ts({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case G.Left:return[t-nr(t-r,i),n];case G.Right:return[t+nr(r-t,i),n];case G.Top:return[t,n-nr(n-o,i)];case G.Bottom:return[t,n+nr(o-n,i)]}}function $a({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:i=G.Top,curvature:s=.25}){const[a,l]=ts({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[u,c]=ts({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[d,g,h,v]=Da({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:u,targetControlY:c});return[`M${e},${t} C${a},${l} ${u},${c} ${r},${o}`,d,g,h,v]}const Nr=f.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=G.Bottom,targetPosition:i=G.Top,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:g,markerEnd:h,markerStart:v,pathOptions:p,interactionWidth:y})=>{const[b,w,E]=$a({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i,curvature:p==null?void 0:p.curvature});return _.createElement(Un,{path:b,labelX:w,labelY:E,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:g,markerEnd:h,markerStart:v,interactionWidth:y})});Nr.displayName="BezierEdge";const ii=f.createContext(null),Xh=ii.Provider;ii.Consumer;const Wh=()=>f.useContext(ii),qh=e=>"id"in e&&"source"in e&&"target"in e,Gh=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,To=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,Kh=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Ra=(e,t)=>{if(!e.source||!e.target)return t;let n;return qh(e)?n={...e}:n={...e,id:Gh(e)},Kh(n,t)?t:t.concat(n)},$o=({x:e,y:t},[n,r,o],i,[s,a])=>{const l={x:(e-n)/o,y:(t-r)/o};return i?{x:s*Math.round(l.x/s),y:a*Math.round(l.y/a)}:l},Aa=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),tn=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],o={x:e.position.x-n,y:e.position.y-r};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:o}},si=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const{x:i,y:s}=tn(o,t).positionAbsolute;return Oh(r,ti({x:i,y:s,width:o.width||0,height:o.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return jh(n)},Ma=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1,a=[0,0])=>{const l={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},u=[];return e.forEach(c=>{const{width:d,height:g,selectable:h=!0,hidden:v=!1}=c;if(s&&!h||v)return!1;const{positionAbsolute:p}=tn(c,a),y={x:p.x,y:p.y,width:d||0,height:g||0},b=Co(l,y),w=typeof d>"u"||typeof g>"u"||d===null||g===null,E=i&&b>0,x=(d||0)*(g||0);(w||E||b>=x||c.dragging)&&u.push(c)}),u},Ia=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},ka=(e,t,n,r,o,i=.1)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),l=Math.min(s,a),u=ln(l,r,o),c=e.x+e.width/2,d=e.y+e.height/2,g=t/2-c*u,h=n/2-d*u;return{x:g,y:h,zoom:u}},jt=(e,t=0)=>e.transition().duration(t);function ns(e,t,n,r){return(t[n]||[]).reduce((o,i)=>{var s,a;return`${e.id}-${i.id}-${n}`!==r&&o.push({id:i.id||null,type:n,nodeId:e.id,x:(((s=e.positionAbsolute)==null?void 0:s.x)??0)+i.x+i.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+i.y+i.height/2}),o},[])}function Zh(e,t,n,r,o,i){const{x:s,y:a}=Mt(e),u=t.elementsFromPoint(s,a).find(v=>v.classList.contains("react-flow__handle"));if(u){const v=u.getAttribute("data-nodeid");if(v){const p=ai(void 0,u),y=u.getAttribute("data-handleid"),b=i({nodeId:v,id:y,type:p});if(b){const w=o.find(E=>E.nodeId===v&&E.type===p&&E.id===y);return{handle:{id:y,type:p,nodeId:v,x:(w==null?void 0:w.x)||n.x,y:(w==null?void 0:w.y)||n.y},validHandleResult:b}}}}let c=[],d=1/0;if(o.forEach(v=>{const p=Math.sqrt((v.x-n.x)**2+(v.y-n.y)**2);if(p<=r){const y=i(v);p<=d&&(p<d?c=[{handle:v,validHandleResult:y}]:p===d&&c.push({handle:v,validHandleResult:y}),d=p)}}),!c.length)return{handle:null,validHandleResult:Pa()};if(c.length===1)return c[0];const g=c.some(({validHandleResult:v})=>v.isValid),h=c.some(({handle:v})=>v.type==="target");return c.find(({handle:v,validHandleResult:p})=>h?v.type==="target":g?p.isValid:!0)||c[0]}const Qh={source:null,target:null,sourceHandle:null,targetHandle:null},Pa=()=>({handleDomNode:null,isValid:!1,connection:Qh,endHandle:null});function La(e,t,n,r,o,i,s){const a=o==="target",l=s.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...Pa(),handleDomNode:l};if(l){const c=ai(void 0,l),d=l.getAttribute("data-nodeid"),g=l.getAttribute("data-handleid"),h=l.classList.contains("connectable"),v=l.classList.contains("connectableend"),p={source:a?d:n,sourceHandle:a?g:r,target:a?n:d,targetHandle:a?r:g};u.connection=p,h&&v&&(t===It.Strict?a&&c==="source"||!a&&c==="target":d!==n||g!==r)&&(u.endHandle={nodeId:d,handleId:g,type:c},u.isValid=i(p))}return u}function Jh({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((o,i)=>{if(i[ue]){const{handleBounds:s}=i[ue];let a=[],l=[];s&&(a=ns(i,s,"source",`${t}-${n}-${r}`),l=ns(i,s,"target",`${t}-${n}-${r}`)),o.push(...a,...l)}return o},[])}function ai(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Jr(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function eg(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Oa({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:i,setState:s,isValidConnection:a,edgeUpdaterType:l,onReconnectEnd:u}){const c=Sa(e.target),{connectionMode:d,domNode:g,autoPanOnConnect:h,connectionRadius:v,onConnectStart:p,panBy:y,getNodes:b,cancelConnection:w}=i();let E=0,x;const{x:R,y:$}=Mt(e),I=c==null?void 0:c.elementFromPoint(R,$),k=ai(l,I),A=g==null?void 0:g.getBoundingClientRect();if(!A||!k)return;let z,P=Mt(e,A),B=!1,H=null,m=!1,T=null;const S=Jh({nodes:b(),nodeId:n,handleId:t,handleType:k}),D=()=>{if(!h)return;const[M,F]=Ea(P,A);y({x:M,y:F}),E=requestAnimationFrame(D)};s({connectionPosition:P,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:k,connectionStartHandle:{nodeId:n,handleId:t,type:k},connectionEndHandle:null}),p==null||p(e,{nodeId:n,handleId:t,handleType:k});function L(M){const{transform:F}=i();P=Mt(M,A);const{handle:O,validHandleResult:X}=Zh(M,c,$o(P,F,!1,[1,1]),v,S,Y=>La(Y,d,n,t,o?"target":"source",a,c));if(x=O,B||(D(),B=!0),T=X.handleDomNode,H=X.connection,m=X.isValid,s({connectionPosition:x&&m?Aa({x:x.x,y:x.y},F):P,connectionStatus:eg(!!x,m),connectionEndHandle:X.endHandle}),!x&&!m&&!T)return Jr(z);H.source!==H.target&&T&&(Jr(z),z=T,T.classList.add("connecting","react-flow__handle-connecting"),T.classList.toggle("valid",m),T.classList.toggle("react-flow__handle-valid",m))}function N(M){var F,O;(x||T)&&H&&m&&(r==null||r(H)),(O=(F=i()).onConnectEnd)==null||O.call(F,M),l&&(u==null||u(M)),Jr(z),w(),cancelAnimationFrame(E),B=!1,m=!1,H=null,T=null,c.removeEventListener("mousemove",L),c.removeEventListener("mouseup",N),c.removeEventListener("touchmove",L),c.removeEventListener("touchend",N)}c.addEventListener("mousemove",L),c.addEventListener("mouseup",N),c.addEventListener("touchmove",L),c.addEventListener("touchend",N)}const rs=()=>!0,tg=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),ng=(e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:s}=r;return{connecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n}},ja=f.forwardRef(({type:e="source",position:t=G.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:u,onMouseDown:c,onTouchStart:d,...g},h)=>{var A,z;const v=s||null,p=e==="target",y=me(),b=Wh(),{connectOnClick:w,noPanClassName:E}=ce(tg,xe),{connecting:x,clickConnecting:R}=ce(ng(b,v,e),xe);b||(z=(A=y.getState()).onError)==null||z.call(A,"010",mt.error010());const $=P=>{const{defaultEdgeOptions:B,onConnect:H,hasDefaultEdges:m}=y.getState(),T={...B,...P};if(m){const{edges:S,setEdges:D}=y.getState();D(Ra(T,S))}H==null||H(T),a==null||a(T)},I=P=>{if(!b)return;const B=Ca(P);o&&(B&&P.button===0||!B)&&Oa({event:P,handleId:v,nodeId:b,onConnect:$,isTarget:p,getState:y.getState,setState:y.setState,isValidConnection:n||y.getState().isValidConnection||rs}),B?c==null||c(P):d==null||d(P)},k=P=>{const{onClickConnectStart:B,onClickConnectEnd:H,connectionClickStartHandle:m,connectionMode:T,isValidConnection:S}=y.getState();if(!b||!m&&!o)return;if(!m){B==null||B(P,{nodeId:b,handleId:v,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:b,type:e,handleId:v}});return}const D=Sa(P.target),L=n||S||rs,{connection:N,isValid:M}=La({nodeId:b,id:v,type:e},T,m.nodeId,m.handleId||null,m.type,L,D);M&&$(N),H==null||H(P),y.setState({connectionClickStartHandle:null})};return _.createElement("div",{"data-handleid":v,"data-nodeid":b,"data-handlepos":t,"data-id":`${b}-${v}-${e}`,className:Se(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",E,u,{source:!p,target:p,connectable:r,connectablestart:o,connectableend:i,connecting:R,connectionindicator:r&&(o&&!x||i&&x)}]),onMouseDown:I,onTouchStart:I,onClick:w?k:void 0,ref:h,...g},l)});ja.displayName="Handle";var $t=f.memo(ja);const za=({data:e,isConnectable:t,targetPosition:n=G.Top,sourcePosition:r=G.Bottom})=>_.createElement(_.Fragment,null,_.createElement($t,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,_.createElement($t,{type:"source",position:r,isConnectable:t}));za.displayName="DefaultNode";var Ro=f.memo(za);const Fa=({data:e,isConnectable:t,sourcePosition:n=G.Bottom})=>_.createElement(_.Fragment,null,e==null?void 0:e.label,_.createElement($t,{type:"source",position:n,isConnectable:t}));Fa.displayName="InputNode";var Ha=f.memo(Fa);const Va=({data:e,isConnectable:t,targetPosition:n=G.Top})=>_.createElement(_.Fragment,null,_.createElement($t,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);Va.displayName="OutputNode";var Ba=f.memo(Va);const li=()=>null;li.displayName="GroupNode";const rg=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),rr=e=>e.id;function og(e,t){return xe(e.selectedNodes.map(rr),t.selectedNodes.map(rr))&&xe(e.selectedEdges.map(rr),t.selectedEdges.map(rr))}const Ua=f.memo(({onSelectionChange:e})=>{const t=me(),{selectedNodes:n,selectedEdges:r}=ce(rg,og);return f.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChange.forEach(i=>i(o))},[n,r,e]),null});Ua.displayName="SelectionListener";const ig=e=>!!e.onSelectionChange;function sg({onSelectionChange:e}){const t=ce(ig);return e||t?_.createElement(Ua,{onSelectionChange:e}):null}const ag=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Wt(e,t){f.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function te(e,t,n){f.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const lg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:o,onConnectStart:i,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:c,nodesFocusable:d,edgesFocusable:g,edgesUpdatable:h,elevateNodesOnSelect:v,minZoom:p,maxZoom:y,nodeExtent:b,onNodesChange:w,onEdgesChange:E,elementsSelectable:x,connectionMode:R,snapGrid:$,snapToGrid:I,translateExtent:k,connectOnClick:A,defaultEdgeOptions:z,fitView:P,fitViewOptions:B,onNodesDelete:H,onEdgesDelete:m,onNodeDrag:T,onNodeDragStart:S,onNodeDragStop:D,onSelectionDrag:L,onSelectionDragStart:N,onSelectionDragStop:M,noPanClassName:F,nodeOrigin:O,rfId:X,autoPanOnConnect:Y,autoPanOnNodeDrag:K,onError:J,connectionRadius:ee,isValidConnection:j,nodeDragThreshold:U})=>{const{setNodes:V,setEdges:q,setDefaultNodesAndEdges:W,setMinZoom:Z,setMaxZoom:ne,setTranslateExtent:re,setNodeExtent:le,reset:oe}=ce(ag,xe),Q=me();return f.useEffect(()=>{const ye=r==null?void 0:r.map(ve=>({...ve,...z}));return W(n,ye),()=>{oe()}},[]),te("defaultEdgeOptions",z,Q.setState),te("connectionMode",R,Q.setState),te("onConnect",o,Q.setState),te("onConnectStart",i,Q.setState),te("onConnectEnd",s,Q.setState),te("onClickConnectStart",a,Q.setState),te("onClickConnectEnd",l,Q.setState),te("nodesDraggable",u,Q.setState),te("nodesConnectable",c,Q.setState),te("nodesFocusable",d,Q.setState),te("edgesFocusable",g,Q.setState),te("edgesUpdatable",h,Q.setState),te("elementsSelectable",x,Q.setState),te("elevateNodesOnSelect",v,Q.setState),te("snapToGrid",I,Q.setState),te("snapGrid",$,Q.setState),te("onNodesChange",w,Q.setState),te("onEdgesChange",E,Q.setState),te("connectOnClick",A,Q.setState),te("fitViewOnInit",P,Q.setState),te("fitViewOnInitOptions",B,Q.setState),te("onNodesDelete",H,Q.setState),te("onEdgesDelete",m,Q.setState),te("onNodeDrag",T,Q.setState),te("onNodeDragStart",S,Q.setState),te("onNodeDragStop",D,Q.setState),te("onSelectionDrag",L,Q.setState),te("onSelectionDragStart",N,Q.setState),te("onSelectionDragStop",M,Q.setState),te("noPanClassName",F,Q.setState),te("nodeOrigin",O,Q.setState),te("rfId",X,Q.setState),te("autoPanOnConnect",Y,Q.setState),te("autoPanOnNodeDrag",K,Q.setState),te("onError",J,Q.setState),te("connectionRadius",ee,Q.setState),te("isValidConnection",j,Q.setState),te("nodeDragThreshold",U,Q.setState),Wt(e,V),Wt(t,q),Wt(p,Z),Wt(y,ne),Wt(k,re),Wt(b,le),null},os={display:"none"},cg={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ya="react-flow__node-desc",Xa="react-flow__edge-desc",ug="react-flow__aria-live",dg=e=>e.ariaLiveMessage;function fg({rfId:e}){const t=ce(dg);return _.createElement("div",{id:`${ug}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:cg},t)}function hg({rfId:e,disableKeyboardA11y:t}){return _.createElement(_.Fragment,null,_.createElement("div",{id:`${Ya}-${e}`,style:os},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),_.createElement("div",{id:`${Xa}-${e}`,style:os},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&_.createElement(fg,{rfId:e}))}var zn=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=f.useState(!1),o=f.useRef(!1),i=f.useRef(new Set([])),[s,a]=f.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),c=u.reduce((d,g)=>d.concat(...g),[]);return[u,c]}return[[],[]]},[e]);return f.useEffect(()=>{const l=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||l;if(e!==null){const c=h=>{if(o.current=h.ctrlKey||h.metaKey||h.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&_o(h))return!1;const p=ss(h.code,a);i.current.add(h[p]),is(s,i.current,!1)&&(h.preventDefault(),r(!0))},d=h=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&_o(h))return!1;const p=ss(h.code,a);is(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(h[p]),h.key==="Meta"&&i.current.clear(),o.current=!1},g=()=>{i.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",c),u==null||u.addEventListener("keyup",d),window.addEventListener("blur",g),()=>{u==null||u.removeEventListener("keydown",c),u==null||u.removeEventListener("keyup",d),window.removeEventListener("blur",g)}}},[e,r]),n};function is(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function ss(e,t){return t.includes(e)?"code":"key"}function Wa(e,t,n,r){var a,l;const o=e.parentNode||e.parentId;if(!o)return n;const i=t.get(o),s=tn(i,r);return Wa(i,t,{x:(n.x??0)+s.x,y:(n.y??0)+s.y,z:(((a=i[ue])==null?void 0:a.z)??0)>(n.z??0)?((l=i[ue])==null?void 0:l.z)??0:n.z??0},r)}function qa(e,t,n){e.forEach(r=>{var i;const o=r.parentNode||r.parentId;if(o&&!e.has(o))throw new Error(`Parent node ${o} not found`);if(o||n!=null&&n[r.id]){const{x:s,y:a,z:l}=Wa(r,e,{...r.position,z:((i=r[ue])==null?void 0:i.z)??0},t);r.positionAbsolute={x:s,y:a},r[ue].z=l,n!=null&&n[r.id]&&(r[ue].isParent=!0)}})}function eo(e,t,n,r){const o=new Map,i={},s=r?1e3:0;return e.forEach(a=>{var h;const l=(He(a.zIndex)?a.zIndex:0)+(a.selected?s:0),u=t.get(a.id),c={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},d=a.parentNode||a.parentId;d&&(i[d]=!0);const g=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(c,ue,{enumerable:!1,value:{handleBounds:g||(h=u==null?void 0:u[ue])==null?void 0:h.handleBounds,z:l}}),o.set(a.id,c)}),qa(o,n,i),o}function Ga(e,t={}){const{getNodes:n,width:r,height:o,minZoom:i,maxZoom:s,d3Zoom:a,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:c,nodeOrigin:d}=e(),g=t.initial&&!u&&c;if(a&&l&&(g||!t.initial)){const v=n().filter(y=>{var w;const b=t.includeHiddenNodes?y.width&&y.height:!y.hidden;return(w=t.nodes)!=null&&w.length?b&&t.nodes.some(E=>E.id===y.id):b}),p=v.every(y=>y.width&&y.height);if(v.length>0&&p){const y=si(v,d),{x:b,y:w,zoom:E}=ka(y,r,o,t.minZoom??i,t.maxZoom??s,t.padding??.1),x=At.translate(b,w).scale(E);return typeof t.duration=="number"&&t.duration>0?a.transform(jt(l,t.duration),x):a.transform(l,x),!0}}return!1}function gg(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[ue]:r[ue],selected:n.selected})}),new Map(t)}function pg(e,t){return t.map(n=>{const r=e.find(o=>o.id===n.id);return r&&(n.selected=r.selected),n})}function or({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:i,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:u}=n();e!=null&&e.length&&(l&&r({nodeInternals:gg(e,o)}),s==null||s(e)),t!=null&&t.length&&(u&&r({edges:pg(t,i)}),a==null||a(t))}const qt=()=>{},mg={zoomIn:qt,zoomOut:qt,zoomTo:qt,getZoom:()=>1,setViewport:qt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:qt,fitBounds:qt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},yg=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),vg=()=>{const e=me(),{d3Zoom:t,d3Selection:n}=ce(yg,xe);return f.useMemo(()=>n&&t?{zoomIn:o=>t.scaleBy(jt(n,o==null?void 0:o.duration),1.2),zoomOut:o=>t.scaleBy(jt(n,o==null?void 0:o.duration),1/1.2),zoomTo:(o,i)=>t.scaleTo(jt(n,i==null?void 0:i.duration),o),getZoom:()=>e.getState().transform[2],setViewport:(o,i)=>{const[s,a,l]=e.getState().transform,u=At.translate(o.x??s,o.y??a).scale(o.zoom??l);t.transform(jt(n,i==null?void 0:i.duration),u)},getViewport:()=>{const[o,i,s]=e.getState().transform;return{x:o,y:i,zoom:s}},fitView:o=>Ga(e.getState,o),setCenter:(o,i,s)=>{const{width:a,height:l,maxZoom:u}=e.getState(),c=typeof(s==null?void 0:s.zoom)<"u"?s.zoom:u,d=a/2-o*c,g=l/2-i*c,h=At.translate(d,g).scale(c);t.transform(jt(n,s==null?void 0:s.duration),h)},fitBounds:(o,i)=>{const{width:s,height:a,minZoom:l,maxZoom:u}=e.getState(),{x:c,y:d,zoom:g}=ka(o,s,a,l,u,(i==null?void 0:i.padding)??.1),h=At.translate(c,d).scale(g);t.transform(jt(n,i==null?void 0:i.duration),h)},project:o=>{const{transform:i,snapToGrid:s,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),$o(o,i,s,a)},screenToFlowPosition:o=>{const{transform:i,snapToGrid:s,snapGrid:a,domNode:l}=e.getState();if(!l)return o;const{x:u,y:c}=l.getBoundingClientRect(),d={x:o.x-u,y:o.y-c};return $o(d,i,s,a)},flowToScreenPosition:o=>{const{transform:i,domNode:s}=e.getState();if(!s)return o;const{x:a,y:l}=s.getBoundingClientRect(),u=Aa(o,i);return{x:u.x+a,y:u.y+l}},viewportInitialized:!0}:mg,[t,n])};function ci(){const e=vg(),t=me(),n=f.useCallback(()=>t.getState().getNodes().map(p=>({...p})),[]),r=f.useCallback(p=>t.getState().nodeInternals.get(p),[]),o=f.useCallback(()=>{const{edges:p=[]}=t.getState();return p.map(y=>({...y}))},[]),i=f.useCallback(p=>{const{edges:y=[]}=t.getState();return y.find(b=>b.id===p)},[]),s=f.useCallback(p=>{const{getNodes:y,setNodes:b,hasDefaultNodes:w,onNodesChange:E}=t.getState(),x=y(),R=typeof p=="function"?p(x):p;if(w)b(R);else if(E){const $=R.length===0?x.map(I=>({type:"remove",id:I.id})):R.map(I=>({item:I,type:"reset"}));E($)}},[]),a=f.useCallback(p=>{const{edges:y=[],setEdges:b,hasDefaultEdges:w,onEdgesChange:E}=t.getState(),x=typeof p=="function"?p(y):p;if(w)b(x);else if(E){const R=x.length===0?y.map($=>({type:"remove",id:$.id})):x.map($=>({item:$,type:"reset"}));E(R)}},[]),l=f.useCallback(p=>{const y=Array.isArray(p)?p:[p],{getNodes:b,setNodes:w,hasDefaultNodes:E,onNodesChange:x}=t.getState();if(E){const $=[...b(),...y];w($)}else if(x){const R=y.map($=>({item:$,type:"add"}));x(R)}},[]),u=f.useCallback(p=>{const y=Array.isArray(p)?p:[p],{edges:b=[],setEdges:w,hasDefaultEdges:E,onEdgesChange:x}=t.getState();if(E)w([...b,...y]);else if(x){const R=y.map($=>({item:$,type:"add"}));x(R)}},[]),c=f.useCallback(()=>{const{getNodes:p,edges:y=[],transform:b}=t.getState(),[w,E,x]=b;return{nodes:p().map(R=>({...R})),edges:y.map(R=>({...R})),viewport:{x:w,y:E,zoom:x}}},[]),d=f.useCallback(({nodes:p,edges:y})=>{const{nodeInternals:b,getNodes:w,edges:E,hasDefaultNodes:x,hasDefaultEdges:R,onNodesDelete:$,onEdgesDelete:I,onNodesChange:k,onEdgesChange:A}=t.getState(),z=(p||[]).map(T=>T.id),P=(y||[]).map(T=>T.id),B=w().reduce((T,S)=>{const D=S.parentNode||S.parentId,L=!z.includes(S.id)&&D&&T.find(M=>M.id===D);return(typeof S.deletable=="boolean"?S.deletable:!0)&&(z.includes(S.id)||L)&&T.push(S),T},[]),H=E.filter(T=>typeof T.deletable=="boolean"?T.deletable:!0),m=H.filter(T=>P.includes(T.id));if(B||m){const T=Ia(B,H),S=[...m,...T],D=S.reduce((L,N)=>(L.includes(N.id)||L.push(N.id),L),[]);if((R||x)&&(R&&t.setState({edges:E.filter(L=>!D.includes(L.id))}),x&&(B.forEach(L=>{b.delete(L.id)}),t.setState({nodeInternals:new Map(b)}))),D.length>0&&(I==null||I(S),A&&A(D.map(L=>({id:L,type:"remove"})))),B.length>0&&($==null||$(B),k)){const L=B.map(N=>({id:N.id,type:"remove"}));k(L)}}},[]),g=f.useCallback(p=>{const y=zh(p),b=y?null:t.getState().nodeInternals.get(p.id);return!y&&!b?[null,null,y]:[y?p:Zi(b),b,y]},[]),h=f.useCallback((p,y=!0,b)=>{const[w,E,x]=g(p);return w?(b||t.getState().getNodes()).filter(R=>{if(!x&&(R.id===E.id||!R.positionAbsolute))return!1;const $=Zi(R),I=Co($,w);return y&&I>0||I>=w.width*w.height}):[]},[]),v=f.useCallback((p,y,b=!0)=>{const[w]=g(p);if(!w)return!1;const E=Co(w,y);return b&&E>0||E>=w.width*w.height},[]);return f.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:o,getEdge:i,setNodes:s,setEdges:a,addNodes:l,addEdges:u,toObject:c,deleteElements:d,getIntersectingNodes:h,isNodeIntersecting:v}),[e,n,r,o,i,s,a,l,u,c,d,h,v])}const bg={actInsideInputWithModifier:!1};var xg=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=me(),{deleteElements:r}=ci(),o=zn(e,bg),i=zn(t);f.useEffect(()=>{if(o){const{edges:s,getNodes:a}=n.getState(),l=a().filter(c=>c.selected),u=s.filter(c=>c.selected);r({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[o]),f.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function wg(e){const t=me();f.useEffect(()=>{let n;const r=()=>{var i,s;if(!e.current)return;const o=Jo(e.current);(o.height===0||o.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",mt.error004())),t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const ui={position:"absolute",width:"100%",height:"100%",top:0,left:0},Eg=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ir=e=>({x:e.x,y:e.y,zoom:e.k}),Gt=(e,t)=>e.target.closest(`.${t}`),as=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),ls=e=>{const t=e.ctrlKey&&Er()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Sg=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Ng=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:o=!0,zoomOnPinch:i=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=Ht.Free,zoomOnDoubleClick:u=!0,elementsSelectable:c,panOnDrag:d=!0,defaultViewport:g,translateExtent:h,minZoom:v,maxZoom:p,zoomActivationKeyCode:y,preventScrolling:b=!0,children:w,noWheelClassName:E,noPanClassName:x})=>{const R=f.useRef(),$=me(),I=f.useRef(!1),k=f.useRef(!1),A=f.useRef(null),z=f.useRef({x:0,y:0,zoom:0}),{d3Zoom:P,d3Selection:B,d3ZoomHandler:H,userSelectionActive:m}=ce(Sg,xe),T=zn(y),S=f.useRef(0),D=f.useRef(!1),L=f.useRef();return wg(A),f.useEffect(()=>{if(A.current){const N=A.current.getBoundingClientRect(),M=Ah().scaleExtent([v,p]).translateExtent(h),F=We(A.current).call(M),O=At.translate(g.x,g.y).scale(ln(g.zoom,v,p)),X=[[0,0],[N.width,N.height]],Y=M.constrain()(O,X,h);M.transform(F,Y),M.wheelDelta(ls),$.setState({d3Zoom:M,d3Selection:F,d3ZoomHandler:F.on("wheel.zoom"),transform:[Y.x,Y.y,Y.k],domNode:A.current.closest(".react-flow")})}},[]),f.useEffect(()=>{B&&P&&(s&&!T&&!m?B.on("wheel.zoom",N=>{if(Gt(N,E))return!1;N.preventDefault(),N.stopImmediatePropagation();const M=B.property("__zoom").k||1;if(N.ctrlKey&&i){const j=rt(N),U=ls(N),V=M*Math.pow(2,U);P.scaleTo(B,V,j,N);return}const F=N.deltaMode===1?20:1;let O=l===Ht.Vertical?0:N.deltaX*F,X=l===Ht.Horizontal?0:N.deltaY*F;!Er()&&N.shiftKey&&l!==Ht.Vertical&&(O=N.deltaY*F,X=0),P.translateBy(B,-(O/M)*a,-(X/M)*a,{internal:!0});const Y=ir(B.property("__zoom")),{onViewportChangeStart:K,onViewportChange:J,onViewportChangeEnd:ee}=$.getState();clearTimeout(L.current),D.current||(D.current=!0,t==null||t(N,Y),K==null||K(Y)),D.current&&(e==null||e(N,Y),J==null||J(Y),L.current=setTimeout(()=>{n==null||n(N,Y),ee==null||ee(Y),D.current=!1},150))},{passive:!1}):typeof H<"u"&&B.on("wheel.zoom",function(N,M){if(!b&&N.type==="wheel"&&!N.ctrlKey||Gt(N,E))return null;N.preventDefault(),H.call(this,N,M)},{passive:!1}))},[m,s,l,B,P,H,T,i,b,E,t,e,n]),f.useEffect(()=>{P&&P.on("start",N=>{var O,X;if(!N.sourceEvent||N.sourceEvent.internal)return null;S.current=(O=N.sourceEvent)==null?void 0:O.button;const{onViewportChangeStart:M}=$.getState(),F=ir(N.transform);I.current=!0,z.current=F,((X=N.sourceEvent)==null?void 0:X.type)==="mousedown"&&$.setState({paneDragging:!0}),M==null||M(F),t==null||t(N.sourceEvent,F)})},[P,t]),f.useEffect(()=>{P&&(m&&!I.current?P.on("zoom",null):m||P.on("zoom",N=>{var F;const{onViewportChange:M}=$.getState();if($.setState({transform:[N.transform.x,N.transform.y,N.transform.k]}),k.current=!!(r&&as(d,S.current??0)),(e||M)&&!((F=N.sourceEvent)!=null&&F.internal)){const O=ir(N.transform);M==null||M(O),e==null||e(N.sourceEvent,O)}}))},[m,P,e,d,r]),f.useEffect(()=>{P&&P.on("end",N=>{if(!N.sourceEvent||N.sourceEvent.internal)return null;const{onViewportChangeEnd:M}=$.getState();if(I.current=!1,$.setState({paneDragging:!1}),r&&as(d,S.current??0)&&!k.current&&r(N.sourceEvent),k.current=!1,(n||M)&&Eg(z.current,N.transform)){const F=ir(N.transform);z.current=F,clearTimeout(R.current),R.current=setTimeout(()=>{M==null||M(F),n==null||n(N.sourceEvent,F)},s?150:0)}})},[P,s,d,n,r]),f.useEffect(()=>{P&&P.filter(N=>{const M=T||o,F=i&&N.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&N.button===1&&N.type==="mousedown"&&(Gt(N,"react-flow__node")||Gt(N,"react-flow__edge")))return!0;if(!d&&!M&&!s&&!u&&!i||m||!u&&N.type==="dblclick"||Gt(N,E)&&N.type==="wheel"||Gt(N,x)&&(N.type!=="wheel"||s&&N.type==="wheel"&&!T)||!i&&N.ctrlKey&&N.type==="wheel"||!M&&!s&&!F&&N.type==="wheel"||!d&&(N.type==="mousedown"||N.type==="touchstart")||Array.isArray(d)&&!d.includes(N.button)&&N.type==="mousedown")return!1;const O=Array.isArray(d)&&d.includes(N.button)||!N.button||N.button<=1;return(!N.ctrlKey||N.type==="wheel")&&O})},[m,P,o,i,s,u,d,c,T]),_.createElement("div",{className:"react-flow__renderer",ref:A,style:ui},w)},Cg=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function _g(){const{userSelectionActive:e,userSelectionRect:t}=ce(Cg,xe);return e&&t?_.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function cs(e,t){const n=t.parentNode||t.parentId,r=e.find(o=>o.id===n);if(r){const o=t.position.x+t.width-r.width,i=t.position.y+t.height-r.height;if(o>0||i>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,o>0&&(r.style.width+=o),i>0&&(r.style.height+=i),t.position.x<0){const s=Math.abs(t.position.x);r.position.x=r.position.x-s,r.style.width+=s,t.position.x=0}if(t.position.y<0){const s=Math.abs(t.position.y);r.position.y=r.position.y-s,r.style.height+=s,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function Ka(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,o)=>{const i=e.filter(a=>a.id===o.id);if(i.length===0)return r.push(o),r;const s={...o};for(const a of i)if(a)switch(a.type){case"select":{s.selected=a.selected;break}case"position":{typeof a.position<"u"&&(s.position=a.position),typeof a.positionAbsolute<"u"&&(s.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(s.dragging=a.dragging),s.expandParent&&cs(r,s);break}case"dimensions":{typeof a.dimensions<"u"&&(s.width=a.dimensions.width,s.height=a.dimensions.height),typeof a.updateStyle<"u"&&(s.style={...s.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(s.resizing=a.resizing),s.expandParent&&cs(r,s);break}case"remove":return r}return r.push(s),r},n)}function Za(e,t){return Ka(e,t)}function Dg(e,t){return Ka(e,t)}const Ct=(e,t)=>({id:e,type:"select",selected:t});function Qt(e,t){return e.reduce((n,r)=>{const o=t.includes(r.id);return!r.selected&&o?(r.selected=!0,n.push(Ct(r.id,!0))):r.selected&&!o&&(r.selected=!1,n.push(Ct(r.id,!1))),n},[])}const to=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Tg=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Qa=f.memo(({isSelecting:e,selectionMode:t=jn.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:o,onPaneClick:i,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:c,children:d})=>{const g=f.useRef(null),h=me(),v=f.useRef(0),p=f.useRef(0),y=f.useRef(),{userSelectionActive:b,elementsSelectable:w,dragging:E}=ce(Tg,xe),x=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,p.current=0},R=H=>{i==null||i(H),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},$=H=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){H.preventDefault();return}s==null||s(H)},I=a?H=>a(H):void 0,k=H=>{const{resetSelectedElements:m,domNode:T}=h.getState();if(y.current=T==null?void 0:T.getBoundingClientRect(),!w||!e||H.button!==0||H.target!==g.current||!y.current)return;const{x:S,y:D}=Mt(H,y.current);m(),h.setState({userSelectionRect:{width:0,height:0,startX:S,startY:D,x:S,y:D}}),r==null||r(H)},A=H=>{const{userSelectionRect:m,nodeInternals:T,edges:S,transform:D,onNodesChange:L,onEdgesChange:N,nodeOrigin:M,getNodes:F}=h.getState();if(!e||!y.current||!m)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const O=Mt(H,y.current),X=m.startX??0,Y=m.startY??0,K={...m,x:O.x<X?O.x:X,y:O.y<Y?O.y:Y,width:Math.abs(O.x-X),height:Math.abs(O.y-Y)},J=F(),ee=Ma(T,K,D,t===jn.Partial,!0,M),j=Ia(ee,S).map(V=>V.id),U=ee.map(V=>V.id);if(v.current!==U.length){v.current=U.length;const V=Qt(J,U);V.length&&(L==null||L(V))}if(p.current!==j.length){p.current=j.length;const V=Qt(S,j);V.length&&(N==null||N(V))}h.setState({userSelectionRect:K})},z=H=>{if(H.button!==0)return;const{userSelectionRect:m}=h.getState();!b&&m&&H.target===g.current&&(R==null||R(H)),h.setState({nodesSelectionActive:v.current>0}),x(),o==null||o(H)},P=H=>{b&&(h.setState({nodesSelectionActive:v.current>0}),o==null||o(H)),x()},B=w&&(e||b);return _.createElement("div",{className:Se(["react-flow__pane",{dragging:E,selection:e}]),onClick:B?void 0:to(R,g),onContextMenu:to($,g),onWheel:to(I,g),onMouseEnter:B?void 0:l,onMouseDown:B?k:void 0,onMouseMove:B?A:u,onMouseUp:B?z:void 0,onMouseLeave:B?P:c,ref:g,style:ui},d,_.createElement(_g,null))});Qa.displayName="Pane";function Ja(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:Ja(r,t):!1}function us(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function $g(e,t,n,r){return Array.from(e.values()).filter(o=>(o.selected||o.id===r)&&(!o.parentNode||o.parentId||!Ja(o,e))&&(o.draggable||t&&typeof o.draggable>"u")).map(o=>{var i,s;return{id:o.id,position:o.position||{x:0,y:0},positionAbsolute:o.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=o.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((s=o.positionAbsolute)==null?void 0:s.y)??0)},delta:{x:0,y:0},extent:o.extent,parentNode:o.parentNode||o.parentId,parentId:o.parentNode||o.parentId,width:o.width,height:o.height,expandParent:o.expandParent}})}function Rg(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function el(e,t,n,r,o=[0,0],i){const s=Rg(e,e.extent||r);let a=s;const l=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(l&&e.width&&e.height){const d=n.get(l),{x:g,y:h}=tn(d,o).positionAbsolute;a=d&&He(g)&&He(h)&&He(d.width)&&He(d.height)?[[g+e.width*o[0],h+e.height*o[1]],[g+d.width-e.width+e.width*o[0],h+d.height-e.height+e.height*o[1]]]:a}else i==null||i("005",mt.error005()),a=s;else if(e.extent&&l&&e.extent!=="parent"){const d=n.get(l),{x:g,y:h}=tn(d,o).positionAbsolute;a=[[e.extent[0][0]+g,e.extent[0][1]+h],[e.extent[1][0]+g,e.extent[1][1]+h]]}let u={x:0,y:0};if(l){const d=n.get(l);u=tn(d,o).positionAbsolute}const c=a&&a!=="parent"?ei(t,a):t;return{position:{x:c.x-u.x,y:c.y-u.y},positionAbsolute:c}}function no({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(o=>({...n.get(o.id),position:o.position,positionAbsolute:o.positionAbsolute}));return[e?r.find(o=>o.id===e):r[0],r]}const ds=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),s=t.getBoundingClientRect(),a={x:s.width*r[0],y:s.height*r[1]};return i.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-s.left-a.x)/n,y:(u.top-s.top-a.y)/n,...Jo(l)}})};function wn(e,t,n){return n===void 0?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,{...o})}}function Ao({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeInternals:a,onError:l}=t.getState(),u=a.get(e);if(!u){l==null||l("012",mt.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&s)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var c;return(c=r==null?void 0:r.current)==null?void 0:c.blur()})):o([e])}function Ag(){const e=me();return f.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:o,snapToGrid:i}=e.getState(),s=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,l={x:(s-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:i?o[0]*Math.round(l.x/o[0]):l.x,ySnapped:i?o[1]*Math.round(l.y/o[1]):l.y,...l}},[])}function ro(e){return(t,n,r)=>e==null?void 0:e(t,r)}function tl({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,selectNodesOnDrag:s}){const a=me(),[l,u]=f.useState(!1),c=f.useRef([]),d=f.useRef({x:null,y:null}),g=f.useRef(0),h=f.useRef(null),v=f.useRef({x:0,y:0}),p=f.useRef(null),y=f.useRef(!1),b=f.useRef(!1),w=f.useRef(!1),E=Ag();return f.useEffect(()=>{if(e!=null&&e.current){const x=We(e.current),R=({x:k,y:A})=>{const{nodeInternals:z,onNodeDrag:P,onSelectionDrag:B,updateNodePositions:H,nodeExtent:m,snapGrid:T,snapToGrid:S,nodeOrigin:D,onError:L}=a.getState();d.current={x:k,y:A};let N=!1,M={x:0,y:0,x2:0,y2:0};if(c.current.length>1&&m){const O=si(c.current,D);M=ti(O)}if(c.current=c.current.map(O=>{const X={x:k-O.distance.x,y:A-O.distance.y};S&&(X.x=T[0]*Math.round(X.x/T[0]),X.y=T[1]*Math.round(X.y/T[1]));const Y=[[m[0][0],m[0][1]],[m[1][0],m[1][1]]];c.current.length>1&&m&&!O.extent&&(Y[0][0]=O.positionAbsolute.x-M.x+m[0][0],Y[1][0]=O.positionAbsolute.x+(O.width??0)-M.x2+m[1][0],Y[0][1]=O.positionAbsolute.y-M.y+m[0][1],Y[1][1]=O.positionAbsolute.y+(O.height??0)-M.y2+m[1][1]);const K=el(O,X,z,Y,D,L);return N=N||O.position.x!==K.position.x||O.position.y!==K.position.y,O.position=K.position,O.positionAbsolute=K.positionAbsolute,O}),!N)return;H(c.current,!0,!0),u(!0);const F=o?P:ro(B);if(F&&p.current){const[O,X]=no({nodeId:o,dragItems:c.current,nodeInternals:z});F(p.current,O,X)}},$=()=>{if(!h.current)return;const[k,A]=Ea(v.current,h.current);if(k!==0||A!==0){const{transform:z,panBy:P}=a.getState();d.current.x=(d.current.x??0)-k/z[2],d.current.y=(d.current.y??0)-A/z[2],P({x:k,y:A})&&R(d.current)}g.current=requestAnimationFrame($)},I=k=>{var D;const{nodeInternals:A,multiSelectionActive:z,nodesDraggable:P,unselectNodesAndEdges:B,onNodeDragStart:H,onSelectionDragStart:m}=a.getState();b.current=!0;const T=o?H:ro(m);(!s||!i)&&!z&&o&&((D=A.get(o))!=null&&D.selected||B()),o&&i&&s&&Ao({id:o,store:a,nodeRef:e});const S=E(k);if(d.current=S,c.current=$g(A,P,S,o),T&&c.current){const[L,N]=no({nodeId:o,dragItems:c.current,nodeInternals:A});T(k.sourceEvent,L,N)}};if(t)x.on(".drag",null);else{const k=Fd().on("start",A=>{const{domNode:z,nodeDragThreshold:P}=a.getState();P===0&&I(A),w.current=!1;const B=E(A);d.current=B,h.current=(z==null?void 0:z.getBoundingClientRect())||null,v.current=Mt(A.sourceEvent,h.current)}).on("drag",A=>{var H,m;const z=E(A),{autoPanOnNodeDrag:P,nodeDragThreshold:B}=a.getState();if(A.sourceEvent.type==="touchmove"&&A.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!y.current&&b.current&&P&&(y.current=!0,$()),!b.current){const T=z.xSnapped-(((H=d==null?void 0:d.current)==null?void 0:H.x)??0),S=z.ySnapped-(((m=d==null?void 0:d.current)==null?void 0:m.y)??0);Math.sqrt(T*T+S*S)>B&&I(A)}(d.current.x!==z.xSnapped||d.current.y!==z.ySnapped)&&c.current&&b.current&&(p.current=A.sourceEvent,v.current=Mt(A.sourceEvent,h.current),R(z))}}).on("end",A=>{if(!(!b.current||w.current)&&(u(!1),y.current=!1,b.current=!1,cancelAnimationFrame(g.current),c.current)){const{updateNodePositions:z,nodeInternals:P,onNodeDragStop:B,onSelectionDragStop:H}=a.getState(),m=o?B:ro(H);if(z(c.current,!1,!1),m){const[T,S]=no({nodeId:o,dragItems:c.current,nodeInternals:P});m(A.sourceEvent,T,S)}}}).filter(A=>{const z=A.target;return!A.button&&(!n||!us(z,`.${n}`,e))&&(!r||us(z,r,e))});return x.call(k),()=>{x.on(".drag",null)}}}},[e,t,n,r,i,a,o,s,E]),l}function nl(){const e=me();return f.useCallback(n=>{const{nodeInternals:r,nodeExtent:o,updateNodePositions:i,getNodes:s,snapToGrid:a,snapGrid:l,onError:u,nodesDraggable:c}=e.getState(),d=s().filter(w=>w.selected&&(w.draggable||c&&typeof w.draggable>"u")),g=a?l[0]:5,h=a?l[1]:5,v=n.isShiftPressed?4:1,p=n.x*g*v,y=n.y*h*v,b=d.map(w=>{if(w.positionAbsolute){const E={x:w.positionAbsolute.x+p,y:w.positionAbsolute.y+y};a&&(E.x=l[0]*Math.round(E.x/l[0]),E.y=l[1]*Math.round(E.y/l[1]));const{positionAbsolute:x,position:R}=el(w,E,r,o,void 0,u);w.position=R,w.positionAbsolute=x}return w});i(b,!0,!1)},[])}const nn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var En=e=>{const t=({id:n,type:r,data:o,xPos:i,yPos:s,xPosOrigin:a,yPosOrigin:l,selected:u,onClick:c,onMouseEnter:d,onMouseMove:g,onMouseLeave:h,onContextMenu:v,onDoubleClick:p,style:y,className:b,isDraggable:w,isSelectable:E,isConnectable:x,isFocusable:R,selectNodesOnDrag:$,sourcePosition:I,targetPosition:k,hidden:A,resizeObserver:z,dragHandle:P,zIndex:B,isParent:H,noDragClassName:m,noPanClassName:T,initialized:S,disableKeyboardA11y:D,ariaLabel:L,rfId:N,hasHandleBounds:M})=>{const F=me(),O=f.useRef(null),X=f.useRef(null),Y=f.useRef(I),K=f.useRef(k),J=f.useRef(r),ee=E||w||c||d||g||h,j=nl(),U=wn(n,F.getState,d),V=wn(n,F.getState,g),q=wn(n,F.getState,h),W=wn(n,F.getState,v),Z=wn(n,F.getState,p),ne=oe=>{const{nodeDragThreshold:Q}=F.getState();if(E&&(!$||!w||Q>0)&&Ao({id:n,store:F,nodeRef:O}),c){const ye=F.getState().nodeInternals.get(n);ye&&c(oe,{...ye})}},re=oe=>{if(!_o(oe)&&!D)if(Na.includes(oe.key)&&E){const Q=oe.key==="Escape";Ao({id:n,store:F,unselect:Q,nodeRef:O})}else w&&u&&Object.prototype.hasOwnProperty.call(nn,oe.key)&&(F.setState({ariaLiveMessage:`Moved selected node ${oe.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~s}`}),j({x:nn[oe.key].x,y:nn[oe.key].y,isShiftPressed:oe.shiftKey}))};f.useEffect(()=>()=>{X.current&&(z==null||z.unobserve(X.current),X.current=null)},[]),f.useEffect(()=>{if(O.current&&!A){const oe=O.current;(!S||!M||X.current!==oe)&&(X.current&&(z==null||z.unobserve(X.current)),z==null||z.observe(oe),X.current=oe)}},[A,S,M]),f.useEffect(()=>{const oe=J.current!==r,Q=Y.current!==I,ye=K.current!==k;O.current&&(oe||Q||ye)&&(oe&&(J.current=r),Q&&(Y.current=I),ye&&(K.current=k),F.getState().updateNodeDimensions([{id:n,nodeElement:O.current,forceUpdate:!0}]))},[n,r,I,k]);const le=tl({nodeRef:O,disabled:A||!w,noDragClassName:m,handleSelector:P,nodeId:n,isSelectable:E,selectNodesOnDrag:$});return A?null:_.createElement("div",{className:Se(["react-flow__node",`react-flow__node-${r}`,{[T]:w},b,{selected:u,selectable:E,parent:H,dragging:le}]),ref:O,style:{zIndex:B,transform:`translate(${a}px,${l}px)`,pointerEvents:ee?"all":"none",visibility:S?"visible":"hidden",...y},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:U,onMouseMove:V,onMouseLeave:q,onContextMenu:W,onClick:ne,onDoubleClick:Z,onKeyDown:R?re:void 0,tabIndex:R?0:void 0,role:R?"button":void 0,"aria-describedby":D?void 0:`${Ya}-${N}`,"aria-label":L},_.createElement(Xh,{value:n},_.createElement(e,{id:n,data:o,type:r,xPos:i,yPos:s,selected:u,isConnectable:x,sourcePosition:I,targetPosition:k,dragging:le,dragHandle:P,zIndex:B})))};return t.displayName="NodeWrapper",f.memo(t)};const Mg=e=>{const t=e.getNodes().filter(n=>n.selected);return{...si(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Ig({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=me(),{width:o,height:i,x:s,y:a,transformString:l,userSelectionActive:u}=ce(Mg,xe),c=nl(),d=f.useRef(null);if(f.useEffect(()=>{var v;n||(v=d.current)==null||v.focus({preventScroll:!0})},[n]),tl({nodeRef:d}),u||!o||!i)return null;const g=e?v=>{const p=r.getState().getNodes().filter(y=>y.selected);e(v,p)}:void 0,h=v=>{Object.prototype.hasOwnProperty.call(nn,v.key)&&c({x:nn[v.key].x,y:nn[v.key].y,isShiftPressed:v.shiftKey})};return _.createElement("div",{className:Se(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},_.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:o,height:i,top:a,left:s}}))}var kg=f.memo(Ig);const Pg=e=>e.nodesSelectionActive,rl=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:a,onMove:l,onMoveStart:u,onMoveEnd:c,selectionKeyCode:d,selectionOnDrag:g,selectionMode:h,onSelectionStart:v,onSelectionEnd:p,multiSelectionKeyCode:y,panActivationKeyCode:b,zoomActivationKeyCode:w,elementsSelectable:E,zoomOnScroll:x,zoomOnPinch:R,panOnScroll:$,panOnScrollSpeed:I,panOnScrollMode:k,zoomOnDoubleClick:A,panOnDrag:z,defaultViewport:P,translateExtent:B,minZoom:H,maxZoom:m,preventScrolling:T,onSelectionContextMenu:S,noWheelClassName:D,noPanClassName:L,disableKeyboardA11y:N})=>{const M=ce(Pg),F=zn(d),O=zn(b),X=O||z,Y=O||$,K=F||g&&X!==!0;return xg({deleteKeyCode:a,multiSelectionKeyCode:y}),_.createElement(Ng,{onMove:l,onMoveStart:u,onMoveEnd:c,onPaneContextMenu:i,elementsSelectable:E,zoomOnScroll:x,zoomOnPinch:R,panOnScroll:Y,panOnScrollSpeed:I,panOnScrollMode:k,zoomOnDoubleClick:A,panOnDrag:!F&&X,defaultViewport:P,translateExtent:B,minZoom:H,maxZoom:m,zoomActivationKeyCode:w,preventScrolling:T,noWheelClassName:D,noPanClassName:L},_.createElement(Qa,{onSelectionStart:v,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:X,isSelecting:!!K,selectionMode:h},e,M&&_.createElement(kg,{onSelectionContextMenu:S,noPanClassName:L,disableKeyboardA11y:N})))};rl.displayName="FlowRenderer";var Lg=f.memo(rl);function Og(e){return ce(f.useCallback(n=>e?Ma(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function jg(e){const t={input:En(e.input||Ha),default:En(e.default||Ro),output:En(e.output||Ba),group:En(e.group||li)},n={},r=Object.keys(e).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,i)=>(o[i]=En(e[i]||Ro),o),n);return{...t,...r}}const zg=({x:e,y:t,width:n,height:r,origin:o})=>!n||!r?{x:e,y:t}:o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},Fg=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),ol=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,updateNodeDimensions:i,onError:s}=ce(Fg,xe),a=Og(e.onlyRenderVisibleElements),l=f.useRef(),u=f.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const c=new ResizeObserver(d=>{const g=d.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));i(g)});return l.current=c,c},[]);return f.useEffect(()=>()=>{var c;(c=l==null?void 0:l.current)==null||c.disconnect()},[]),_.createElement("div",{className:"react-flow__nodes",style:ui},a.map(c=>{var R,$,I;let d=c.type||"default";e.nodeTypes[d]||(s==null||s("003",mt.error003(d)),d="default");const g=e.nodeTypes[d]||e.nodeTypes.default,h=!!(c.draggable||t&&typeof c.draggable>"u"),v=!!(c.selectable||o&&typeof c.selectable>"u"),p=!!(c.connectable||n&&typeof c.connectable>"u"),y=!!(c.focusable||r&&typeof c.focusable>"u"),b=e.nodeExtent?ei(c.positionAbsolute,e.nodeExtent):c.positionAbsolute,w=(b==null?void 0:b.x)??0,E=(b==null?void 0:b.y)??0,x=zg({x:w,y:E,width:c.width??0,height:c.height??0,origin:e.nodeOrigin});return _.createElement(g,{key:c.id,id:c.id,className:c.className,style:c.style,type:d,data:c.data,sourcePosition:c.sourcePosition||G.Bottom,targetPosition:c.targetPosition||G.Top,hidden:c.hidden,xPos:w,yPos:E,xPosOrigin:x.x,yPosOrigin:x.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!c.selected,isDraggable:h,isSelectable:v,isConnectable:p,isFocusable:y,resizeObserver:u,dragHandle:c.dragHandle,zIndex:((R=c[ue])==null?void 0:R.z)??0,isParent:!!(($=c[ue])!=null&&$.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!c.width&&!!c.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:c.ariaLabel,hasHandleBounds:!!((I=c[ue])!=null&&I.handleBounds)})}))};ol.displayName="NodeRenderer";var Hg=f.memo(ol);const Vg=(e,t,n)=>n===G.Left?e-t:n===G.Right?e+t:e,Bg=(e,t,n)=>n===G.Top?e-t:n===G.Bottom?e+t:e,fs="react-flow__edgeupdater",hs=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a})=>_.createElement("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:Se([fs,`${fs}-${a}`]),cx:Vg(t,r,e),cy:Bg(n,r,e),r,stroke:"transparent",fill:"transparent"}),Ug=()=>!0;var Kt=e=>{const t=({id:n,className:r,type:o,data:i,onClick:s,onEdgeDoubleClick:a,selected:l,animated:u,label:c,labelStyle:d,labelShowBg:g,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:p,style:y,source:b,target:w,sourceX:E,sourceY:x,targetX:R,targetY:$,sourcePosition:I,targetPosition:k,elementsSelectable:A,hidden:z,sourceHandleId:P,targetHandleId:B,onContextMenu:H,onMouseEnter:m,onMouseMove:T,onMouseLeave:S,reconnectRadius:D,onReconnect:L,onReconnectStart:N,onReconnectEnd:M,markerEnd:F,markerStart:O,rfId:X,ariaLabel:Y,isFocusable:K,isReconnectable:J,pathOptions:ee,interactionWidth:j,disableKeyboardA11y:U})=>{const V=f.useRef(null),[q,W]=f.useState(!1),[Z,ne]=f.useState(!1),re=me(),le=f.useMemo(()=>`url('#${To(O,X)}')`,[O,X]),oe=f.useMemo(()=>`url('#${To(F,X)}')`,[F,X]);if(z)return null;const Q=se=>{var Le;const{edges:Ce,addSelectedEdges:ct,unselectNodesAndEdges:ut,multiSelectionActive:Ye}=re.getState(),Pe=Ce.find(bt=>bt.id===n);Pe&&(A&&(re.setState({nodesSelectionActive:!1}),Pe.selected&&Ye?(ut({nodes:[],edges:[Pe]}),(Le=V.current)==null||Le.blur()):ct([n])),s&&s(se,Pe))},ye=xn(n,re.getState,a),ve=xn(n,re.getState,H),Je=xn(n,re.getState,m),Ue=xn(n,re.getState,T),at=xn(n,re.getState,S),Ie=(se,Ce)=>{if(se.button!==0)return;const{edges:ct,isValidConnection:ut}=re.getState(),Ye=Ce?w:b,Pe=(Ce?B:P)||null,Le=Ce?"target":"source",bt=ut||Ug,pn=Ce,kt=ct.find(de=>de.id===n);ne(!0),N==null||N(se,kt,Le);const mn=de=>{ne(!1),M==null||M(de,kt,Le)};Oa({event:se,handleId:Pe,nodeId:Ye,onConnect:de=>L==null?void 0:L(kt,de),isTarget:pn,getState:re.getState,setState:re.setState,isValidConnection:bt,edgeUpdaterType:Le,onReconnectEnd:mn})},yt=se=>Ie(se,!0),lt=se=>Ie(se,!1),Ne=()=>W(!0),$e=()=>W(!1),ke=!A&&!s,vt=se=>{var Ce;if(!U&&Na.includes(se.key)&&A){const{unselectNodesAndEdges:ct,addSelectedEdges:ut,edges:Ye}=re.getState();se.key==="Escape"?((Ce=V.current)==null||Ce.blur(),ct({edges:[Ye.find(Le=>Le.id===n)]})):ut([n])}};return _.createElement("g",{className:Se(["react-flow__edge",`react-flow__edge-${o}`,r,{selected:l,animated:u,inactive:ke,updating:q}]),onClick:Q,onDoubleClick:ye,onContextMenu:ve,onMouseEnter:Je,onMouseMove:Ue,onMouseLeave:at,onKeyDown:K?vt:void 0,tabIndex:K?0:void 0,role:K?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":Y===null?void 0:Y||`Edge from ${b} to ${w}`,"aria-describedby":K?`${Xa}-${X}`:void 0,ref:V},!Z&&_.createElement(e,{id:n,source:b,target:w,selected:l,animated:u,label:c,labelStyle:d,labelShowBg:g,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:p,data:i,style:y,sourceX:E,sourceY:x,targetX:R,targetY:$,sourcePosition:I,targetPosition:k,sourceHandleId:P,targetHandleId:B,markerStart:le,markerEnd:oe,pathOptions:ee,interactionWidth:j}),J&&_.createElement(_.Fragment,null,(J==="source"||J===!0)&&_.createElement(hs,{position:I,centerX:E,centerY:x,radius:D,onMouseDown:yt,onMouseEnter:Ne,onMouseOut:$e,type:"source"}),(J==="target"||J===!0)&&_.createElement(hs,{position:k,centerX:R,centerY:$,radius:D,onMouseDown:lt,onMouseEnter:Ne,onMouseOut:$e,type:"target"})))};return t.displayName="EdgeWrapper",f.memo(t)};function Yg(e){const t={default:Kt(e.default||Nr),straight:Kt(e.bezier||oi),step:Kt(e.step||ri),smoothstep:Kt(e.step||zr),simplebezier:Kt(e.simplebezier||ni)},n={},r=Object.keys(e).filter(o=>!["default","bezier"].includes(o)).reduce((o,i)=>(o[i]=Kt(e[i]||Nr),o),n);return{...t,...r}}function gs(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,o=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,s=(n==null?void 0:n.height)||t.height;switch(e){case G.Top:return{x:r+i/2,y:o};case G.Right:return{x:r+i,y:o+s/2};case G.Bottom:return{x:r+i/2,y:o+s};case G.Left:return{x:r,y:o+s/2}}}function ps(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const Xg=(e,t,n,r,o,i)=>{const s=gs(n,e,t),a=gs(i,r,o);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function Wg({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:i,width:s,height:a,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const c=ti({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:s/l[2],height:a/l[2]}),d=Math.max(0,Math.min(c.x2,u.x2)-Math.max(c.x,u.x)),g=Math.max(0,Math.min(c.y2,u.y2)-Math.max(c.y,u.y));return Math.ceil(d*g)>0}function ms(e){var r,o,i,s,a;const t=((r=e==null?void 0:e[ue])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const qg=[{level:0,isMaxLevel:!0,edges:[]}];function Gg(e,t,n=!1){let r=-1;const o=e.reduce((s,a)=>{var c,d;const l=He(a.zIndex);let u=l?a.zIndex:0;if(n){const g=t.get(a.target),h=t.get(a.source),v=a.selected||(g==null?void 0:g.selected)||(h==null?void 0:h.selected),p=Math.max(((c=h==null?void 0:h[ue])==null?void 0:c.z)||0,((d=g==null?void 0:g[ue])==null?void 0:d.z)||0,1e3);u=(l?a.zIndex:0)+(v?p:0)}return s[u]?s[u].push(a):s[u]=[a],r=u>r?u:r,s},{}),i=Object.entries(o).map(([s,a])=>{const l=+s;return{edges:a,level:l,isMaxLevel:l===r}});return i.length===0?qg:i}function Kg(e,t,n){const r=ce(f.useCallback(o=>e?o.edges.filter(i=>{const s=t.get(i.source),a=t.get(i.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&Wg({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[e,t]));return Gg(r,t,n)}const Zg=({color:e="none",strokeWidth:t=1})=>_.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Qg=({color:e="none",strokeWidth:t=1})=>_.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),ys={[Sr.Arrow]:Zg,[Sr.ArrowClosed]:Qg};function Jg(e){const t=me();return f.useMemo(()=>{var o,i;return Object.prototype.hasOwnProperty.call(ys,e)?ys[e]:((i=(o=t.getState()).onError)==null||i.call(o,"009",mt.error009(e)),null)},[e])}const ep=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const l=Jg(t);return l?_.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},_.createElement(l,{color:n,strokeWidth:s})):null},tp=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((o,i)=>([i.markerStart,i.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=To(s,t);r.includes(a)||(o.push({id:a,color:s.color||e,...s}),r.push(a))}}),o),[]).sort((o,i)=>o.id.localeCompare(i.id))},il=({defaultColor:e,rfId:t})=>{const n=ce(f.useCallback(tp({defaultColor:e,rfId:t}),[e,t]),(r,o)=>!(r.length!==o.length||r.some((i,s)=>i.id!==o[s].id)));return _.createElement("defs",null,n.map(r=>_.createElement(ep,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};il.displayName="MarkerDefinitions";var np=f.memo(il);const rp=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),sl=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:o,noPanClassName:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:c,onEdgeDoubleClick:d,onReconnect:g,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:p,children:y,disableKeyboardA11y:b})=>{const{edgesFocusable:w,edgesUpdatable:E,elementsSelectable:x,width:R,height:$,connectionMode:I,nodeInternals:k,onError:A}=ce(rp,xe),z=Kg(t,k,n);return R?_.createElement(_.Fragment,null,z.map(({level:P,edges:B,isMaxLevel:H})=>_.createElement("svg",{key:P,style:{zIndex:P},width:R,height:$,className:"react-flow__edges react-flow__container"},H&&_.createElement(np,{defaultColor:e,rfId:r}),_.createElement("g",null,B.map(m=>{const[T,S,D]=ms(k.get(m.source)),[L,N,M]=ms(k.get(m.target));if(!D||!M)return null;let F=m.type||"default";o[F]||(A==null||A("011",mt.error011(F)),F="default");const O=o[F]||o.default,X=I===It.Strict?N.target:(N.target??[]).concat(N.source??[]),Y=ps(S.source,m.sourceHandle),K=ps(X,m.targetHandle),J=(Y==null?void 0:Y.position)||G.Bottom,ee=(K==null?void 0:K.position)||G.Top,j=!!(m.focusable||w&&typeof m.focusable>"u"),U=m.reconnectable||m.updatable,V=typeof g<"u"&&(U||E&&typeof U>"u");if(!Y||!K)return A==null||A("008",mt.error008(Y,m)),null;const{sourceX:q,sourceY:W,targetX:Z,targetY:ne}=Xg(T,Y,J,L,K,ee);return _.createElement(O,{key:m.id,id:m.id,className:Se([m.className,i]),type:F,data:m.data,selected:!!m.selected,animated:!!m.animated,hidden:!!m.hidden,label:m.label,labelStyle:m.labelStyle,labelShowBg:m.labelShowBg,labelBgStyle:m.labelBgStyle,labelBgPadding:m.labelBgPadding,labelBgBorderRadius:m.labelBgBorderRadius,style:m.style,source:m.source,target:m.target,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle,markerEnd:m.markerEnd,markerStart:m.markerStart,sourceX:q,sourceY:W,targetX:Z,targetY:ne,sourcePosition:J,targetPosition:ee,elementsSelectable:x,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:u,onClick:c,onEdgeDoubleClick:d,onReconnect:g,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:p,rfId:r,ariaLabel:m.ariaLabel,isFocusable:j,isReconnectable:V,pathOptions:"pathOptions"in m?m.pathOptions:void 0,interactionWidth:m.interactionWidth,disableKeyboardA11y:b})})))),y):null};sl.displayName="EdgeRenderer";var op=f.memo(sl);const ip=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function sp({children:e}){const t=ce(ip);return _.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function ap(e){const t=ci(),n=f.useRef(!1);f.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const lp={[G.Left]:G.Right,[G.Right]:G.Left,[G.Top]:G.Bottom,[G.Bottom]:G.Top},al=({nodeId:e,handleType:t,style:n,type:r=Dt.Bezier,CustomComponent:o,connectionStatus:i})=>{var $,I,k;const{fromNode:s,handleId:a,toX:l,toY:u,connectionMode:c}=ce(f.useCallback(A=>({fromNode:A.nodeInternals.get(e),handleId:A.connectionHandleId,toX:(A.connectionPosition.x-A.transform[0])/A.transform[2],toY:(A.connectionPosition.y-A.transform[1])/A.transform[2],connectionMode:A.connectionMode}),[e]),xe),d=($=s==null?void 0:s[ue])==null?void 0:$.handleBounds;let g=d==null?void 0:d[t];if(c===It.Loose&&(g=g||(d==null?void 0:d[t==="source"?"target":"source"])),!s||!g)return null;const h=a?g.find(A=>A.id===a):g[0],v=h?h.x+h.width/2:(s.width??0)/2,p=h?h.y+h.height/2:s.height??0,y=(((I=s.positionAbsolute)==null?void 0:I.x)??0)+v,b=(((k=s.positionAbsolute)==null?void 0:k.y)??0)+p,w=h==null?void 0:h.position,E=w?lp[w]:null;if(!w||!E)return null;if(o)return _.createElement(o,{connectionLineType:r,connectionLineStyle:n,fromNode:s,fromHandle:h,fromX:y,fromY:b,toX:l,toY:u,fromPosition:w,toPosition:E,connectionStatus:i});let x="";const R={sourceX:y,sourceY:b,sourcePosition:w,targetX:l,targetY:u,targetPosition:E};return r===Dt.Bezier?[x]=$a(R):r===Dt.Step?[x]=Do({...R,borderRadius:0}):r===Dt.SmoothStep?[x]=Do(R):r===Dt.SimpleBezier?[x]=Ta(R):x=`M${y},${b} ${l},${u}`,_.createElement("path",{d:x,fill:"none",className:"react-flow__connection-path",style:n})};al.displayName="ConnectionLine";const cp=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function up({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:i,nodesConnectable:s,width:a,height:l,connectionStatus:u}=ce(cp,xe);return!(o&&i&&a&&s)?null:_.createElement("svg",{style:e,width:a,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},_.createElement("g",{className:Se(["react-flow__connection",u])},_.createElement(al,{nodeId:o,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function vs(e,t){return f.useRef(null),me(),f.useMemo(()=>t(e),[e])}const ll=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:o,onInit:i,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:g,onNodeContextMenu:h,onSelectionContextMenu:v,onSelectionStart:p,onSelectionEnd:y,connectionLineType:b,connectionLineStyle:w,connectionLineComponent:E,connectionLineContainerStyle:x,selectionKeyCode:R,selectionOnDrag:$,selectionMode:I,multiSelectionKeyCode:k,panActivationKeyCode:A,zoomActivationKeyCode:z,deleteKeyCode:P,onlyRenderVisibleElements:B,elementsSelectable:H,selectNodesOnDrag:m,defaultViewport:T,translateExtent:S,minZoom:D,maxZoom:L,preventScrolling:N,defaultMarkerColor:M,zoomOnScroll:F,zoomOnPinch:O,panOnScroll:X,panOnScrollSpeed:Y,panOnScrollMode:K,zoomOnDoubleClick:J,panOnDrag:ee,onPaneClick:j,onPaneMouseEnter:U,onPaneMouseMove:V,onPaneMouseLeave:q,onPaneScroll:W,onPaneContextMenu:Z,onEdgeContextMenu:ne,onEdgeMouseEnter:re,onEdgeMouseMove:le,onEdgeMouseLeave:oe,onReconnect:Q,onReconnectStart:ye,onReconnectEnd:ve,reconnectRadius:Je,noDragClassName:Ue,noWheelClassName:at,noPanClassName:Ie,elevateEdgesOnSelect:yt,disableKeyboardA11y:lt,nodeOrigin:Ne,nodeExtent:$e,rfId:ke})=>{const vt=vs(e,jg),se=vs(t,Yg);return ap(i),_.createElement(Lg,{onPaneClick:j,onPaneMouseEnter:U,onPaneMouseMove:V,onPaneMouseLeave:q,onPaneContextMenu:Z,onPaneScroll:W,deleteKeyCode:P,selectionKeyCode:R,selectionOnDrag:$,selectionMode:I,onSelectionStart:p,onSelectionEnd:y,multiSelectionKeyCode:k,panActivationKeyCode:A,zoomActivationKeyCode:z,elementsSelectable:H,onMove:n,onMoveStart:r,onMoveEnd:o,zoomOnScroll:F,zoomOnPinch:O,zoomOnDoubleClick:J,panOnScroll:X,panOnScrollSpeed:Y,panOnScrollMode:K,panOnDrag:ee,defaultViewport:T,translateExtent:S,minZoom:D,maxZoom:L,onSelectionContextMenu:v,preventScrolling:N,noDragClassName:Ue,noWheelClassName:at,noPanClassName:Ie,disableKeyboardA11y:lt},_.createElement(sp,null,_.createElement(op,{edgeTypes:se,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:B,onEdgeContextMenu:ne,onEdgeMouseEnter:re,onEdgeMouseMove:le,onEdgeMouseLeave:oe,onReconnect:Q,onReconnectStart:ye,onReconnectEnd:ve,reconnectRadius:Je,defaultMarkerColor:M,noPanClassName:Ie,elevateEdgesOnSelect:!!yt,disableKeyboardA11y:lt,rfId:ke},_.createElement(up,{style:w,type:b,component:E,containerStyle:x})),_.createElement("div",{className:"react-flow__edgelabel-renderer"}),_.createElement(Hg,{nodeTypes:vt,onNodeClick:s,onNodeDoubleClick:l,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:g,onNodeContextMenu:h,selectNodesOnDrag:m,onlyRenderVisibleElements:B,noPanClassName:Ie,noDragClassName:Ue,disableKeyboardA11y:lt,nodeOrigin:Ne,nodeExtent:$e,rfId:ke})))};ll.displayName="GraphView";var dp=f.memo(ll);const Mo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wt={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Mo,nodeExtent:Mo,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:It.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Fh,isValidConnection:void 0},fp=()=>Qc((e,t)=>({...wt,setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:i}=t();e({nodeInternals:eo(n,r,o,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(o=>({...r,...o}))})},setDefaultNodesAndEdges:(n,r)=>{const o=typeof n<"u",i=typeof r<"u",s=o?eo(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:i?r:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:l,nodeOrigin:u}=t(),c=l==null?void 0:l.querySelector(".react-flow__viewport");if(!c)return;const d=window.getComputedStyle(c),{m22:g}=new window.DOMMatrixReadOnly(d.transform),h=n.reduce((p,y)=>{const b=o.get(y.id);if(b!=null&&b.hidden)o.set(b.id,{...b,[ue]:{...b[ue],handleBounds:void 0}});else if(b){const w=Jo(y.nodeElement);!!(w.width&&w.height&&(b.width!==w.width||b.height!==w.height||y.forceUpdate))&&(o.set(b.id,{...b,[ue]:{...b[ue],handleBounds:{source:ds(".source",y.nodeElement,g,u),target:ds(".target",y.nodeElement,g,u)}},...w}),p.push({id:b.id,type:"dimensions",dimensions:w}))}return p},[]);qa(o,u);const v=s||i&&!s&&Ga(t,{initial:!0,...a});e({nodeInternals:new Map(o),fitViewOnInitDone:v}),(h==null?void 0:h.length)>0&&(r==null||r(h))},updateNodePositions:(n,r=!0,o=!1)=>{const{triggerNodeChanges:i}=t(),s=n.map(a=>{const l={id:a.id,type:"position",dragging:o};return r&&(l.positionAbsolute=a.positionAbsolute,l.position=a.position),l});i(s)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:i,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:l}=t();if(n!=null&&n.length){if(i){const u=Za(n,a()),c=eo(u,o,s,l);e({nodeInternals:c})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(l=>Ct(l,!0)):(s=Qt(i(),n),a=Qt(o,[])),or({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(l=>Ct(l,!0)):(s=Qt(o,n),a=Qt(i(),[])),or({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:o,getNodes:i}=t(),s=n||i(),a=r||o,l=s.map(c=>(c.selected=!1,Ct(c.id,!1))),u=a.map(c=>Ct(c.id,!1));or({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();r==null||r.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();r==null||r.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),i=r().filter(a=>a.selected).map(a=>Ct(a.id,!1)),s=n.filter(a=>a.selected).map(a=>Ct(a.id,!1));or({changedNodes:i,changedEdges:s,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(o=>{o.positionAbsolute=ei(o.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:o,height:i,d3Zoom:s,d3Selection:a,translateExtent:l}=t();if(!s||!a||!n.x&&!n.y)return!1;const u=At.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),c=[[0,0],[o,i]],d=s==null?void 0:s.constrain()(u,c,l);return s.transform(a,d),r[0]!==d.x||r[1]!==d.y||r[2]!==d.k},cancelConnection:()=>e({connectionNodeId:wt.connectionNodeId,connectionHandleId:wt.connectionHandleId,connectionHandleType:wt.connectionHandleType,connectionStatus:wt.connectionStatus,connectionStartHandle:wt.connectionStartHandle,connectionEndHandle:wt.connectionEndHandle}),reset:()=>e({...wt})}),Object.is),cl=({children:e})=>{const t=f.useRef(null);return t.current||(t.current=fp()),_.createElement(Mh,{value:t.current},e)};cl.displayName="ReactFlowProvider";const ul=({children:e})=>f.useContext(jr)?_.createElement(_.Fragment,null,e):_.createElement(cl,null,e);ul.displayName="ReactFlowWrapper";const hp={input:Ha,default:Ro,output:Ba,group:li},gp={default:Nr,straight:oi,step:ri,smoothstep:zr,simplebezier:ni},pp=[0,0],mp=[15,15],yp={x:0,y:0,zoom:1},vp={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},dl=f.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i=hp,edgeTypes:s=gp,onNodeClick:a,onEdgeClick:l,onInit:u,onMove:c,onMoveStart:d,onMoveEnd:g,onConnect:h,onConnectStart:v,onConnectEnd:p,onClickConnectStart:y,onClickConnectEnd:b,onNodeMouseEnter:w,onNodeMouseMove:E,onNodeMouseLeave:x,onNodeContextMenu:R,onNodeDoubleClick:$,onNodeDragStart:I,onNodeDrag:k,onNodeDragStop:A,onNodesDelete:z,onEdgesDelete:P,onSelectionChange:B,onSelectionDragStart:H,onSelectionDrag:m,onSelectionDragStop:T,onSelectionContextMenu:S,onSelectionStart:D,onSelectionEnd:L,connectionMode:N=It.Strict,connectionLineType:M=Dt.Bezier,connectionLineStyle:F,connectionLineComponent:O,connectionLineContainerStyle:X,deleteKeyCode:Y="Backspace",selectionKeyCode:K="Shift",selectionOnDrag:J=!1,selectionMode:ee=jn.Full,panActivationKeyCode:j="Space",multiSelectionKeyCode:U=Er()?"Meta":"Control",zoomActivationKeyCode:V=Er()?"Meta":"Control",snapToGrid:q=!1,snapGrid:W=mp,onlyRenderVisibleElements:Z=!1,selectNodesOnDrag:ne=!0,nodesDraggable:re,nodesConnectable:le,nodesFocusable:oe,nodeOrigin:Q=pp,edgesFocusable:ye,edgesUpdatable:ve,elementsSelectable:Je,defaultViewport:Ue=yp,minZoom:at=.5,maxZoom:Ie=2,translateExtent:yt=Mo,preventScrolling:lt=!0,nodeExtent:Ne,defaultMarkerColor:$e="#b1b1b7",zoomOnScroll:ke=!0,zoomOnPinch:vt=!0,panOnScroll:se=!1,panOnScrollSpeed:Ce=.5,panOnScrollMode:ct=Ht.Free,zoomOnDoubleClick:ut=!0,panOnDrag:Ye=!0,onPaneClick:Pe,onPaneMouseEnter:Le,onPaneMouseMove:bt,onPaneMouseLeave:pn,onPaneScroll:kt,onPaneContextMenu:mn,children:fe,onEdgeContextMenu:de,onEdgeDoubleClick:we,onEdgeMouseEnter:et,onEdgeMouseMove:_e,onEdgeMouseLeave:Ee,onEdgeUpdate:Oe,onEdgeUpdateStart:xt,onEdgeUpdateEnd:he,onReconnect:tt,onReconnectStart:je,onReconnectEnd:Xe,reconnectRadius:Pt=10,edgeUpdaterRadius:Lt=10,onNodesChange:nt,onEdgesChange:Ot,noDragClassName:yn="nodrag",noWheelClassName:rc="nowheel",noPanClassName:Ci="nopan",fitView:oc=!1,fitViewOptions:ic,connectOnClick:sc=!0,attributionPosition:ac,proOptions:lc,defaultEdgeOptions:cc,elevateNodesOnSelect:uc=!0,elevateEdgesOnSelect:dc=!1,disableKeyboardA11y:_i=!1,autoPanOnConnect:fc=!0,autoPanOnNodeDrag:hc=!0,connectionRadius:gc=20,isValidConnection:pc,onError:mc,style:yc,id:Di,nodeDragThreshold:vc,...bc},xc)=>{const Wr=Di||"1";return _.createElement("div",{...bc,style:{...yc,...vp},ref:xc,className:Se(["react-flow",o]),"data-testid":"rf__wrapper",id:Di},_.createElement(ul,null,_.createElement(dp,{onInit:u,onMove:c,onMoveStart:d,onMoveEnd:g,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:w,onNodeMouseMove:E,onNodeMouseLeave:x,onNodeContextMenu:R,onNodeDoubleClick:$,nodeTypes:i,edgeTypes:s,connectionLineType:M,connectionLineStyle:F,connectionLineComponent:O,connectionLineContainerStyle:X,selectionKeyCode:K,selectionOnDrag:J,selectionMode:ee,deleteKeyCode:Y,multiSelectionKeyCode:U,panActivationKeyCode:j,zoomActivationKeyCode:V,onlyRenderVisibleElements:Z,selectNodesOnDrag:ne,defaultViewport:Ue,translateExtent:yt,minZoom:at,maxZoom:Ie,preventScrolling:lt,zoomOnScroll:ke,zoomOnPinch:vt,zoomOnDoubleClick:ut,panOnScroll:se,panOnScrollSpeed:Ce,panOnScrollMode:ct,panOnDrag:Ye,onPaneClick:Pe,onPaneMouseEnter:Le,onPaneMouseMove:bt,onPaneMouseLeave:pn,onPaneScroll:kt,onPaneContextMenu:mn,onSelectionContextMenu:S,onSelectionStart:D,onSelectionEnd:L,onEdgeContextMenu:de,onEdgeDoubleClick:we,onEdgeMouseEnter:et,onEdgeMouseMove:_e,onEdgeMouseLeave:Ee,onReconnect:tt??Oe,onReconnectStart:je??xt,onReconnectEnd:Xe??he,reconnectRadius:Pt??Lt,defaultMarkerColor:$e,noDragClassName:yn,noWheelClassName:rc,noPanClassName:Ci,elevateEdgesOnSelect:dc,rfId:Wr,disableKeyboardA11y:_i,nodeOrigin:Q,nodeExtent:Ne}),_.createElement(lg,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:v,onConnectEnd:p,onClickConnectStart:y,onClickConnectEnd:b,nodesDraggable:re,nodesConnectable:le,nodesFocusable:oe,edgesFocusable:ye,edgesUpdatable:ve,elementsSelectable:Je,elevateNodesOnSelect:uc,minZoom:at,maxZoom:Ie,nodeExtent:Ne,onNodesChange:nt,onEdgesChange:Ot,snapToGrid:q,snapGrid:W,connectionMode:N,translateExtent:yt,connectOnClick:sc,defaultEdgeOptions:cc,fitView:oc,fitViewOptions:ic,onNodesDelete:z,onEdgesDelete:P,onNodeDragStart:I,onNodeDrag:k,onNodeDragStop:A,onSelectionDrag:m,onSelectionDragStart:H,onSelectionDragStop:T,noPanClassName:Ci,nodeOrigin:Q,rfId:Wr,autoPanOnConnect:fc,autoPanOnNodeDrag:hc,onError:mc,connectionRadius:gc,isValidConnection:pc,nodeDragThreshold:vc}),_.createElement(sg,{onSelectionChange:B}),fe,_.createElement(kh,{proOptions:lc,position:ac}),_.createElement(hg,{rfId:Wr,disableKeyboardA11y:_i})))});dl.displayName="ReactFlow";function fl(e){return t=>{const[n,r]=f.useState(t),o=f.useCallback(i=>r(s=>e(i,s)),[]);return[n,r,o]}}const bp=fl(Za),xp=fl(Dg);function wp(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},_.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Ep(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},_.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Sp(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},_.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Np(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},_.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Cp(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},_.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Dn=({children:e,className:t,...n})=>_.createElement("button",{type:"button",className:Se(["react-flow__controls-button",t]),...n},e);Dn.displayName="ControlButton";const _p=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),hl=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:u,children:c,position:d="bottom-left"})=>{const g=me(),[h,v]=f.useState(!1),{isInteractive:p,minZoomReached:y,maxZoomReached:b}=ce(_p,xe),{zoomIn:w,zoomOut:E,fitView:x}=ci();if(f.useEffect(()=>{v(!0)},[]),!h)return null;const R=()=>{w(),i==null||i()},$=()=>{E(),s==null||s()},I=()=>{x(o),a==null||a()},k=()=>{g.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),l==null||l(!p)};return _.createElement(Qo,{className:Se(["react-flow__controls",u]),position:d,style:e,"data-testid":"rf__controls"},t&&_.createElement(_.Fragment,null,_.createElement(Dn,{onClick:R,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b},_.createElement(wp,null)),_.createElement(Dn,{onClick:$,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y},_.createElement(Ep,null))),n&&_.createElement(Dn,{className:"react-flow__controls-fitview",onClick:I,title:"fit view","aria-label":"fit view"},_.createElement(Sp,null)),r&&_.createElement(Dn,{className:"react-flow__controls-interactive",onClick:k,title:"toggle interactivity","aria-label":"toggle interactivity"},p?_.createElement(Cp,null):_.createElement(Np,null)),c)};hl.displayName="Controls";var Dp=f.memo(hl),Ge;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ge||(Ge={}));function Tp({color:e,dimensions:t,lineWidth:n}){return _.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function $p({color:e,radius:t}){return _.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Rp={[Ge.Dots]:"#91919a",[Ge.Lines]:"#eee",[Ge.Cross]:"#e2e2e2"},Ap={[Ge.Dots]:1,[Ge.Lines]:1,[Ge.Cross]:6},Mp=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function gl({id:e,variant:t=Ge.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=2,color:s,style:a,className:l}){const u=f.useRef(null),{transform:c,patternId:d}=ce(Mp,xe),g=s||Rp[t],h=r||Ap[t],v=t===Ge.Dots,p=t===Ge.Cross,y=Array.isArray(n)?n:[n,n],b=[y[0]*c[2]||1,y[1]*c[2]||1],w=h*c[2],E=p?[w,w]:b,x=v?[w/i,w/i]:[E[0]/i,E[1]/i];return _.createElement("svg",{className:Se(["react-flow__background",l]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},_.createElement("pattern",{id:d+e,x:c[0]%b[0],y:c[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${x[0]},-${x[1]})`},v?_.createElement($p,{color:g,radius:w/i}):_.createElement(Tp,{dimensions:E,color:g,lineWidth:o})),_.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}gl.displayName="Background";var Ip=f.memo(gl);const kp=({onSelect:e,onClose:t})=>{const[n,r]=f.useState(""),[o,i]=f.useState([]),[s,a]=f.useState(!1),[l,u]=f.useState(null),c=async h=>{var v;if(h.preventDefault(),!!n.trim()){a(!0),u(null);try{const p="AIzaSyD2KEEdCEcvZrUFIXuuQKbhj3lev8ZMIDo";console.log("Searching with query:",n);const y=await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=10&q=${encodeURIComponent(n)}&type=video&key=${p}`);if(!y.ok){const w=await y.json();throw console.error("API Error:",w),new Error(((v=w.error)==null?void 0:v.message)||"검색 중 오류가 발생했습니다.")}const b=await y.json();if(console.log("API Response:",b),!b.items)throw new Error("검색 결과를 찾을 수 없습니다.");i(b.items)}catch(p){console.error("Error details:",p),u(p instanceof Error?p.message:"검색 중 오류가 발생했습니다."),i([])}finally{a(!1)}}},d=(h,v)=>{const p=`https://www.youtube.com/watch?v=${v}`;h.dataTransfer.setData("text/plain",p),h.dataTransfer.effectAllowed="copy",console.log("드래그 시작: 비디오 ID",v),console.log("드래그 데이터 URL:",p);const y=new Image;y.src=`https://img.youtube.com/vi/${v}/default.jpg`,h.dataTransfer.setDragImage(y,10,10)},g=(h,v,p)=>{const y=`https://www.youtube.com/watch?v=${h}`;e(y,v,p)};return console.log("Current API Key:","Set"),C.jsxs("div",{className:"fixed inset-y-0 right-0 w-1/2 bg-white shadow-lg flex flex-col border-l",children:[C.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[C.jsx("h3",{className:"text-lg font-bold",children:"유튜브 검색"}),C.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),C.jsx("div",{className:"p-4 border-b",children:C.jsx("form",{onSubmit:c,children:C.jsxs("div",{className:"flex gap-2",children:[C.jsx("input",{type:"text",value:n,onChange:h=>r(h.target.value),placeholder:"검색어를 입력하세요",className:"flex-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",autoFocus:!0}),C.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 disabled:bg-gray-400",children:s?"검색 중...":"검색"})]})})}),C.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[l&&C.jsxs("div",{className:"text-red-500 text-center my-4 p-2 bg-red-50 rounded",children:[l,!1]}),C.jsx("div",{className:"space-y-4",children:s?C.jsx("div",{className:"flex justify-center items-center h-32",children:C.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500"})}):o.length>0?o.map(h=>{var v;return C.jsxs("div",{onClick:()=>g(h.id.videoId,h.snippet.title,h.snippet.description),className:"flex gap-3 p-3 hover:bg-gray-100 rounded cursor-pointer border",children:[C.jsx("img",{src:((v=h.snippet.thumbnails.medium)==null?void 0:v.url)||h.snippet.thumbnails.default.url,alt:h.snippet.title,className:"w-24 h-18 object-cover rounded",draggable:"true",onDragStart:p=>d(p,h.id.videoId),title:"클릭하여 선택하거나 드래그하여 사용하세요"}),C.jsxs("div",{className:"flex-1",children:[C.jsx("p",{className:"text-sm font-medium line-clamp-2",children:h.snippet.title}),C.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"드래그하여 사용할 수 있습니다"})]})]},h.id.videoId)}):n?C.jsx("div",{className:"text-gray-500 text-center",children:"검색 결과가 없습니다."}):C.jsxs("div",{className:"text-gray-500 text-center space-y-2",children:[C.jsx("p",{children:"1. 검색어를 입력하고 검색 버튼을 클릭하세요"}),C.jsx("p",{children:"2. 검색 결과에서 원하는 영상을 선택하세요"}),C.jsx("p",{children:"3. 선택한 영상의 URL이 자동으로 입력됩니다"}),C.jsx("p",{children:"4. 또는 썸네일을 드래그하여 입력 필드에 놓을 수 있습니다"})]})})]})]})};var Pp=Object.defineProperty,Lp=(e,t,n)=>t in e?Pp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oo=(e,t,n)=>(Lp(e,typeof t!="symbol"?t+"":t,n),n);let Op=class{constructor(){oo(this,"current",this.detect()),oo(this,"handoffState","pending"),oo(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},ht=new Op,Ve=(e,t)=>{ht.isServer?f.useEffect(e,t):f.useLayoutEffect(e,t)};function gt(e){let t=f.useRef(e);return Ve(()=>{t.current=e},[e]),t}let ae=function(e){let t=gt(e);return _.useCallback((...n)=>t.current(...n),[t])};function Fr(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function Xt(){let e=[],t={addEventListener(n,r,o,i){return n.addEventListener(r,o,i),t.add(()=>n.removeEventListener(r,o,i))},requestAnimationFrame(...n){let r=requestAnimationFrame(...n);return t.add(()=>cancelAnimationFrame(r))},nextFrame(...n){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...n))},setTimeout(...n){let r=setTimeout(...n);return t.add(()=>clearTimeout(r))},microTask(...n){let r={current:!0};return Fr(()=>{r.current&&n[0]()}),t.add(()=>{r.current=!1})},style(n,r,o){let i=n.style.getPropertyValue(r);return Object.assign(n.style,{[r]:o}),this.add(()=>{Object.assign(n.style,{[r]:i})})},group(n){let r=Xt();return n(r),this.add(()=>r.dispose())},add(n){return e.push(n),()=>{let r=e.indexOf(n);if(r>=0)for(let o of e.splice(r,1))o()}},dispose(){for(let n of e.splice(0))n()}};return t}function di(){let[e]=f.useState(Xt);return f.useEffect(()=>()=>e.dispose(),[e]),e}function jp(){let e=typeof document>"u";return"useSyncExternalStore"in Mn?(t=>t.useSyncExternalStore)(Mn)(()=>()=>{},()=>!1,()=>!e):!1}function un(){let e=jp(),[t,n]=f.useState(ht.isHandoffComplete);return t&&ht.isHandoffComplete===!1&&n(!1),f.useEffect(()=>{t!==!0&&n(!0)},[t]),f.useEffect(()=>ht.handoff(),[]),e?!1:t}var bs;let dn=(bs=_.useId)!=null?bs:function(){let e=un(),[t,n]=_.useState(e?()=>ht.nextId():null);return Ve(()=>{t===null&&n(ht.nextId())},[t]),t!=null?""+t:void 0};function be(e,t,...n){if(e in t){let o=t[e];return typeof o=="function"?o(...n):o}let r=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(o=>`"${o}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,be),r}function pl(e){return ht.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let Io=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var zt=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(zt||{}),ml=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(ml||{}),zp=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(zp||{});function Fp(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Io)).sort((t,n)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var yl=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(yl||{});function Hp(e,t=0){var n;return e===((n=pl(e))==null?void 0:n.body)?!1:be(t,{0(){return e.matches(Io)},1(){let r=e;for(;r!==null;){if(r.matches(Io))return!0;r=r.parentElement}return!1}})}var Vp=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Vp||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function Ut(e){e==null||e.focus({preventScroll:!0})}let Bp=["textarea","input"].join(",");function Up(e){var t,n;return(n=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,Bp))!=null?n:!1}function Yp(e,t=n=>n){return e.slice().sort((n,r)=>{let o=t(n),i=t(r);if(o===null||i===null)return 0;let s=o.compareDocumentPosition(i);return s&Node.DOCUMENT_POSITION_FOLLOWING?-1:s&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function gr(e,t,{sorted:n=!0,relativeTo:r=null,skipElements:o=[]}={}){let i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,s=Array.isArray(e)?n?Yp(e):e:Fp(e);o.length>0&&s.length>1&&(s=s.filter(h=>!o.includes(h))),r=r??i.activeElement;let a=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,s.indexOf(r))-1;if(t&4)return Math.max(0,s.indexOf(r))+1;if(t&8)return s.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=t&32?{preventScroll:!0}:{},c=0,d=s.length,g;do{if(c>=d||c+d<=0)return 0;let h=l+c;if(t&16)h=(h+d)%d;else{if(h<0)return 3;if(h>=d)return 1}g=s[h],g==null||g.focus(u),c+=a}while(g!==i.activeElement);return t&6&&Up(g)&&g.select(),2}function vl(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Xp(){return/Android/gi.test(window.navigator.userAgent)}function Wp(){return vl()||Xp()}function sr(e,t,n){let r=gt(t);f.useEffect(()=>{function o(i){r.current(i)}return document.addEventListener(e,o,n),()=>document.removeEventListener(e,o,n)},[e,n])}function bl(e,t,n){let r=gt(t);f.useEffect(()=>{function o(i){r.current(i)}return window.addEventListener(e,o,n),()=>window.removeEventListener(e,o,n)},[e,n])}function qp(e,t,n=!0){let r=f.useRef(!1);f.useEffect(()=>{requestAnimationFrame(()=>{r.current=n})},[n]);function o(s,a){if(!r.current||s.defaultPrevented)return;let l=a(s);if(l===null||!l.getRootNode().contains(l)||!l.isConnected)return;let u=function c(d){return typeof d=="function"?c(d()):Array.isArray(d)||d instanceof Set?d:[d]}(e);for(let c of u){if(c===null)continue;let d=c instanceof HTMLElement?c:c.current;if(d!=null&&d.contains(l)||s.composed&&s.composedPath().includes(d))return}return!Hp(l,yl.Loose)&&l.tabIndex!==-1&&s.preventDefault(),t(s,l)}let i=f.useRef(null);sr("pointerdown",s=>{var a,l;r.current&&(i.current=((l=(a=s.composedPath)==null?void 0:a.call(s))==null?void 0:l[0])||s.target)},!0),sr("mousedown",s=>{var a,l;r.current&&(i.current=((l=(a=s.composedPath)==null?void 0:a.call(s))==null?void 0:l[0])||s.target)},!0),sr("click",s=>{Wp()||i.current&&(o(s,()=>i.current),i.current=null)},!0),sr("touchend",s=>o(s,()=>s.target instanceof HTMLElement?s.target:null),!0),bl("blur",s=>o(s,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Yn(...e){return f.useMemo(()=>pl(...e),[...e])}let xl=Symbol();function Gp(e,t=!0){return Object.assign(e,{[xl]:t})}function Qe(...e){let t=f.useRef(e);f.useEffect(()=>{t.current=e},[e]);let n=ae(r=>{for(let o of t.current)o!=null&&(typeof o=="function"?o(r):o.current=r)});return e.every(r=>r==null||(r==null?void 0:r[xl]))?void 0:n}function fi(e,t){let n=f.useRef([]),r=ae(e);f.useEffect(()=>{let o=[...n.current];for(let[i,s]of t.entries())if(n.current[i]!==s){let a=r(t,o);return n.current=t,a}},[r,...t])}function Cr(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}var _r=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(_r||{}),Rt=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Rt||{});function Be({ourProps:e,theirProps:t,slot:n,defaultTag:r,features:o,visible:i=!0,name:s,mergeRefs:a}){a=a??Kp;let l=wl(t,e);if(i)return ar(l,n,r,s,a);let u=o??0;if(u&2){let{static:c=!1,...d}=l;if(c)return ar(d,n,r,s,a)}if(u&1){let{unmount:c=!0,...d}=l;return be(c?0:1,{0(){return null},1(){return ar({...d,hidden:!0,style:{display:"none"}},n,r,s,a)}})}return ar(l,n,r,s,a)}function ar(e,t={},n,r,o){let{as:i=n,children:s,refName:a="ref",...l}=io(e,["unmount","static"]),u=e.ref!==void 0?{[a]:e.ref}:{},c=typeof s=="function"?s(t):s;"className"in l&&l.className&&typeof l.className=="function"&&(l.className=l.className(t));let d={};if(t){let g=!1,h=[];for(let[v,p]of Object.entries(t))typeof p=="boolean"&&(g=!0),p===!0&&h.push(v);g&&(d["data-headlessui-state"]=h.join(" "))}if(i===f.Fragment&&Object.keys(xs(l)).length>0){if(!f.isValidElement(c)||Array.isArray(c)&&c.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(l).map(p=>`  - ${p}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(p=>`  - ${p}`).join(`
`)].join(`
`));let g=c.props,h=typeof(g==null?void 0:g.className)=="function"?(...p)=>Cr(g==null?void 0:g.className(...p),l.className):Cr(g==null?void 0:g.className,l.className),v=h?{className:h}:{};return f.cloneElement(c,Object.assign({},wl(c.props,xs(io(l,["ref"]))),d,u,{ref:o(c.ref,u.ref)},v))}return f.createElement(i,Object.assign({},io(l,["ref"]),i!==f.Fragment&&u,i!==f.Fragment&&d),c)}function Kp(...e){return e.every(t=>t==null)?void 0:t=>{for(let n of e)n!=null&&(typeof n=="function"?n(t):n.current=t)}}function wl(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},n={};for(let r of e)for(let o in r)o.startsWith("on")&&typeof r[o]=="function"?(n[o]!=null||(n[o]=[]),n[o].push(r[o])):t[o]=r[o];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(n).map(r=>[r,void 0])));for(let r in n)Object.assign(t,{[r](o,...i){let s=n[r];for(let a of s){if((o instanceof Event||(o==null?void 0:o.nativeEvent)instanceof Event)&&o.defaultPrevented)return;a(o,...i)}}});return t}function Me(e){var t;return Object.assign(f.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function xs(e){let t=Object.assign({},e);for(let n in t)t[n]===void 0&&delete t[n];return t}function io(e,t=[]){let n=Object.assign({},e);for(let r of t)r in n&&delete n[r];return n}let Zp="div";var Dr=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Dr||{});function Qp(e,t){var n;let{features:r=1,...o}=e,i={ref:t,"aria-hidden":(r&2)===2?!0:(n=o["aria-hidden"])!=null?n:void 0,hidden:(r&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(r&4)===4&&(r&2)!==2&&{display:"none"}}};return Be({ourProps:i,theirProps:o,slot:{},defaultTag:Zp,name:"Hidden"})}let ko=Me(Qp),hi=f.createContext(null);hi.displayName="OpenClosedContext";var Re=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Re||{});function gi(){return f.useContext(hi)}function Jp({value:e,children:t}){return _.createElement(hi.Provider,{value:e},t)}function em(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let Tt=[];em(()=>{function e(t){t.target instanceof HTMLElement&&t.target!==document.body&&Tt[0]!==t.target&&(Tt.unshift(t.target),Tt=Tt.filter(n=>n!=null&&n.isConnected),Tt.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function tm(e){let t=e.parentElement,n=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(n=t),t=t.parentElement;let r=(t==null?void 0:t.getAttribute("disabled"))==="";return r&&nm(n)?!1:r}function nm(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}var El=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(El||{});function Sl(e,t,n,r){let o=gt(n);f.useEffect(()=>{e=e??window;function i(s){o.current(s)}return e.addEventListener(t,i,r),()=>e.removeEventListener(t,i,r)},[e,t,r])}function Xn(){let e=f.useRef(!1);return Ve(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Nl(e){let t=ae(e),n=f.useRef(!1);f.useEffect(()=>(n.current=!1,()=>{n.current=!0,Fr(()=>{n.current&&t()})}),[t])}var Tn=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Tn||{});function rm(){let e=f.useRef(0);return bl("keydown",t=>{t.key==="Tab"&&(e.current=t.shiftKey?1:0)},!0),e}function Cl(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let n of e.current)n.current instanceof HTMLElement&&t.add(n.current);return t}let om="div";var _l=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(_l||{});function im(e,t){let n=f.useRef(null),r=Qe(n,t),{initialFocus:o,containers:i,features:s=30,...a}=e;un()||(s=1);let l=Yn(n);lm({ownerDocument:l},!!(s&16));let u=cm({ownerDocument:l,container:n,initialFocus:o},!!(s&2));um({ownerDocument:l,container:n,containers:i,previousActiveElement:u},!!(s&8));let c=rm(),d=ae(p=>{let y=n.current;y&&(b=>b())(()=>{be(c.current,{[Tn.Forwards]:()=>{gr(y,zt.First,{skipElements:[p.relatedTarget]})},[Tn.Backwards]:()=>{gr(y,zt.Last,{skipElements:[p.relatedTarget]})}})})}),g=di(),h=f.useRef(!1),v={ref:r,onKeyDown(p){p.key=="Tab"&&(h.current=!0,g.requestAnimationFrame(()=>{h.current=!1}))},onBlur(p){let y=Cl(i);n.current instanceof HTMLElement&&y.add(n.current);let b=p.relatedTarget;b instanceof HTMLElement&&b.dataset.headlessuiFocusGuard!=="true"&&(Dl(y,b)||(h.current?gr(n.current,be(c.current,{[Tn.Forwards]:()=>zt.Next,[Tn.Backwards]:()=>zt.Previous})|zt.WrapAround,{relativeTo:p.target}):p.target instanceof HTMLElement&&Ut(p.target)))}};return _.createElement(_.Fragment,null,!!(s&4)&&_.createElement(ko,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:d,features:Dr.Focusable}),Be({ourProps:v,theirProps:a,defaultTag:om,name:"FocusTrap"}),!!(s&4)&&_.createElement(ko,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:d,features:Dr.Focusable}))}let sm=Me(im),Sn=Object.assign(sm,{features:_l});function am(e=!0){let t=f.useRef(Tt.slice());return fi(([n],[r])=>{r===!0&&n===!1&&Fr(()=>{t.current.splice(0)}),r===!1&&n===!0&&(t.current=Tt.slice())},[e,Tt,t]),ae(()=>{var n;return(n=t.current.find(r=>r!=null&&r.isConnected))!=null?n:null})}function lm({ownerDocument:e},t){let n=am(t);fi(()=>{t||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&Ut(n())},[t]),Nl(()=>{t&&Ut(n())})}function cm({ownerDocument:e,container:t,initialFocus:n},r){let o=f.useRef(null),i=Xn();return fi(()=>{if(!r)return;let s=t.current;s&&Fr(()=>{if(!i.current)return;let a=e==null?void 0:e.activeElement;if(n!=null&&n.current){if((n==null?void 0:n.current)===a){o.current=a;return}}else if(s.contains(a)){o.current=a;return}n!=null&&n.current?Ut(n.current):gr(s,zt.First)===ml.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),o.current=e==null?void 0:e.activeElement})},[r]),o}function um({ownerDocument:e,container:t,containers:n,previousActiveElement:r},o){let i=Xn();Sl(e==null?void 0:e.defaultView,"focus",s=>{if(!o||!i.current)return;let a=Cl(n);t.current instanceof HTMLElement&&a.add(t.current);let l=r.current;if(!l)return;let u=s.target;u&&u instanceof HTMLElement?Dl(a,u)?(r.current=u,Ut(u)):(s.preventDefault(),s.stopPropagation(),Ut(l)):Ut(r.current)},!0)}function Dl(e,t){for(let n of e)if(n.contains(t))return!0;return!1}let Tl=f.createContext(!1);function dm(){return f.useContext(Tl)}function Po(e){return _.createElement(Tl.Provider,{value:e.force},e.children)}function fm(e){let t=dm(),n=f.useContext($l),r=Yn(e),[o,i]=f.useState(()=>{if(!t&&n!==null||ht.isServer)return null;let s=r==null?void 0:r.getElementById("headlessui-portal-root");if(s)return s;if(r===null)return null;let a=r.createElement("div");return a.setAttribute("id","headlessui-portal-root"),r.body.appendChild(a)});return f.useEffect(()=>{o!==null&&(r!=null&&r.body.contains(o)||r==null||r.body.appendChild(o))},[o,r]),f.useEffect(()=>{t||n!==null&&i(n.current)},[n,i,t]),o}let hm=f.Fragment;function gm(e,t){let n=e,r=f.useRef(null),o=Qe(Gp(c=>{r.current=c}),t),i=Yn(r),s=fm(r),[a]=f.useState(()=>{var c;return ht.isServer?null:(c=i==null?void 0:i.createElement("div"))!=null?c:null}),l=f.useContext(Lo),u=un();return Ve(()=>{!s||!a||s.contains(a)||(a.setAttribute("data-headlessui-portal",""),s.appendChild(a))},[s,a]),Ve(()=>{if(a&&l)return l.register(a)},[l,a]),Nl(()=>{var c;!s||!a||(a instanceof Node&&s.contains(a)&&s.removeChild(a),s.childNodes.length<=0&&((c=s.parentElement)==null||c.removeChild(s)))}),u?!s||!a?null:Zt.createPortal(Be({ourProps:{ref:o},theirProps:n,defaultTag:hm,name:"Portal"}),a):null}let pm=f.Fragment,$l=f.createContext(null);function mm(e,t){let{target:n,...r}=e,o={ref:Qe(t)};return _.createElement($l.Provider,{value:n},Be({ourProps:o,theirProps:r,defaultTag:pm,name:"Popover.Group"}))}let Lo=f.createContext(null);function ym(){let e=f.useContext(Lo),t=f.useRef([]),n=ae(i=>(t.current.push(i),e&&e.register(i),()=>r(i))),r=ae(i=>{let s=t.current.indexOf(i);s!==-1&&t.current.splice(s,1),e&&e.unregister(i)}),o=f.useMemo(()=>({register:n,unregister:r,portals:t}),[n,r,t]);return[t,f.useMemo(()=>function({children:i}){return _.createElement(Lo.Provider,{value:o},i)},[o])]}let vm=Me(gm),bm=Me(mm),Oo=Object.assign(vm,{Group:bm});function xm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}const wm=typeof Object.is=="function"?Object.is:xm,{useState:Em,useEffect:Sm,useLayoutEffect:Nm,useDebugValue:Cm}=Mn;function _m(e,t,n){const r=t(),[{inst:o},i]=Em({inst:{value:r,getSnapshot:t}});return Nm(()=>{o.value=r,o.getSnapshot=t,so(o)&&i({inst:o})},[e,r,t]),Sm(()=>(so(o)&&i({inst:o}),e(()=>{so(o)&&i({inst:o})})),[e]),Cm(r),r}function so(e){const t=e.getSnapshot,n=e.value;try{const r=t();return!wm(n,r)}catch{return!0}}function Dm(e,t,n){return t()}const Tm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$m=!Tm,Rm=$m?Dm:_m,Am="useSyncExternalStore"in Mn?(e=>e.useSyncExternalStore)(Mn):Rm;function Mm(e){return Am(e.subscribe,e.getSnapshot,e.getSnapshot)}function Im(e,t){let n=e(),r=new Set;return{getSnapshot(){return n},subscribe(o){return r.add(o),()=>r.delete(o)},dispatch(o,...i){let s=t[o].call(n,...i);s&&(n=s,r.forEach(a=>a()))}}}function km(){let e;return{before({doc:t}){var n;let r=t.documentElement;e=((n=t.defaultView)!=null?n:window).innerWidth-r.clientWidth},after({doc:t,d:n}){let r=t.documentElement,o=r.clientWidth-r.offsetWidth,i=e-o;n.style(r,"paddingRight",`${i}px`)}}}function Pm(){return vl()?{before({doc:e,d:t,meta:n}){function r(o){return n.containers.flatMap(i=>i()).some(i=>i.contains(o))}t.microTask(()=>{var o;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let a=Xt();a.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>a.dispose()))}let i=(o=window.scrollY)!=null?o:window.pageYOffset,s=null;t.addEventListener(e,"click",a=>{if(a.target instanceof HTMLElement)try{let l=a.target.closest("a");if(!l)return;let{hash:u}=new URL(l.href),c=e.querySelector(u);c&&!r(c)&&(s=c)}catch{}},!0),t.addEventListener(e,"touchstart",a=>{if(a.target instanceof HTMLElement)if(r(a.target)){let l=a.target;for(;l.parentElement&&r(l.parentElement);)l=l.parentElement;t.style(l,"overscrollBehavior","contain")}else t.style(a.target,"touchAction","none")}),t.addEventListener(e,"touchmove",a=>{if(a.target instanceof HTMLElement)if(r(a.target)){let l=a.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&a.preventDefault()}else a.preventDefault()},{passive:!1}),t.add(()=>{var a;let l=(a=window.scrollY)!=null?a:window.pageYOffset;i!==l&&window.scrollTo(0,i),s&&s.isConnected&&(s.scrollIntoView({block:"nearest"}),s=null)})})}}:{}}function Lm(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function Om(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let Vt=Im(()=>new Map,{PUSH(e,t){var n;let r=(n=this.get(e))!=null?n:{doc:e,count:0,d:Xt(),meta:new Set};return r.count++,r.meta.add(t),this.set(e,r),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:n}){let r={doc:e,d:t,meta:Om(n)},o=[Pm(),km(),Lm()];o.forEach(({before:i})=>i==null?void 0:i(r)),o.forEach(({after:i})=>i==null?void 0:i(r))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});Vt.subscribe(()=>{let e=Vt.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let r=t.get(n.doc)==="hidden",o=n.count!==0;(o&&!r||!o&&r)&&Vt.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&Vt.dispatch("TEARDOWN",n)}});function jm(e,t,n){let r=Mm(Vt),o=e?r.get(e):void 0,i=o?o.count>0:!1;return Ve(()=>{if(!(!e||!t))return Vt.dispatch("PUSH",e,n),()=>Vt.dispatch("POP",e,n)},[t,e]),i}let ao=new Map,Nn=new Map;function ws(e,t=!0){Ve(()=>{var n;if(!t)return;let r=typeof e=="function"?e():e.current;if(!r)return;function o(){var s;if(!r)return;let a=(s=Nn.get(r))!=null?s:1;if(a===1?Nn.delete(r):Nn.set(r,a-1),a!==1)return;let l=ao.get(r);l&&(l["aria-hidden"]===null?r.removeAttribute("aria-hidden"):r.setAttribute("aria-hidden",l["aria-hidden"]),r.inert=l.inert,ao.delete(r))}let i=(n=Nn.get(r))!=null?n:0;return Nn.set(r,i+1),i!==0||(ao.set(r,{"aria-hidden":r.getAttribute("aria-hidden"),inert:r.inert}),r.setAttribute("aria-hidden","true"),r.inert=!0),o},[e,t])}function zm({defaultContainers:e=[],portals:t,mainTreeNodeRef:n}={}){var r;let o=f.useRef((r=n==null?void 0:n.current)!=null?r:null),i=Yn(o),s=ae(()=>{var a,l,u;let c=[];for(let d of e)d!==null&&(d instanceof HTMLElement?c.push(d):"current"in d&&d.current instanceof HTMLElement&&c.push(d.current));if(t!=null&&t.current)for(let d of t.current)c.push(d);for(let d of(a=i==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?a:[])d!==document.body&&d!==document.head&&d instanceof HTMLElement&&d.id!=="headlessui-portal-root"&&(d.contains(o.current)||d.contains((u=(l=o.current)==null?void 0:l.getRootNode())==null?void 0:u.host)||c.some(g=>d.contains(g))||c.push(d));return c});return{resolveContainers:s,contains:ae(a=>s().some(l=>l.contains(a))),mainTreeNodeRef:o,MainTreeNode:f.useMemo(()=>function(){return n!=null?null:_.createElement(ko,{features:Dr.Hidden,ref:o})},[o,n])}}let pi=f.createContext(()=>{});pi.displayName="StackContext";var jo=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(jo||{});function Fm(){return f.useContext(pi)}function Hm({children:e,onUpdate:t,type:n,element:r,enabled:o}){let i=Fm(),s=ae((...a)=>{t==null||t(...a),i(...a)});return Ve(()=>{let a=o===void 0||o===!0;return a&&s(0,n,r),()=>{a&&s(1,n,r)}},[s,n,r,o]),_.createElement(pi.Provider,{value:s},e)}let Rl=f.createContext(null);function Al(){let e=f.useContext(Rl);if(e===null){let t=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,Al),t}return e}function Vm(){let[e,t]=f.useState([]);return[e.length>0?e.join(" "):void 0,f.useMemo(()=>function(n){let r=ae(i=>(t(s=>[...s,i]),()=>t(s=>{let a=s.slice(),l=a.indexOf(i);return l!==-1&&a.splice(l,1),a}))),o=f.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props}),[r,n.slot,n.name,n.props]);return _.createElement(Rl.Provider,{value:o},n.children)},[t])]}let Bm="p";function Um(e,t){let n=dn(),{id:r=`headlessui-description-${n}`,...o}=e,i=Al(),s=Qe(t);Ve(()=>i.register(r),[r,i.register]);let a={ref:s,...i.props,id:r};return Be({ourProps:a,theirProps:o,slot:i.slot||{},defaultTag:Bm,name:i.name||"Description"})}let Ym=Me(Um),Xm=Object.assign(Ym,{});var Wm=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Wm||{}),qm=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(qm||{});let Gm={0(e,t){return e.titleId===t.id?e:{...e,titleId:t.id}}},Tr=f.createContext(null);Tr.displayName="DialogContext";function Wn(e){let t=f.useContext(Tr);if(t===null){let n=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Wn),n}return t}function Km(e,t,n=()=>[document.body]){jm(e,t,r=>{var o;return{containers:[...(o=r.containers)!=null?o:[],n]}})}function Zm(e,t){return be(t.type,Gm,e,t)}let Qm="div",Jm=_r.RenderStrategy|_r.Static;function e0(e,t){let n=dn(),{id:r=`headlessui-dialog-${n}`,open:o,onClose:i,initialFocus:s,role:a="dialog",__demoMode:l=!1,...u}=e,[c,d]=f.useState(0),g=f.useRef(!1);a=function(){return a==="dialog"||a==="alertdialog"?a:(g.current||(g.current=!0,console.warn(`Invalid role [${a}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let h=gi();o===void 0&&h!==null&&(o=(h&Re.Open)===Re.Open);let v=f.useRef(null),p=Qe(v,t),y=Yn(v),b=e.hasOwnProperty("open")||h!==null,w=e.hasOwnProperty("onClose");if(!b&&!w)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!b)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!w)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof o!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${o}`);if(typeof i!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${i}`);let E=o?0:1,[x,R]=f.useReducer(Zm,{titleId:null,descriptionId:null,panelRef:f.createRef()}),$=ae(()=>i(!1)),I=ae(q=>R({type:0,id:q})),k=un()?l?!1:E===0:!1,A=c>1,z=f.useContext(Tr)!==null,[P,B]=ym(),H={get current(){var q;return(q=x.panelRef.current)!=null?q:v.current}},{resolveContainers:m,mainTreeNodeRef:T,MainTreeNode:S}=zm({portals:P,defaultContainers:[H]}),D=A?"parent":"leaf",L=h!==null?(h&Re.Closing)===Re.Closing:!1,N=z||L?!1:k,M=f.useCallback(()=>{var q,W;return(W=Array.from((q=y==null?void 0:y.querySelectorAll("body > *"))!=null?q:[]).find(Z=>Z.id==="headlessui-portal-root"?!1:Z.contains(T.current)&&Z instanceof HTMLElement))!=null?W:null},[T]);ws(M,N);let F=A?!0:k,O=f.useCallback(()=>{var q,W;return(W=Array.from((q=y==null?void 0:y.querySelectorAll("[data-headlessui-portal]"))!=null?q:[]).find(Z=>Z.contains(T.current)&&Z instanceof HTMLElement))!=null?W:null},[T]);ws(O,F),qp(m,q=>{q.preventDefault(),$()},!(!k||A));let Y=!(A||E!==0);Sl(y==null?void 0:y.defaultView,"keydown",q=>{Y&&(q.defaultPrevented||q.key===El.Escape&&(q.preventDefault(),q.stopPropagation(),$()))}),Km(y,!(L||E!==0||z),m),f.useEffect(()=>{if(E!==0||!v.current)return;let q=new ResizeObserver(W=>{for(let Z of W){let ne=Z.target.getBoundingClientRect();ne.x===0&&ne.y===0&&ne.width===0&&ne.height===0&&$()}});return q.observe(v.current),()=>q.disconnect()},[E,v,$]);let[J,ee]=Vm(),j=f.useMemo(()=>[{dialogState:E,close:$,setTitleId:I},x],[E,x,$,I]),U=f.useMemo(()=>({open:E===0}),[E]),V={ref:p,id:r,role:a,"aria-modal":E===0?!0:void 0,"aria-labelledby":x.titleId,"aria-describedby":J};return _.createElement(Hm,{type:"Dialog",enabled:E===0,element:v,onUpdate:ae((q,W)=>{W==="Dialog"&&be(q,{[jo.Add]:()=>d(Z=>Z+1),[jo.Remove]:()=>d(Z=>Z-1)})})},_.createElement(Po,{force:!0},_.createElement(Oo,null,_.createElement(Tr.Provider,{value:j},_.createElement(Oo.Group,{target:v},_.createElement(Po,{force:!1},_.createElement(ee,{slot:U,name:"Dialog.Description"},_.createElement(Sn,{initialFocus:s,containers:m,features:k?be(D,{parent:Sn.features.RestoreFocus,leaf:Sn.features.All&~Sn.features.FocusLock}):Sn.features.None},_.createElement(B,null,Be({ourProps:V,theirProps:u,slot:U,defaultTag:Qm,features:Jm,visible:E===0,name:"Dialog"}))))))))),_.createElement(S,null))}let t0="div";function n0(e,t){let n=dn(),{id:r=`headlessui-dialog-overlay-${n}`,...o}=e,[{dialogState:i,close:s}]=Wn("Dialog.Overlay"),a=Qe(t),l=ae(c=>{if(c.target===c.currentTarget){if(tm(c.currentTarget))return c.preventDefault();c.preventDefault(),c.stopPropagation(),s()}}),u=f.useMemo(()=>({open:i===0}),[i]);return Be({ourProps:{ref:a,id:r,"aria-hidden":!0,onClick:l},theirProps:o,slot:u,defaultTag:t0,name:"Dialog.Overlay"})}let r0="div";function o0(e,t){let n=dn(),{id:r=`headlessui-dialog-backdrop-${n}`,...o}=e,[{dialogState:i},s]=Wn("Dialog.Backdrop"),a=Qe(t);f.useEffect(()=>{if(s.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[s.panelRef]);let l=f.useMemo(()=>({open:i===0}),[i]);return _.createElement(Po,{force:!0},_.createElement(Oo,null,Be({ourProps:{ref:a,id:r,"aria-hidden":!0},theirProps:o,slot:l,defaultTag:r0,name:"Dialog.Backdrop"})))}let i0="div";function s0(e,t){let n=dn(),{id:r=`headlessui-dialog-panel-${n}`,...o}=e,[{dialogState:i},s]=Wn("Dialog.Panel"),a=Qe(t,s.panelRef),l=f.useMemo(()=>({open:i===0}),[i]),u=ae(c=>{c.stopPropagation()});return Be({ourProps:{ref:a,id:r,onClick:u},theirProps:o,slot:l,defaultTag:i0,name:"Dialog.Panel"})}let a0="h2";function l0(e,t){let n=dn(),{id:r=`headlessui-dialog-title-${n}`,...o}=e,[{dialogState:i,setTitleId:s}]=Wn("Dialog.Title"),a=Qe(t);f.useEffect(()=>(s(r),()=>s(null)),[r,s]);let l=f.useMemo(()=>({open:i===0}),[i]);return Be({ourProps:{ref:a,id:r},theirProps:o,slot:l,defaultTag:a0,name:"Dialog.Title"})}let c0=Me(e0),u0=Me(o0),d0=Me(s0),f0=Me(n0),h0=Me(l0),lo=Object.assign(c0,{Backdrop:u0,Panel:d0,Overlay:f0,Title:h0,Description:Xm});function g0(e=0){let[t,n]=f.useState(e),r=Xn(),o=f.useCallback(l=>{r.current&&n(u=>u|l)},[t,r]),i=f.useCallback(l=>!!(t&l),[t]),s=f.useCallback(l=>{r.current&&n(u=>u&~l)},[n,r]),a=f.useCallback(l=>{r.current&&n(u=>u^l)},[n]);return{flags:t,addFlag:o,hasFlag:i,removeFlag:s,toggleFlag:a}}function p0(e){let t={called:!1};return(...n)=>{if(!t.called)return t.called=!0,e(...n)}}function co(e,...t){e&&t.length>0&&e.classList.add(...t)}function uo(e,...t){e&&t.length>0&&e.classList.remove(...t)}function m0(e,t){let n=Xt();if(!e)return n.dispose;let{transitionDuration:r,transitionDelay:o}=getComputedStyle(e),[i,s]=[r,o].map(l=>{let[u=0]=l.split(",").filter(Boolean).map(c=>c.includes("ms")?parseFloat(c):parseFloat(c)*1e3).sort((c,d)=>d-c);return u}),a=i+s;if(a!==0){n.group(u=>{u.setTimeout(()=>{t(),u.dispose()},a),u.addEventListener(e,"transitionrun",c=>{c.target===c.currentTarget&&u.dispose()})});let l=n.addEventListener(e,"transitionend",u=>{u.target===u.currentTarget&&(t(),l())})}else t();return n.add(()=>t()),n.dispose}function y0(e,t,n,r){let o=n?"enter":"leave",i=Xt(),s=r!==void 0?p0(r):()=>{};o==="enter"&&(e.removeAttribute("hidden"),e.style.display="");let a=be(o,{enter:()=>t.enter,leave:()=>t.leave}),l=be(o,{enter:()=>t.enterTo,leave:()=>t.leaveTo}),u=be(o,{enter:()=>t.enterFrom,leave:()=>t.leaveFrom});return uo(e,...t.base,...t.enter,...t.enterTo,...t.enterFrom,...t.leave,...t.leaveFrom,...t.leaveTo,...t.entered),co(e,...t.base,...a,...u),i.nextFrame(()=>{uo(e,...t.base,...a,...u),co(e,...t.base,...a,...l),m0(e,()=>(uo(e,...t.base,...a),co(e,...t.base,...t.entered),s()))}),i.dispose}function v0({immediate:e,container:t,direction:n,classes:r,onStart:o,onStop:i}){let s=Xn(),a=di(),l=gt(n);Ve(()=>{e&&(l.current="enter")},[e]),Ve(()=>{let u=Xt();a.add(u.dispose);let c=t.current;if(c&&l.current!=="idle"&&s.current)return u.dispose(),o.current(l.current),u.add(y0(c,r.current,l.current==="enter",()=>{u.dispose(),i.current(l.current)})),u.dispose},[n])}function Et(e=""){return e.split(/\s+/).filter(t=>t.length>1)}let Hr=f.createContext(null);Hr.displayName="TransitionContext";var b0=(e=>(e.Visible="visible",e.Hidden="hidden",e))(b0||{});function x0(){let e=f.useContext(Hr);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function w0(){let e=f.useContext(Vr);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let Vr=f.createContext(null);Vr.displayName="NestingContext";function Br(e){return"children"in e?Br(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function Ml(e,t){let n=gt(e),r=f.useRef([]),o=Xn(),i=di(),s=ae((h,v=Rt.Hidden)=>{let p=r.current.findIndex(({el:y})=>y===h);p!==-1&&(be(v,{[Rt.Unmount](){r.current.splice(p,1)},[Rt.Hidden](){r.current[p].state="hidden"}}),i.microTask(()=>{var y;!Br(r)&&o.current&&((y=n.current)==null||y.call(n))}))}),a=ae(h=>{let v=r.current.find(({el:p})=>p===h);return v?v.state!=="visible"&&(v.state="visible"):r.current.push({el:h,state:"visible"}),()=>s(h,Rt.Unmount)}),l=f.useRef([]),u=f.useRef(Promise.resolve()),c=f.useRef({enter:[],leave:[],idle:[]}),d=ae((h,v,p)=>{l.current.splice(0),t&&(t.chains.current[v]=t.chains.current[v].filter(([y])=>y!==h)),t==null||t.chains.current[v].push([h,new Promise(y=>{l.current.push(y)})]),t==null||t.chains.current[v].push([h,new Promise(y=>{Promise.all(c.current[v].map(([b,w])=>w)).then(()=>y())})]),v==="enter"?u.current=u.current.then(()=>t==null?void 0:t.wait.current).then(()=>p(v)):p(v)}),g=ae((h,v,p)=>{Promise.all(c.current[v].splice(0).map(([y,b])=>b)).then(()=>{var y;(y=l.current.shift())==null||y()}).then(()=>p(v))});return f.useMemo(()=>({children:r,register:a,unregister:s,onStart:d,onStop:g,wait:u,chains:c}),[a,s,r,d,g,c,u])}function E0(){}let S0=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Es(e){var t;let n={};for(let r of S0)n[r]=(t=e[r])!=null?t:E0;return n}function N0(e){let t=f.useRef(Es(e));return f.useEffect(()=>{t.current=Es(e)},[e]),t}let C0="div",Il=_r.RenderStrategy;function _0(e,t){var n,r;let{beforeEnter:o,afterEnter:i,beforeLeave:s,afterLeave:a,enter:l,enterFrom:u,enterTo:c,entered:d,leave:g,leaveFrom:h,leaveTo:v,...p}=e,y=f.useRef(null),b=Qe(y,t),w=(n=p.unmount)==null||n?Rt.Unmount:Rt.Hidden,{show:E,appear:x,initial:R}=x0(),[$,I]=f.useState(E?"visible":"hidden"),k=w0(),{register:A,unregister:z}=k;f.useEffect(()=>A(y),[A,y]),f.useEffect(()=>{if(w===Rt.Hidden&&y.current){if(E&&$!=="visible"){I("visible");return}return be($,{hidden:()=>z(y),visible:()=>A(y)})}},[$,y,A,z,E,w]);let P=gt({base:Et(p.className),enter:Et(l),enterFrom:Et(u),enterTo:Et(c),entered:Et(d),leave:Et(g),leaveFrom:Et(h),leaveTo:Et(v)}),B=N0({beforeEnter:o,afterEnter:i,beforeLeave:s,afterLeave:a}),H=un();f.useEffect(()=>{if(H&&$==="visible"&&y.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[y,$,H]);let m=R&&!x,T=x&&E&&R,S=!H||m?"idle":E?"enter":"leave",D=g0(0),L=ae(Y=>be(Y,{enter:()=>{D.addFlag(Re.Opening),B.current.beforeEnter()},leave:()=>{D.addFlag(Re.Closing),B.current.beforeLeave()},idle:()=>{}})),N=ae(Y=>be(Y,{enter:()=>{D.removeFlag(Re.Opening),B.current.afterEnter()},leave:()=>{D.removeFlag(Re.Closing),B.current.afterLeave()},idle:()=>{}})),M=Ml(()=>{I("hidden"),z(y)},k),F=f.useRef(!1);v0({immediate:T,container:y,classes:P,direction:S,onStart:gt(Y=>{F.current=!0,M.onStart(y,Y,L)}),onStop:gt(Y=>{F.current=!1,M.onStop(y,Y,N),Y==="leave"&&!Br(M)&&(I("hidden"),z(y))})});let O=p,X={ref:b};return T?O={...O,className:Cr(p.className,...P.current.enter,...P.current.enterFrom)}:F.current&&(O.className=Cr(p.className,(r=y.current)==null?void 0:r.className),O.className===""&&delete O.className),_.createElement(Vr.Provider,{value:M},_.createElement(Jp,{value:be($,{visible:Re.Open,hidden:Re.Closed})|D.flags},Be({ourProps:X,theirProps:O,defaultTag:C0,features:Il,visible:$==="visible",name:"Transition.Child"})))}function D0(e,t){let{show:n,appear:r=!1,unmount:o=!0,...i}=e,s=f.useRef(null),a=Qe(s,t);un();let l=gi();if(n===void 0&&l!==null&&(n=(l&Re.Open)===Re.Open),![!0,!1].includes(n))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[u,c]=f.useState(n?"visible":"hidden"),d=Ml(()=>{c("hidden")}),[g,h]=f.useState(!0),v=f.useRef([n]);Ve(()=>{g!==!1&&v.current[v.current.length-1]!==n&&(v.current.push(n),h(!1))},[v,n]);let p=f.useMemo(()=>({show:n,appear:r,initial:g}),[n,r,g]);f.useEffect(()=>{if(n)c("visible");else if(!Br(d))c("hidden");else{let E=s.current;if(!E)return;let x=E.getBoundingClientRect();x.x===0&&x.y===0&&x.width===0&&x.height===0&&c("hidden")}},[n,d]);let y={unmount:o},b=ae(()=>{var E;g&&h(!1),(E=e.beforeEnter)==null||E.call(e)}),w=ae(()=>{var E;g&&h(!1),(E=e.beforeLeave)==null||E.call(e)});return _.createElement(Vr.Provider,{value:d},_.createElement(Hr.Provider,{value:p},Be({ourProps:{...y,as:f.Fragment,children:_.createElement(kl,{ref:a,...y,...i,beforeEnter:b,beforeLeave:w})},theirProps:{},defaultTag:f.Fragment,features:Il,visible:u==="visible",name:"Transition"})))}function T0(e,t){let n=f.useContext(Hr)!==null,r=gi()!==null;return _.createElement(_.Fragment,null,!n&&r?_.createElement(zo,{ref:t,...e}):_.createElement(kl,{ref:t,...e}))}let zo=Me(D0),kl=Me(_0),$0=Me(T0),fo=Object.assign(zo,{Child:$0,Root:zo});const R0=({isOpen:e,onClose:t,title:n,children:r,size:o="md",onConfirm:i,confirmText:s="확인",buttons:a})=>{const l={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"};return C.jsx(fo,{appear:!0,show:e,as:f.Fragment,children:C.jsxs(lo,{as:"div",className:"relative z-50",onClose:t,children:[C.jsx(fo.Child,{as:f.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:C.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25","data-testid":"modal-overlay",onClick:t})}),C.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:C.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:C.jsx(fo.Child,{as:f.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:C.jsxs(lo.Panel,{className:`w-full ${l[o]} transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all max-h-[80vh] overflow-y-auto`,role:"dialog","aria-modal":"true",children:[n&&C.jsx(lo.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 mb-4",children:n}),C.jsx("div",{className:"mt-2",children:r}),C.jsx("div",{className:"mt-4 flex justify-end space-x-2",children:a?a.map((u,c)=>C.jsx("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-6 py-3 text-base font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",onClick:u.onClick,"aria-label":u.text,tabIndex:0,role:"button",children:u.text},c)):C.jsxs(C.Fragment,{children:[C.jsx("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-6 py-3 text-base font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",onClick:t,"aria-label":"닫기",tabIndex:0,role:"button",children:"닫기"}),i&&C.jsx("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-600 px-6 py-3 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",onClick:i,"aria-label":s,tabIndex:0,role:"button",children:s})]})})]})})})})]})})};function A0(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const Ur=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function fn(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function mi(e){return"nodeType"in e}function Te(e){var t,n;return e?fn(e)?e:mi(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function yi(e){const{Document:t}=Te(e);return e instanceof t}function qn(e){return fn(e)?!1:e instanceof Te(e).HTMLElement}function Pl(e){return e instanceof Te(e).SVGElement}function hn(e){return e?fn(e)?e.document:mi(e)?yi(e)?e:qn(e)||Pl(e)?e.ownerDocument:document:document:document}const it=Ur?f.useLayoutEffect:f.useEffect;function vi(e){const t=f.useRef(e);return it(()=>{t.current=e}),f.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function M0(){const e=f.useRef(null),t=f.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=f.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Fn(e,t){t===void 0&&(t=[e]);const n=f.useRef(e);return it(()=>{n.current!==e&&(n.current=e)},t),n}function Gn(e,t){const n=f.useRef();return f.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function $r(e){const t=vi(e),n=f.useRef(null),r=f.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,r]}function Fo(e){const t=f.useRef();return f.useEffect(()=>{t.current=e},[e]),t.current}let ho={};function Kn(e,t){return f.useMemo(()=>{if(t)return t;const n=ho[e]==null?0:ho[e]+1;return ho[e]=n,e+"-"+n},[e,t])}function Ll(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((i,s)=>{const a=Object.entries(s);for(const[l,u]of a){const c=i[l];c!=null&&(i[l]=c+e*u)}return i},{...t})}}const rn=Ll(1),Rr=Ll(-1);function I0(e){return"clientX"in e&&"clientY"in e}function bi(e){if(!e)return!1;const{KeyboardEvent:t}=Te(e.target);return t&&e instanceof t}function k0(e){if(!e)return!1;const{TouchEvent:t}=Te(e.target);return t&&e instanceof t}function Ho(e){if(k0(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return I0(e)?{x:e.clientX,y:e.clientY}:null}const cn=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[cn.Translate.toString(e),cn.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Ss="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function P0(e){return e.matches(Ss)?e:e.querySelector(Ss)}const L0={display:"none"};function O0(e){let{id:t,value:n}=e;return _.createElement("div",{id:t,style:L0},n)}function j0(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return _.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function z0(){const[e,t]=f.useState("");return{announce:f.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Ol=f.createContext(null);function F0(e){const t=f.useContext(Ol);f.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function H0(){const[e]=f.useState(()=>new Set),t=f.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[f.useCallback(r=>{let{type:o,event:i}=r;e.forEach(s=>{var a;return(a=s[o])==null?void 0:a.call(s,i)})},[e]),t]}const V0={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},B0={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function U0(e){let{announcements:t=B0,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=V0}=e;const{announce:i,announcement:s}=z0(),a=Kn("DndLiveRegion"),[l,u]=f.useState(!1);if(f.useEffect(()=>{u(!0)},[]),F0(f.useMemo(()=>({onDragStart(d){let{active:g}=d;i(t.onDragStart({active:g}))},onDragMove(d){let{active:g,over:h}=d;t.onDragMove&&i(t.onDragMove({active:g,over:h}))},onDragOver(d){let{active:g,over:h}=d;i(t.onDragOver({active:g,over:h}))},onDragEnd(d){let{active:g,over:h}=d;i(t.onDragEnd({active:g,over:h}))},onDragCancel(d){let{active:g,over:h}=d;i(t.onDragCancel({active:g,over:h}))}}),[i,t])),!l)return null;const c=_.createElement(_.Fragment,null,_.createElement(O0,{id:r,value:o.draggable}),_.createElement(j0,{id:a,announcement:s}));return n?Zt.createPortal(c,n):c}var ge;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ge||(ge={}));function Ar(){}function Y0(e,t){return f.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function X0(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Ke=Object.freeze({x:0,y:0});function W0(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function q0(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function G0(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function K0(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Ns(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Cs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Ns(t,t.left,t.top),i=[];for(const s of r){const{id:a}=s,l=n.get(a);if(l){const u=W0(Ns(l),o);i.push({id:a,data:{droppableContainer:s,value:u}})}}return i.sort(q0)};function Z0(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),s=o-r,a=i-n;if(r<o&&n<i){const l=t.width*t.height,u=e.width*e.height,c=s*a,d=c/(l+u-c);return Number(d.toFixed(4))}return 0}const Q0=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const i of r){const{id:s}=i,a=n.get(s);if(a){const l=Z0(a,t);l>0&&o.push({id:s,data:{droppableContainer:i,value:l}})}}return o.sort(G0)};function J0(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function jl(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ke}function ey(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((s,a)=>({...s,top:s.top+e*a.y,bottom:s.bottom+e*a.y,left:s.left+e*a.x,right:s.right+e*a.x}),{...n})}}const ty=ey(1);function ny(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ry(e,t,n){const r=ny(t);if(!r)return e;const{scaleX:o,scaleY:i,x:s,y:a}=r,l=e.left-s-(1-o)*parseFloat(n),u=e.top-a-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),c=o?e.width/o:e.width,d=i?e.height/i:e.height;return{width:c,height:d,top:u,right:l+c,bottom:u+d,left:l}}const oy={ignoreTransform:!1};function gn(e,t){t===void 0&&(t=oy);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:c}=Te(e).getComputedStyle(e);u&&(n=ry(n,u,c))}const{top:r,left:o,width:i,height:s,bottom:a,right:l}=n;return{top:r,left:o,width:i,height:s,bottom:a,right:l}}function _s(e){return gn(e,{ignoreTransform:!0})}function iy(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function sy(e,t){return t===void 0&&(t=Te(e).getComputedStyle(e)),t.position==="fixed"}function ay(e,t){t===void 0&&(t=Te(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=t[o];return typeof i=="string"?n.test(i):!1})}function xi(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(yi(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!qn(o)||Pl(o)||n.includes(o))return n;const i=Te(e).getComputedStyle(o);return o!==e&&ay(o,i)&&n.push(o),sy(o,i)?n:r(o.parentNode)}return e?r(e):n}function zl(e){const[t]=xi(e,1);return t??null}function go(e){return!Ur||!e?null:fn(e)?e:mi(e)?yi(e)||e===hn(e).scrollingElement?window:qn(e)?e:null:null}function Fl(e){return fn(e)?e.scrollX:e.scrollLeft}function Hl(e){return fn(e)?e.scrollY:e.scrollTop}function Vo(e){return{x:Fl(e),y:Hl(e)}}var pe;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(pe||(pe={}));function Vl(e){return!Ur||!e?!1:e===document.scrollingElement}function Bl(e){const t={x:0,y:0},n=Vl(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,s=e.scrollTop>=r.y,a=e.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:s,isRight:a,maxScroll:r,minScroll:t}}const ly={x:.2,y:.2};function cy(e,t,n,r,o){let{top:i,left:s,right:a,bottom:l}=n;r===void 0&&(r=10),o===void 0&&(o=ly);const{isTop:u,isBottom:c,isLeft:d,isRight:g}=Bl(e),h={x:0,y:0},v={x:0,y:0},p={height:t.height*o.y,width:t.width*o.x};return!u&&i<=t.top+p.height?(h.y=pe.Backward,v.y=r*Math.abs((t.top+p.height-i)/p.height)):!c&&l>=t.bottom-p.height&&(h.y=pe.Forward,v.y=r*Math.abs((t.bottom-p.height-l)/p.height)),!g&&a>=t.right-p.width?(h.x=pe.Forward,v.x=r*Math.abs((t.right-p.width-a)/p.width)):!d&&s<=t.left+p.width&&(h.x=pe.Backward,v.x=r*Math.abs((t.left+p.width-s)/p.width)),{direction:h,speed:v}}function uy(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:s}=window;return{top:0,left:0,right:i,bottom:s,width:i,height:s}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function Ul(e){return e.reduce((t,n)=>rn(t,Vo(n)),Ke)}function dy(e){return e.reduce((t,n)=>t+Fl(n),0)}function fy(e){return e.reduce((t,n)=>t+Hl(n),0)}function hy(e,t){if(t===void 0&&(t=gn),!e)return;const{top:n,left:r,bottom:o,right:i}=t(e);zl(e)&&(o<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const gy=[["x",["left","right"],dy],["y",["top","bottom"],fy]];class wi{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=xi(n),o=Ul(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,s,a]of gy)for(const l of s)Object.defineProperty(this,l,{get:()=>{const u=a(r),c=o[i]-u;return this.rect[l]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class $n{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function py(e){const{EventTarget:t}=Te(e);return e instanceof t?e:hn(e)}function po(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Fe;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Fe||(Fe={}));function Ds(e){e.preventDefault()}function my(e){e.stopPropagation()}var ie;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(ie||(ie={}));const Yl={start:[ie.Space,ie.Enter],cancel:[ie.Esc],end:[ie.Space,ie.Enter,ie.Tab]},yy=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case ie.Right:return{...n,x:n.x+25};case ie.Left:return{...n,x:n.x-25};case ie.Down:return{...n,y:n.y+25};case ie.Up:return{...n,y:n.y-25}}};class Xl{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new $n(hn(n)),this.windowListeners=new $n(Te(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Fe.Resize,this.handleCancel),this.windowListeners.add(Fe.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Fe.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&hy(r),n(Ke)}handleKeyDown(t){if(bi(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:i=Yl,coordinateGetter:s=yy,scrollBehavior:a="smooth"}=o,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:u}=r.current,c=u?{x:u.left,y:u.top}:Ke;this.referenceCoordinates||(this.referenceCoordinates=c);const d=s(t,{active:n,context:r.current,currentCoordinates:c});if(d){const g=Rr(d,c),h={x:0,y:0},{scrollableAncestors:v}=r.current;for(const p of v){const y=t.code,{isTop:b,isRight:w,isLeft:E,isBottom:x,maxScroll:R,minScroll:$}=Bl(p),I=uy(p),k={x:Math.min(y===ie.Right?I.right-I.width/2:I.right,Math.max(y===ie.Right?I.left:I.left+I.width/2,d.x)),y:Math.min(y===ie.Down?I.bottom-I.height/2:I.bottom,Math.max(y===ie.Down?I.top:I.top+I.height/2,d.y))},A=y===ie.Right&&!w||y===ie.Left&&!E,z=y===ie.Down&&!x||y===ie.Up&&!b;if(A&&k.x!==d.x){const P=p.scrollLeft+g.x,B=y===ie.Right&&P<=R.x||y===ie.Left&&P>=$.x;if(B&&!g.y){p.scrollTo({left:P,behavior:a});return}B?h.x=p.scrollLeft-P:h.x=y===ie.Right?p.scrollLeft-R.x:p.scrollLeft-$.x,h.x&&p.scrollBy({left:-h.x,behavior:a});break}else if(z&&k.y!==d.y){const P=p.scrollTop+g.y,B=y===ie.Down&&P<=R.y||y===ie.Up&&P>=$.y;if(B&&!g.x){p.scrollTo({top:P,behavior:a});return}B?h.y=p.scrollTop-P:h.y=y===ie.Down?p.scrollTop-R.y:p.scrollTop-$.y,h.y&&p.scrollBy({top:-h.y,behavior:a});break}}this.handleMove(t,rn(Rr(d,this.referenceCoordinates),h))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Xl.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Yl,onActivation:o}=t,{active:i}=n;const{code:s}=e.nativeEvent;if(r.start.includes(s)){const a=i.activatorNode.current;return a&&e.target!==a?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function Ts(e){return!!(e&&"distance"in e)}function $s(e){return!!(e&&"delay"in e)}class Ei{constructor(t,n,r){var o;r===void 0&&(r=py(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:s}=i;this.props=t,this.events=n,this.document=hn(s),this.documentListeners=new $n(this.document),this.listeners=new $n(r),this.windowListeners=new $n(Te(s)),this.initialCoordinates=(o=Ho(i))!=null?o:Ke,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Fe.Resize,this.handleCancel),this.windowListeners.add(Fe.DragStart,Ds),this.windowListeners.add(Fe.VisibilityChange,this.handleCancel),this.windowListeners.add(Fe.ContextMenu,Ds),this.documentListeners.add(Fe.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if($s(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Ts(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Fe.Click,my,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Fe.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:s,options:{activationConstraint:a}}=i;if(!o)return;const l=(n=Ho(t))!=null?n:Ke,u=Rr(o,l);if(!r&&a){if(Ts(a)){if(a.tolerance!=null&&po(u,a.tolerance))return this.handleCancel();if(po(u,a.distance))return this.handleStart()}if($s(a)&&po(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}t.cancelable&&t.preventDefault(),s(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===ie.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const vy={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Si extends Ei{constructor(t){const{event:n}=t,r=hn(n.target);super(t,vy,r)}}Si.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const by={move:{name:"mousemove"},end:{name:"mouseup"}};var Bo;(function(e){e[e.RightClick=2]="RightClick"})(Bo||(Bo={}));class xy extends Ei{constructor(t){super(t,by,hn(t.event.target))}}xy.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Bo.RightClick?!1:(r==null||r({event:n}),!0)}}];const mo={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class wy extends Ei{constructor(t){super(t,mo)}static setup(){return window.addEventListener(mo.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(mo.move.name,t)};function t(){}}}wy.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var Rn;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Rn||(Rn={}));var Mr;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Mr||(Mr={}));function Ey(e){let{acceleration:t,activator:n=Rn.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:s=5,order:a=Mr.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:c,delta:d,threshold:g}=e;const h=Ny({delta:d,disabled:!i}),[v,p]=M0(),y=f.useRef({x:0,y:0}),b=f.useRef({x:0,y:0}),w=f.useMemo(()=>{switch(n){case Rn.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Rn.DraggableRect:return o}},[n,o,l]),E=f.useRef(null),x=f.useCallback(()=>{const $=E.current;if(!$)return;const I=y.current.x*b.current.x,k=y.current.y*b.current.y;$.scrollBy(I,k)},[]),R=f.useMemo(()=>a===Mr.TreeOrder?[...u].reverse():u,[a,u]);f.useEffect(()=>{if(!i||!u.length||!w){p();return}for(const $ of R){if((r==null?void 0:r($))===!1)continue;const I=u.indexOf($),k=c[I];if(!k)continue;const{direction:A,speed:z}=cy($,k,w,t,g);for(const P of["x","y"])h[P][A[P]]||(z[P]=0,A[P]=0);if(z.x>0||z.y>0){p(),E.current=$,v(x,s),y.current=z,b.current=A;return}}y.current={x:0,y:0},b.current={x:0,y:0},p()},[t,x,r,p,i,s,JSON.stringify(w),JSON.stringify(h),v,u,R,c,JSON.stringify(g)])}const Sy={x:{[pe.Backward]:!1,[pe.Forward]:!1},y:{[pe.Backward]:!1,[pe.Forward]:!1}};function Ny(e){let{delta:t,disabled:n}=e;const r=Fo(t);return Gn(o=>{if(n||!r||!o)return Sy;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[pe.Backward]:o.x[pe.Backward]||i.x===-1,[pe.Forward]:o.x[pe.Forward]||i.x===1},y:{[pe.Backward]:o.y[pe.Backward]||i.y===-1,[pe.Forward]:o.y[pe.Forward]||i.y===1}}},[n,t,r])}function Cy(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Gn(o=>{var i;return t==null?null:(i=r??o)!=null?i:null},[r,t])}function _y(e,t){return f.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,i=o.activators.map(s=>({eventName:s.eventName,handler:t(s.handler,r)}));return[...n,...i]},[]),[e,t])}var Hn;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Hn||(Hn={}));var Uo;(function(e){e.Optimized="optimized"})(Uo||(Uo={}));const Rs=new Map;function Dy(e,t){let{dragging:n,dependencies:r,config:o}=t;const[i,s]=f.useState(null),{frequency:a,measure:l,strategy:u}=o,c=f.useRef(e),d=y(),g=Fn(d),h=f.useCallback(function(b){b===void 0&&(b=[]),!g.current&&s(w=>w===null?b:w.concat(b.filter(E=>!w.includes(E))))},[g]),v=f.useRef(null),p=Gn(b=>{if(d&&!n)return Rs;if(!b||b===Rs||c.current!==e||i!=null){const w=new Map;for(let E of e){if(!E)continue;if(i&&i.length>0&&!i.includes(E.id)&&E.rect.current){w.set(E.id,E.rect.current);continue}const x=E.node.current,R=x?new wi(l(x),x):null;E.rect.current=R,R&&w.set(E.id,R)}return w}return b},[e,i,n,d,l]);return f.useEffect(()=>{c.current=e},[e]),f.useEffect(()=>{d||h()},[n,d]),f.useEffect(()=>{i&&i.length>0&&s(null)},[JSON.stringify(i)]),f.useEffect(()=>{d||typeof a!="number"||v.current!==null||(v.current=setTimeout(()=>{h(),v.current=null},a))},[a,d,h,...r]),{droppableRects:p,measureDroppableContainers:h,measuringScheduled:i!=null};function y(){switch(u){case Hn.Always:return!1;case Hn.BeforeDragging:return n;default:return!n}}}function Wl(e,t){return Gn(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ty(e,t){return Wl(e,t)}function $y(e){let{callback:t,disabled:n}=e;const r=vi(t),o=f.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return f.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function Yr(e){let{callback:t,disabled:n}=e;const r=vi(t),o=f.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return f.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function Ry(e){return new wi(gn(e),e)}function As(e,t,n){t===void 0&&(t=Ry);const[r,o]=f.useState(null);function i(){o(l=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=l??n)!=null?u:null}const c=t(e);return JSON.stringify(l)===JSON.stringify(c)?l:c})}const s=$y({callback(l){if(e)for(const u of l){const{type:c,target:d}=u;if(c==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),a=Yr({callback:i});return it(()=>{i(),e?(a==null||a.observe(e),s==null||s.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),s==null||s.disconnect())},[e]),r}function Ay(e){const t=Wl(e);return jl(e,t)}const Ms=[];function My(e){const t=f.useRef(e),n=Gn(r=>e?r&&r!==Ms&&e&&t.current&&e.parentNode===t.current.parentNode?r:xi(e):Ms,[e]);return f.useEffect(()=>{t.current=e},[e]),n}function Iy(e){const[t,n]=f.useState(null),r=f.useRef(e),o=f.useCallback(i=>{const s=go(i.target);s&&n(a=>a?(a.set(s,Vo(s)),new Map(a)):null)},[]);return f.useEffect(()=>{const i=r.current;if(e!==i){s(i);const a=e.map(l=>{const u=go(l);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,Vo(u)]):null}).filter(l=>l!=null);n(a.length?new Map(a):null),r.current=e}return()=>{s(e),s(i)};function s(a){a.forEach(l=>{const u=go(l);u==null||u.removeEventListener("scroll",o)})}},[o,e]),f.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,s)=>rn(i,s),Ke):Ul(e):Ke,[e,t])}function Is(e,t){t===void 0&&(t=[]);const n=f.useRef(null);return f.useEffect(()=>{n.current=null},t),f.useEffect(()=>{const r=e!==Ke;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Rr(e,n.current):Ke}function ky(e){f.useEffect(()=>{if(!Ur)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Py(e,t){return f.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:i}=r;return n[o]=s=>{i(s,t)},n},{}),[e,t])}function ql(e){return f.useMemo(()=>e?iy(e):null,[e])}const ks=[];function Ly(e,t){t===void 0&&(t=gn);const[n]=e,r=ql(n?Te(n):null),[o,i]=f.useState(ks);function s(){i(()=>e.length?e.map(l=>Vl(l)?r:new wi(t(l),l)):ks)}const a=Yr({callback:s});return it(()=>{a==null||a.disconnect(),s(),e.forEach(l=>a==null?void 0:a.observe(l))},[e]),o}function Oy(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return qn(t)?t:e}function jy(e){let{measure:t}=e;const[n,r]=f.useState(null),o=f.useCallback(u=>{for(const{target:c}of u)if(qn(c)){r(d=>{const g=t(c);return d?{...d,width:g.width,height:g.height}:g});break}},[t]),i=Yr({callback:o}),s=f.useCallback(u=>{const c=Oy(u);i==null||i.disconnect(),c&&(i==null||i.observe(c)),r(c?t(c):null)},[t,i]),[a,l]=$r(s);return f.useMemo(()=>({nodeRef:a,rect:n,setRef:l}),[n,a,l])}const zy=[{sensor:Si,options:{}},{sensor:Xl,options:{}}],Fy={current:{}},pr={draggable:{measure:_s},droppable:{measure:_s,strategy:Hn.WhileDragging,frequency:Uo.Optimized},dragOverlay:{measure:gn}};class An extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Hy={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new An,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ar},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:pr,measureDroppableContainers:Ar,windowRect:null,measuringScheduled:!1},Vy={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ar,draggableNodes:new Map,over:null,measureDroppableContainers:Ar},Xr=f.createContext(Vy),Gl=f.createContext(Hy);function By(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new An}}}function Uy(e,t){switch(t.type){case ge.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ge.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ge.DragEnd:case ge.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ge.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new An(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case ge.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new An(e.droppable.containers);return s.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:s}}}case ge.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new An(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Yy(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=f.useContext(Xr),i=Fo(r),s=Fo(n==null?void 0:n.id);return f.useEffect(()=>{if(!t&&!r&&i&&s!=null){if(!bi(i)||document.activeElement===i.target)return;const a=o.get(s);if(!a)return;const{activatorNode:l,node:u}=a;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const c of[l.current,u.current]){if(!c)continue;const d=P0(c);if(d){d.focus();break}}})}},[r,t,o,s,i]),null}function Xy(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,i)=>i({transform:o,...r}),n):n}function Wy(e){return f.useMemo(()=>({draggable:{...pr.draggable,...e==null?void 0:e.draggable},droppable:{...pr.droppable,...e==null?void 0:e.droppable},dragOverlay:{...pr.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function qy(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const i=f.useRef(!1),{x:s,y:a}=typeof o=="boolean"?{x:o,y:o}:o;it(()=>{if(!s&&!a||!t){i.current=!1;return}if(i.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const c=n(u),d=jl(c,r);if(s||(d.x=0),a||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const g=zl(u);g&&g.scrollBy({top:d.y,left:d.x})}},[t,s,a,r,n])}const Kl=f.createContext({...Ke,scaleX:1,scaleY:1});var _t;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(_t||(_t={}));const Ps=f.memo(function(t){var n,r,o,i;let{id:s,accessibility:a,autoScroll:l=!0,children:u,sensors:c=zy,collisionDetection:d=Q0,measuring:g,modifiers:h,...v}=t;const p=f.useReducer(Uy,void 0,By),[y,b]=p,[w,E]=H0(),[x,R]=f.useState(_t.Uninitialized),$=x===_t.Initialized,{draggable:{active:I,nodes:k,translate:A},droppable:{containers:z}}=y,P=I!=null?k.get(I):null,B=f.useRef({initial:null,translated:null}),H=f.useMemo(()=>{var fe;return I!=null?{id:I,data:(fe=P==null?void 0:P.data)!=null?fe:Fy,rect:B}:null},[I,P]),m=f.useRef(null),[T,S]=f.useState(null),[D,L]=f.useState(null),N=Fn(v,Object.values(v)),M=Kn("DndDescribedBy",s),F=f.useMemo(()=>z.getEnabled(),[z]),O=Wy(g),{droppableRects:X,measureDroppableContainers:Y,measuringScheduled:K}=Dy(F,{dragging:$,dependencies:[A.x,A.y],config:O.droppable}),J=Cy(k,I),ee=f.useMemo(()=>D?Ho(D):null,[D]),j=mn(),U=Ty(J,O.draggable.measure);qy({activeNode:I!=null?k.get(I):null,config:j.layoutShiftCompensation,initialRect:U,measure:O.draggable.measure});const V=As(J,O.draggable.measure,U),q=As(J?J.parentElement:null),W=f.useRef({activatorEvent:null,active:null,activeNode:J,collisionRect:null,collisions:null,droppableRects:X,draggableNodes:k,draggingNode:null,draggingNodeRect:null,droppableContainers:z,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Z=z.getNodeFor((n=W.current.over)==null?void 0:n.id),ne=jy({measure:O.dragOverlay.measure}),re=(r=ne.nodeRef.current)!=null?r:J,le=$?(o=ne.rect)!=null?o:V:null,oe=!!(ne.nodeRef.current&&ne.rect),Q=Ay(oe?null:V),ye=ql(re?Te(re):null),ve=My($?Z??J:null),Je=Ly(ve),Ue=Xy(h,{transform:{x:A.x-Q.x,y:A.y-Q.y,scaleX:1,scaleY:1},activatorEvent:D,active:H,activeNodeRect:V,containerNodeRect:q,draggingNodeRect:le,over:W.current.over,overlayNodeRect:ne.rect,scrollableAncestors:ve,scrollableAncestorRects:Je,windowRect:ye}),at=ee?rn(ee,A):null,Ie=Iy(ve),yt=Is(Ie),lt=Is(Ie,[V]),Ne=rn(Ue,yt),$e=le?ty(le,Ue):null,ke=H&&$e?d({active:H,collisionRect:$e,droppableRects:X,droppableContainers:F,pointerCoordinates:at}):null,vt=K0(ke,"id"),[se,Ce]=f.useState(null),ct=oe?Ue:rn(Ue,lt),ut=J0(ct,(i=se==null?void 0:se.rect)!=null?i:null,V),Ye=f.useRef(null),Pe=f.useCallback((fe,de)=>{let{sensor:we,options:et}=de;if(m.current==null)return;const _e=k.get(m.current);if(!_e)return;const Ee=fe.nativeEvent,Oe=new we({active:m.current,activeNode:_e,event:Ee,options:et,context:W,onAbort(he){if(!k.get(he))return;const{onDragAbort:je}=N.current,Xe={id:he};je==null||je(Xe),w({type:"onDragAbort",event:Xe})},onPending(he,tt,je,Xe){if(!k.get(he))return;const{onDragPending:Lt}=N.current,nt={id:he,constraint:tt,initialCoordinates:je,offset:Xe};Lt==null||Lt(nt),w({type:"onDragPending",event:nt})},onStart(he){const tt=m.current;if(tt==null)return;const je=k.get(tt);if(!je)return;const{onDragStart:Xe}=N.current,Pt={activatorEvent:Ee,active:{id:tt,data:je.data,rect:B}};Zt.unstable_batchedUpdates(()=>{Xe==null||Xe(Pt),R(_t.Initializing),b({type:ge.DragStart,initialCoordinates:he,active:tt}),w({type:"onDragStart",event:Pt}),S(Ye.current),L(Ee)})},onMove(he){b({type:ge.DragMove,coordinates:he})},onEnd:xt(ge.DragEnd),onCancel:xt(ge.DragCancel)});Ye.current=Oe;function xt(he){return async function(){const{active:je,collisions:Xe,over:Pt,scrollAdjustedTranslate:Lt}=W.current;let nt=null;if(je&&Lt){const{cancelDrop:Ot}=N.current;nt={activatorEvent:Ee,active:je,collisions:Xe,delta:Lt,over:Pt},he===ge.DragEnd&&typeof Ot=="function"&&await Promise.resolve(Ot(nt))&&(he=ge.DragCancel)}m.current=null,Zt.unstable_batchedUpdates(()=>{b({type:he}),R(_t.Uninitialized),Ce(null),S(null),L(null),Ye.current=null;const Ot=he===ge.DragEnd?"onDragEnd":"onDragCancel";if(nt){const yn=N.current[Ot];yn==null||yn(nt),w({type:Ot,event:nt})}})}}},[k]),Le=f.useCallback((fe,de)=>(we,et)=>{const _e=we.nativeEvent,Ee=k.get(et);if(m.current!==null||!Ee||_e.dndKit||_e.defaultPrevented)return;const Oe={active:Ee};fe(we,de.options,Oe)===!0&&(_e.dndKit={capturedBy:de.sensor},m.current=et,Pe(we,de))},[k,Pe]),bt=_y(c,Le);ky(c),it(()=>{V&&x===_t.Initializing&&R(_t.Initialized)},[V,x]),f.useEffect(()=>{const{onDragMove:fe}=N.current,{active:de,activatorEvent:we,collisions:et,over:_e}=W.current;if(!de||!we)return;const Ee={active:de,activatorEvent:we,collisions:et,delta:{x:Ne.x,y:Ne.y},over:_e};Zt.unstable_batchedUpdates(()=>{fe==null||fe(Ee),w({type:"onDragMove",event:Ee})})},[Ne.x,Ne.y]),f.useEffect(()=>{const{active:fe,activatorEvent:de,collisions:we,droppableContainers:et,scrollAdjustedTranslate:_e}=W.current;if(!fe||m.current==null||!de||!_e)return;const{onDragOver:Ee}=N.current,Oe=et.get(vt),xt=Oe&&Oe.rect.current?{id:Oe.id,rect:Oe.rect.current,data:Oe.data,disabled:Oe.disabled}:null,he={active:fe,activatorEvent:de,collisions:we,delta:{x:_e.x,y:_e.y},over:xt};Zt.unstable_batchedUpdates(()=>{Ce(xt),Ee==null||Ee(he),w({type:"onDragOver",event:he})})},[vt]),it(()=>{W.current={activatorEvent:D,active:H,activeNode:J,collisionRect:$e,collisions:ke,droppableRects:X,draggableNodes:k,draggingNode:re,draggingNodeRect:le,droppableContainers:z,over:se,scrollableAncestors:ve,scrollAdjustedTranslate:Ne},B.current={initial:le,translated:$e}},[H,J,ke,$e,k,re,le,X,z,se,ve,Ne]),Ey({...j,delta:A,draggingRect:$e,pointerCoordinates:at,scrollableAncestors:ve,scrollableAncestorRects:Je});const pn=f.useMemo(()=>({active:H,activeNode:J,activeNodeRect:V,activatorEvent:D,collisions:ke,containerNodeRect:q,dragOverlay:ne,draggableNodes:k,droppableContainers:z,droppableRects:X,over:se,measureDroppableContainers:Y,scrollableAncestors:ve,scrollableAncestorRects:Je,measuringConfiguration:O,measuringScheduled:K,windowRect:ye}),[H,J,V,D,ke,q,ne,k,z,X,se,Y,ve,Je,O,K,ye]),kt=f.useMemo(()=>({activatorEvent:D,activators:bt,active:H,activeNodeRect:V,ariaDescribedById:{draggable:M},dispatch:b,draggableNodes:k,over:se,measureDroppableContainers:Y}),[D,bt,H,V,b,M,k,se,Y]);return _.createElement(Ol.Provider,{value:E},_.createElement(Xr.Provider,{value:kt},_.createElement(Gl.Provider,{value:pn},_.createElement(Kl.Provider,{value:ut},u)),_.createElement(Yy,{disabled:(a==null?void 0:a.restoreFocus)===!1})),_.createElement(U0,{...a,hiddenTextDescribedById:M}));function mn(){const fe=(T==null?void 0:T.autoScrollEnabled)===!1,de=typeof l=="object"?l.enabled===!1:l===!1,we=$&&!fe&&!de;return typeof l=="object"?{...l,enabled:we}:{enabled:we}}}),Gy=f.createContext(null),Ls="button",Ky="Draggable";function Zy(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const i=Kn(Ky),{activators:s,activatorEvent:a,active:l,activeNodeRect:u,ariaDescribedById:c,draggableNodes:d,over:g}=f.useContext(Xr),{role:h=Ls,roleDescription:v="draggable",tabIndex:p=0}=o??{},y=(l==null?void 0:l.id)===t,b=f.useContext(y?Kl:Gy),[w,E]=$r(),[x,R]=$r(),$=Py(s,t),I=Fn(n);it(()=>(d.set(t,{id:t,key:i,node:w,activatorNode:x,data:I}),()=>{const A=d.get(t);A&&A.key===i&&d.delete(t)}),[d,t]);const k=f.useMemo(()=>({role:h,tabIndex:p,"aria-disabled":r,"aria-pressed":y&&h===Ls?!0:void 0,"aria-roledescription":v,"aria-describedby":c.draggable}),[r,h,p,y,v,c.draggable]);return{active:l,activatorEvent:a,activeNodeRect:u,attributes:k,isDragging:y,listeners:r?void 0:$,node:w,over:g,setNodeRef:E,setActivatorNodeRef:R,transform:b}}function Qy(){return f.useContext(Gl)}const Jy="Droppable",ev={timeout:25};function tv(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const i=Kn(Jy),{active:s,dispatch:a,over:l,measureDroppableContainers:u}=f.useContext(Xr),c=f.useRef({disabled:n}),d=f.useRef(!1),g=f.useRef(null),h=f.useRef(null),{disabled:v,updateMeasurementsFor:p,timeout:y}={...ev,...o},b=Fn(p??r),w=f.useCallback(()=>{if(!d.current){d.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{u(Array.isArray(b.current)?b.current:[b.current]),h.current=null},y)},[y]),E=Yr({callback:w,disabled:v||!s}),x=f.useCallback((k,A)=>{E&&(A&&(E.unobserve(A),d.current=!1),k&&E.observe(k))},[E]),[R,$]=$r(x),I=Fn(t);return f.useEffect(()=>{!E||!R.current||(E.disconnect(),d.current=!1,E.observe(R.current))},[R,E]),f.useEffect(()=>(a({type:ge.RegisterDroppable,element:{id:r,key:i,disabled:n,node:R,rect:g,data:I}}),()=>a({type:ge.UnregisterDroppable,key:i,id:r})),[r]),f.useEffect(()=>{n!==c.current.disabled&&(a({type:ge.SetDroppableDisabled,id:r,key:i,disabled:n}),c.current.disabled=n)},[r,i,n,a]),{active:s,rect:g,isOver:(l==null?void 0:l.id)===r,node:R,over:l,setNodeRef:$}}function Ni(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function nv(e,t){return e.reduce((n,r,o)=>{const i=t.get(r);return i&&(n[o]=i),n},Array(e.length))}function lr(e){return e!==null&&e>=0}function rv(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function ov(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Zl=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const i=Ni(t,r,n),s=t[o],a=i[o];return!a||!s?null:{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}},cr={scaleX:1,scaleY:1},Os=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:i,overIndex:s}=e;const a=(t=i[n])!=null?t:r;if(!a)return null;if(o===n){const u=i[s];return u?{x:0,y:n<s?u.top+u.height-(a.top+a.height):u.top-a.top,...cr}:null}const l=iv(i,o,n);return o>n&&o<=s?{x:0,y:-a.height-l,...cr}:o<n&&o>=s?{x:0,y:a.height+l,...cr}:{x:0,y:0,...cr}};function iv(e,t,n){const r=e[t],o=e[t-1],i=e[t+1];return r?n<t?o?r.top-(o.top+o.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const Ql="Sortable",Jl=_.createContext({activeIndex:-1,containerId:Ql,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Zl,disabled:{draggable:!1,droppable:!1}});function js(e){let{children:t,id:n,items:r,strategy:o=Zl,disabled:i=!1}=e;const{active:s,dragOverlay:a,droppableRects:l,over:u,measureDroppableContainers:c}=Qy(),d=Kn(Ql,n),g=a.rect!==null,h=f.useMemo(()=>r.map($=>typeof $=="object"&&"id"in $?$.id:$),[r]),v=s!=null,p=s?h.indexOf(s.id):-1,y=u?h.indexOf(u.id):-1,b=f.useRef(h),w=!rv(h,b.current),E=y!==-1&&p===-1||w,x=ov(i);it(()=>{w&&v&&c(h)},[w,h,v,c]),f.useEffect(()=>{b.current=h},[h]);const R=f.useMemo(()=>({activeIndex:p,containerId:d,disabled:x,disableTransforms:E,items:h,overIndex:y,useDragOverlay:g,sortedRects:nv(h,l),strategy:o}),[p,d,x.draggable,x.droppable,E,h,y,l,g,o]);return _.createElement(Jl.Provider,{value:R},t)}const sv=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return Ni(n,r,o).indexOf(t)},av=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:i,newIndex:s,previousItems:a,previousContainerId:l,transition:u}=e;return!u||!r||a!==i&&o===s?!1:n?!0:s!==o&&t===l},lv={duration:200,easing:"ease"},ec="transform",cv=cn.Transition.toString({property:ec,duration:0,easing:"linear"}),uv={roleDescription:"sortable"};function dv(e){let{disabled:t,index:n,node:r,rect:o}=e;const[i,s]=f.useState(null),a=f.useRef(n);return it(()=>{if(!t&&n!==a.current&&r.current){const l=o.current;if(l){const u=gn(r.current,{ignoreTransform:!0}),c={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(c.x||c.y)&&s(c)}}n!==a.current&&(a.current=n)},[t,n,r,o]),f.useEffect(()=>{i&&s(null)},[i]),i}function tc(e){let{animateLayoutChanges:t=av,attributes:n,disabled:r,data:o,getNewIndex:i=sv,id:s,strategy:a,resizeObserverConfig:l,transition:u=lv}=e;const{items:c,containerId:d,activeIndex:g,disabled:h,disableTransforms:v,sortedRects:p,overIndex:y,useDragOverlay:b,strategy:w}=f.useContext(Jl),E=fv(r,h),x=c.indexOf(s),R=f.useMemo(()=>({sortable:{containerId:d,index:x,items:c},...o}),[d,o,x,c]),$=f.useMemo(()=>c.slice(c.indexOf(s)),[c,s]),{rect:I,node:k,isOver:A,setNodeRef:z}=tv({id:s,data:R,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:$,...l}}),{active:P,activatorEvent:B,activeNodeRect:H,attributes:m,setNodeRef:T,listeners:S,isDragging:D,over:L,setActivatorNodeRef:N,transform:M}=Zy({id:s,data:R,attributes:{...uv,...n},disabled:E.draggable}),F=A0(z,T),O=!!P,X=O&&!v&&lr(g)&&lr(y),Y=!b&&D,K=Y&&X?M:null,ee=X?K??(a??w)({rects:p,activeNodeRect:H,activeIndex:g,overIndex:y,index:x}):null,j=lr(g)&&lr(y)?i({id:s,items:c,activeIndex:g,overIndex:y}):x,U=P==null?void 0:P.id,V=f.useRef({activeId:U,items:c,newIndex:j,containerId:d}),q=c!==V.current.items,W=t({active:P,containerId:d,isDragging:D,isSorting:O,id:s,index:x,items:c,newIndex:V.current.newIndex,previousItems:V.current.items,previousContainerId:V.current.containerId,transition:u,wasDragging:V.current.activeId!=null}),Z=dv({disabled:!W,index:x,node:k,rect:I});return f.useEffect(()=>{O&&V.current.newIndex!==j&&(V.current.newIndex=j),d!==V.current.containerId&&(V.current.containerId=d),c!==V.current.items&&(V.current.items=c)},[O,j,d,c]),f.useEffect(()=>{if(U===V.current.activeId)return;if(U!=null&&V.current.activeId==null){V.current.activeId=U;return}const re=setTimeout(()=>{V.current.activeId=U},50);return()=>clearTimeout(re)},[U]),{active:P,activeIndex:g,attributes:m,data:R,rect:I,index:x,newIndex:j,items:c,isOver:A,isSorting:O,isDragging:D,listeners:S,node:k,overIndex:y,over:L,setNodeRef:F,setActivatorNodeRef:N,setDroppableNodeRef:z,setDraggableNodeRef:T,transform:Z??ee,transition:ne()};function ne(){if(Z||q&&V.current.newIndex===x)return cv;if(!(Y&&!bi(B)||!u)&&(O||W))return cn.Transition.toString({...u,property:ec})}}function fv(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}ie.Down,ie.Right,ie.Up,ie.Left;const St=e=>{if(!e)return null;const t=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/|youtube\.com\/shorts\/)([a-zA-Z0-9_-]{11})/,n=e.match(t);return n?n[1]:null},zs=async e=>{try{return console.warn("YouTube API key not configured. Fetching basic metadata only."),{title:"",description:"",thumbnailUrl:`https://img.youtube.com/vi/${e}/mqdefault.jpg`}}catch(t){return console.error("Failed to fetch YouTube metadata:",t),null}},Fs={style:{borderRadius:"8px",border:"1px solid #ddd",padding:"10px",cursor:"pointer",background:"white",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.1)"}},hv=[],gv=[],Yo=f.memo(({data:e,id:t,selected:n})=>{const r=e.videoUrl,o=r?St(r):null,i=e.mediaImages&&e.mediaImages.length>0?e.mediaImages[0].url:o?`https://img.youtube.com/vi/${o}/mqdefault.jpg`:null;return console.log("[CustomNode]",t,"Data received:",e,"Extracted videoId:",o,"Final mainImageUrl:",i),C.jsxs("div",{style:{...Fs.style,border:n?"2px solid #3b82f6":"1px solid #ddd",boxShadow:n?"0 0 0 2px rgba(59, 130, 246, 0.5)":Fs.style.boxShadow,position:"relative",padding:"15px",width:i?"220px":"auto",minWidth:"150px"},children:[C.jsx($t,{type:"source",position:G.Top,id:`t-s-${t}`,isConnectable:!0,style:{background:"#555",top:"-5px",left:"50%",transform:"translateX(-50%)"}}),C.jsx($t,{type:"target",position:G.Bottom,id:`b-t-${t}`,isConnectable:!0,style:{background:"#aaa",bottom:"-5px",left:"50%",transform:"translateX(-50%)"}}),C.jsx($t,{type:"source",position:G.Left,id:`l-s-${t}`,isConnectable:!0,style:{background:"#555",left:"-5px",top:"50%",transform:"translateY(-50%)"}}),C.jsx($t,{type:"target",position:G.Right,id:`r-t-${t}`,isConnectable:!0,style:{background:"#aaa",right:"-5px",top:"50%",transform:"translateY(-50%)"}}),C.jsxs("div",{className:"flex items-center justify-between mb-1",children:[C.jsx("div",{className:"font-medium truncate",title:e.videoTitle||e.label,children:e.videoTitle||e.label}),e.likes!==void 0&&C.jsxs("div",{className:"text-sm text-gray-500 flex-shrink-0 ml-2",children:["❤️ ",e.likes]})]}),i&&C.jsx("div",{className:"mt-2 rounded overflow-hidden aspect-video",children:C.jsx("img",{src:i,alt:`썸네일: ${e.videoTitle||e.label||"Node"}`,loading:"lazy",className:"w-full h-full object-cover",tabIndex:-1})})]})});Yo.displayName="CustomNode";const pv={custom:Yo,leaf:Yo};function mv({id:e,src:t,alt:n,onRemove:r,onDownload:o,onShare:i,filename:s}){const{attributes:a,listeners:l,setNodeRef:u,transform:c,transition:d,isDragging:g}=tc({id:e}),h={transform:cn.Transform.toString(c),transition:d,opacity:g?.5:1,cursor:g?"grabbing":"grab"};return C.jsxs("div",{ref:u,style:h,...a,...l,className:"relative group w-24 h-24 flex-shrink-0",children:[C.jsx("img",{src:t,alt:n,className:"object-cover w-full h-full rounded border",loading:"lazy",tabIndex:0}),C.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-opacity flex items-center justify-center opacity-0 group-hover:opacity-100",children:C.jsxs("div",{className:"flex gap-1",children:[C.jsx("button",{type:"button",onClick:r,className:"bg-white bg-opacity-80 rounded-full p-1 text-xs text-red-500 hover:bg-red-100","aria-label":"Remove image",title:"Remove",tabIndex:0,children:"🗑️"}),C.jsx("a",{href:t,download:s||"image",onClick:o,className:"bg-white bg-opacity-80 rounded-full p-1 text-xs text-blue-500 hover:bg-blue-100","aria-label":"Download image",title:"Download",tabIndex:0,children:"⬇️"}),C.jsx("button",{type:"button",onClick:i,className:"bg-white bg-opacity-80 rounded-full p-1 text-xs text-green-500 hover:bg-green-100","aria-label":"Copy image link",title:"Copy Link",tabIndex:0,children:"🔗"})]})}),C.jsx("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-60 rounded px-1 py-0.5 text-[10px] text-white truncate max-w-[calc(100%-8px)]",title:s,children:s||"image"})]})}function yv({id:e,vidId:t,alt:n,onRemove:r,onOpen:o,onShare:i,filename:s}){const{attributes:a,listeners:l,setNodeRef:u,transform:c,transition:d,isDragging:g}=tc({id:e}),h={transform:cn.Transform.toString(c),transition:d,opacity:g?.5:1,cursor:g?"grabbing":"grab"};return C.jsxs("div",{ref:u,style:h,...a,...l,className:"relative group w-40 h-24 flex-shrink-0",children:[t?C.jsx("img",{src:`https://img.youtube.com/vi/${t}/mqdefault.jpg`,alt:n,className:"object-cover w-full h-full rounded border cursor-pointer",loading:"lazy",tabIndex:0,onClick:o}):C.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded border text-xs text-gray-400 p-2 text-center",children:"Invalid Link"}),C.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-opacity flex items-center justify-center opacity-0 group-hover:opacity-100",children:C.jsxs("div",{className:"flex gap-1",children:[C.jsx("button",{type:"button",onClick:r,className:"bg-white bg-opacity-80 rounded-full p-1 text-xs text-red-500 hover:bg-red-100","aria-label":"Remove video",title:"Remove",tabIndex:0,children:"🗑️"}),t&&C.jsx("a",{href:`https://www.youtube.com/watch?v=${t}`,target:"_blank",rel:"noopener noreferrer",className:"bg-white bg-opacity-80 rounded-full p-1 text-xs text-blue-500 hover:bg-blue-100","aria-label":"Open video in new tab",title:"Open",tabIndex:0,children:"↗️"}),C.jsx("button",{type:"button",onClick:i,className:"bg-white bg-opacity-80 rounded-full p-1 text-xs text-green-500 hover:bg-green-100","aria-label":"Copy video link",title:"Copy Link",tabIndex:0,children:"🔗"})]})}),C.jsx("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-60 rounded px-1 py-0.5 text-[10px] text-white truncate max-w-[calc(100%-8px)]",title:s,children:s||"video"})]})}const nc=({node:e,onClose:t,onSave:n,isEdit:r,onToggleEdit:o,onDelete:i})=>{var J,ee;const[s,a]=f.useState({...e.data}),[l,u]=f.useState(null),[c,d]=f.useState(""),[g,h]=f.useState(!1),[v,p]=f.useState(!1),[y,b]=f.useState(!1),[w,E]=f.useState(null),[x,R]=f.useState(!1),[$,I]=f.useState(null),[k,A]=f.useState(""),z=Hs(),P=Vs(_c);f.useEffect(()=>{a({...e.data}),u(e.data.videoUrl?St(e.data.videoUrl):null),d(""),h(!1),p(!1),E(null),A("")},[e]);const B=j=>{j.preventDefault(),p(!0)},H=j=>{j.preventDefault(),p(!1)},m=async j=>{j.preventDefault(),p(!1);const U=j.dataTransfer.getData("text/uri-list")||j.dataTransfer.getData("text");if(console.log("Dropped URL:",U),U){const V=St(U);if(V){const q=`https://www.youtube.com/watch?v=${V}`;if(a(W=>({...W,videoUrl:q})),u(V),!s.videoTitle||!s.description){const W=await zs(V);W&&a(Z=>({...Z,videoTitle:Z.videoTitle||W.title||`Video ${V}`,label:Z.label||W.title||`Video ${V}`,description:Z.description||W.description}))}}else E("Dropped item is not a valid YouTube link."),setTimeout(()=>E(null),3e3)}},T=async j=>{const U=j.target.value;a(W=>({...W,videoUrl:U}));const V=St(U);if(u(V),U&&!/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube(-nocookie)?\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/|shorts\/)?)([\w\-]+)(\S+)?$/.test(U)&&U!=="")E("Invalid YouTube URL format.");else if(E(null),V&&(!s.videoTitle||!s.description)){const W=await zs(V);W&&a(Z=>({...Z,videoTitle:Z.videoTitle||W.title||`Video ${V}`,label:Z.label||W.title||`Video ${V}`,description:Z.description||W.description}))}},S=j=>{j.preventDefault();const U={...s,label:s.label||s.videoTitle||"Untitled Node"};n(e.id,U)},D=()=>{if(!c.trim()||!P)return;const j={id:Date.now().toString(),text:c.trim(),author:P.name||"Anonymous",createdAt:new Date().toISOString()};a(U=>({...U,comments:[...U.comments||[],j]})),d(""),e.data.author&&P&&P._id!==e.data.author._id&&z(ze({_id:`${e.id}-comment-${P._id}-${Date.now()}`,type:"comment",sender:P,post:{_id:e.id,content:e.data.label},comment:{_id:j.id,text:j.text},recipientId:e.data.author._id,read:!1,createdAt:j.createdAt}))},L=async j=>{const U=j.target.files;if(!U||U.length===0)return;b(!0),E(null);const V=[],q=[];for(let W=0;W<U.length;W++){const Z=U[W];if(!Z.type.startsWith("image/")){q.push(`"${Z.name}" is not an image.`);continue}if(Z.size>10*1024*1024){q.push(`"${Z.name}" exceeds the 10MB size limit.`);continue}try{const ne=new FormData;ne.append("file",Z);const re=await fetch("/api/upload",{method:"POST",body:ne});if(!re.ok){const oe=await re.json().catch(()=>({message:"Upload failed with status: "+re.status}));throw new Error(oe.message||`Failed to upload "${Z.name}"`)}const le=await re.json();if(!le.url)throw new Error(`Upload succeeded for "${Z.name}" but no URL was returned.`);V.push({url:le.url,caption:""})}catch(ne){q.push(ne.message||`Error uploading "${Z.name}".`)}}b(!1),q.length>0&&E(q.join(`
`)),V.length>0&&a(W=>({...W,mediaImages:[...W.mediaImages||[],...V]}))},N=()=>{if(!k.trim())return;const j=St(k.trim());if(!j){E("Invalid YouTube URL format for additional video."),setTimeout(()=>E(null),3e3);return}const U=`https://www.youtube.com/watch?v=${j}`;a(V=>({...V,mediaVideos:[...V.mediaVideos||[],{url:U,caption:""}]})),A(""),E(null)},M=j=>{a(U=>({...U,mediaImages:(U.mediaImages||[]).filter((V,q)=>q!==j)}))},F=j=>{a(U=>({...U,mediaVideos:(U.mediaVideos||[]).filter((V,q)=>q!==j)}))},O=(j,U)=>{const{active:V,over:q}=j;q&&V.id!==q.id&&a(W=>{const Z=U==="images"?W.mediaImages:W.mediaVideos;if(!Z)return W;const ne=Z.findIndex(oe=>oe.url===V.id),re=Z.findIndex(oe=>oe.url===q.id);if(ne===-1||re===-1)return W;const le=Ni(Z,ne,re);return U==="images"?{...W,mediaImages:le}:{...W,mediaVideos:le}})},X=(j,U)=>{I({type:j,url:U}),R(!0)},Y=(j,U)=>{navigator.clipboard.writeText(j).then(()=>{z(ze({_id:Date.now().toString(),message:`${U} link copied!`,type:"info"}))}).catch(V=>{console.error("Failed to copy text: ",V),z(ze({_id:Date.now().toString(),message:`Failed to copy ${U} link.`,type:"error"}))})},K=X0(Y0(Si,{activationConstraint:{distance:10}}));return C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",onClick:t,children:[C.jsxs("div",{className:`bg-white rounded-lg shadow-xl max-h-[90vh] flex flex-col transition-all duration-300 ease-out ${g?"w-full max-w-6xl":"w-full max-w-2xl"}`,onClick:j=>j.stopPropagation(),children:[C.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[C.jsxs("h2",{className:"text-xl font-semibold",children:["노드 ",r?"편집":"상세"]}),C.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-800 text-2xl","aria-label":"Close modal",children:"×"})]}),C.jsxs("div",{className:`flex-grow overflow-y-auto p-6 ${g?"flex":"block"}`,children:[C.jsx("div",{className:`space-y-6 ${g?"w-1/2 pr-3 border-r":"w-full"}`,children:r?C.jsxs("form",{onSubmit:S,className:"space-y-5",children:[C.jsxs("div",{children:[C.jsx("label",{htmlFor:"node-title",className:"block text-sm font-medium text-gray-700 mb-1",children:"제목"}),C.jsx("input",{id:"node-title",type:"text",value:s.label||"",onChange:j=>a(U=>({...U,label:j.target.value,videoTitle:j.target.value})),className:"w-full p-2 border border-gray-300 rounded shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),C.jsxs("div",{className:`p-4 border-2 border-dashed rounded-lg transition-colors ${v?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:B,onDragLeave:H,onDrop:m,children:[C.jsx("label",{htmlFor:"youtube-url-input",className:"block text-sm font-medium text-gray-700 mb-1",children:"대표 유튜브 영상 (선택)"}),C.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[C.jsx("input",{id:"youtube-url-input",type:"text",value:s.videoUrl||"",onChange:T,placeholder:"유튜브 주소를 붙여넣거나 썸네일을 드래그하세요",className:"flex-grow p-2 border border-gray-300 rounded shadow-sm focus:ring-blue-500 focus:border-blue-500"}),C.jsx("button",{type:"button",onClick:()=>h(!g),className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition whitespace-nowrap",children:g?"검색 닫기":"유튜브 검색"})]}),v&&C.jsx("div",{className:"mt-2 text-sm text-blue-600",children:"Drop YouTube thumbnail or link here"}),w&&C.jsx("div",{className:"mt-2 text-sm text-red-600",children:w}),l&&C.jsx("div",{className:"mt-3 rounded overflow-hidden border",children:C.jsx("img",{src:`https://img.youtube.com/vi/${l}/mqdefault.jpg`,alt:`Preview: ${s.videoTitle||s.label||"Video"}`,className:"w-full h-auto object-contain",loading:"lazy"})})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"node-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),C.jsx("textarea",{id:"node-description",value:s.description||"",onChange:j=>a(U=>({...U,description:j.target.value})),className:"w-full p-2 border border-gray-300 rounded shadow-sm focus:ring-blue-500 focus:border-blue-500",rows:4,placeholder:"Add more details about this node..."})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"추가 이미지"}),C.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:L,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 disabled:opacity-50",disabled:y,"aria-describedby":"image-upload-info"}),C.jsx("p",{id:"image-upload-info",className:"text-xs text-gray-500 mt-1",children:"여러 이미지를 업로드할 수 있습니다(최대 10MB). 썸네일을 드래그해 순서를 변경하세요."}),y&&C.jsx("div",{className:"text-sm text-blue-600 mt-1 animate-pulse",children:"Uploading images..."}),w&&C.jsx("div",{className:"mt-1 text-sm text-red-600 whitespace-pre-wrap",children:w.includes("Image")&&w})," ",s.mediaImages&&s.mediaImages.length>0&&C.jsx(Ps,{sensors:K,collisionDetection:Cs,onDragEnd:j=>O(j,"images"),children:C.jsx(js,{items:s.mediaImages.map(j=>j.url),strategy:Os,children:C.jsx("div",{className:"flex gap-2 mt-2 overflow-x-auto py-2 -mx-1 px-1",children:s.mediaImages.map((j,U)=>C.jsx(mv,{id:j.url,src:j.url,alt:`Node image ${U+1}`,filename:j.url.substring(j.url.lastIndexOf("/")+1),onRemove:()=>M(U),onDownload:()=>{},onShare:()=>Y(j.url,"Image")},j.url))})})})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"추가 영상 (유튜브)"}),C.jsxs("div",{className:"flex gap-2 mb-2",children:[C.jsx("input",{type:"text",value:k,onChange:j=>A(j.target.value),placeholder:"유튜브 주소를 붙여넣고 추가를 누르세요",className:"flex-grow p-2 border border-gray-300 rounded shadow-sm focus:ring-blue-500 focus:border-blue-500","aria-label":"New YouTube URL to add"}),C.jsx("button",{type:"button",onClick:N,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition whitespace-nowrap",children:"Add"})]}),C.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"여러 유튜브 영상을 추가할 수 있습니다. 썸네일을 드래그해 순서를 변경하세요."}),w&&C.jsx("div",{className:"mt-1 text-sm text-red-600",children:w.includes("video")&&w})," ",s.mediaVideos&&s.mediaVideos.length>0&&C.jsx(Ps,{sensors:K,collisionDetection:Cs,onDragEnd:j=>O(j,"videos"),children:C.jsx(js,{items:s.mediaVideos.map(j=>j.url),strategy:Os,children:C.jsx("div",{className:"flex gap-2 mt-2 overflow-x-auto py-2 -mx-1 px-1",children:s.mediaVideos.map((j,U)=>{const V=St(j.url);return C.jsx(yv,{id:j.url,vidId:V,alt:`Node video thumbnail ${U+1}`,filename:V?`YT: ${V}`:"Invalid Link",onRemove:()=>F(U),onOpen:()=>{V&&window.open(`https://www.youtube.com/watch?v=${V}`,"_blank")},onShare:()=>Y(j.url,"Video")},`${j.url}-${U}`)})})})})]}),C.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t",children:[i&&C.jsx("button",{type:"button",onClick:()=>i(e.id),className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition",children:"노드 삭제"}),C.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 transition",children:"취소"}),C.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"저장"})]})]}):C.jsxs("div",{className:"space-y-4",children:[C.jsx("h3",{className:"text-lg font-semibold",children:e.data.videoTitle||e.data.label}),l&&C.jsx("div",{className:"aspect-w-16 aspect-h-9 rounded-lg overflow-hidden shadow",children:C.jsx("iframe",{src:`https://www.youtube.com/embed/${l}`,title:"Node YouTube Video",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0,className:"w-full h-full border-0"})}),e.data.description&&C.jsx("p",{className:"text-gray-700 whitespace-pre-wrap bg-gray-50 p-3 rounded border",children:e.data.description}),e.data.mediaImages&&e.data.mediaImages.length>0&&C.jsxs("div",{children:[C.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-1",children:"Images"}),C.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 -mx-1 px-1",children:e.data.mediaImages.map((j,U)=>C.jsxs("div",{className:"relative w-24 h-24 flex-shrink-0 cursor-pointer",onClick:()=>X("image",j.url),children:[C.jsx("img",{src:j.url,alt:`Node ${e.id} image ${U+1}`,className:"w-full h-full object-cover rounded border",loading:"lazy"}),C.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-30 transition flex items-center justify-center text-white text-xl",children:"+"})]},j.url))})]}),e.data.mediaVideos&&e.data.mediaVideos.length>0&&C.jsxs("div",{children:[C.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-1",children:"Videos"}),C.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 -mx-1 px-1",children:e.data.mediaVideos.map((j,U)=>{const V=St(j.url);return C.jsxs("div",{className:"relative w-40 h-24 flex-shrink-0 cursor-pointer",onClick:()=>V&&X("video",`https://www.youtube.com/embed/${V}`),children:[V?C.jsx("img",{src:`https://img.youtube.com/vi/${V}/mqdefault.jpg`,alt:`Node ${e.id} video ${U+1}`,className:"w-full h-full object-cover rounded border",loading:"lazy"}):C.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded border text-xs text-gray-400 p-2 text-center",children:"Invalid Link"}),C.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-30 transition flex items-center justify-center text-white text-xl",children:"▶"})]},`${j.url}-${U}`)})})]}),C.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[C.jsxs("div",{className:"flex items-center gap-4",children:[C.jsxs("button",{className:"flex items-center gap-1 text-gray-600 hover:text-red-500 transition",children:[C.jsx("span",{children:"❤️"}),C.jsx("span",{children:e.data.likes||0})]}),C.jsxs("span",{className:"text-gray-600",children:["💬 ",((J=e.data.comments)==null?void 0:J.length)||0]})]}),P&&C.jsx("button",{onClick:o,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition",children:"Edit Node"})]}),C.jsxs("div",{className:"border-t pt-4",children:[C.jsx("h4",{className:"font-semibold mb-3",children:"댓글"}),C.jsxs("div",{className:"space-y-3 mb-4 max-h-48 overflow-y-auto pr-2",children:[(!e.data.comments||e.data.comments.length===0)&&C.jsx("p",{className:"text-sm text-gray-500",children:"아직 댓글이 없습니다."}),(ee=e.data.comments)==null?void 0:ee.map(j=>C.jsxs("div",{className:"bg-gray-50 p-3 rounded shadow-sm text-sm",children:[C.jsxs("div",{className:"flex justify-between items-center mb-1",children:[C.jsx("span",{className:"font-medium text-gray-800",children:j.author}),C.jsx("span",{className:"text-xs text-gray-500",children:new Date(j.createdAt).toLocaleString()})]}),C.jsx("p",{className:"text-gray-700",children:j.text})]},j.id))]}),P&&C.jsxs("div",{className:"space-y-2",children:[C.jsx("textarea",{placeholder:"댓글을 입력하세요...",className:"w-full border border-gray-300 rounded p-2 text-sm focus:ring-blue-500 focus:border-blue-500",rows:2,value:c,onChange:j=>d(j.target.value),"aria-label":"New comment input"}),C.jsx("button",{onClick:D,disabled:!c.trim(),className:"px-4 py-1.5 bg-green-600 text-white rounded text-sm hover:bg-green-700 disabled:bg-gray-400 transition",children:"댓글 등록"})]})]})]})}),g&&C.jsx("div",{className:"w-1/2 pl-3 overflow-y-auto",children:C.jsx(kp,{onSelect:async(j,U,V)=>{const q=St(j);a(W=>({...W,videoUrl:j,videoTitle:W.videoTitle||U||(q?`Video ${q}`:"Selected Video"),label:W.label||U||(q?`Video ${q}`:"Selected Video"),description:W.description||V})),q&&u(q),h(!1)},onClose:()=>h(!1)})})]})," "]})," "]})," ",C.jsxs(R0,{isOpen:x,onClose:()=>R(!1),size:"xl",children:[($==null?void 0:$.type)==="image"&&$.url&&C.jsx("img",{src:$.url,alt:"Enlarged node content",className:"max-w-full max-h-[80vh] mx-auto rounded",loading:"lazy"}),($==null?void 0:$.type)==="video"&&$.url&&C.jsx("div",{className:"aspect-w-16 aspect-h-9",children:C.jsx("iframe",{src:$.url,title:"Node Video Content",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0,className:"w-full h-full border-0 rounded"})})]})]})};nc.displayName="NodeDetailModal";const wv=()=>{const{id:e}=Ec(),t=Sc(),n=Hs(),[r,o]=f.useState(null),{currentTree:i,loading:s,error:a}=Vs(S=>S.trees),l=(i==null?void 0:i.nodes)??[],u=(i==null?void 0:i.edges)??[],[c,d,g]=bp(hv),[h,v,p]=xp(gv),[y,b]=f.useState(null),[w,E]=f.useState(!1),[x,R]=f.useState(!1);f.useEffect(()=>{e?n(Nc(e)):(alert("트리 ID가 없습니다. 메인 페이지로 이동합니다."),t("/home"))},[e,n,t]),f.useEffect(()=>{if(!x&&i&&l&&u){const S=l.map(D=>({...D,position:D.position||{x:Math.random()*400,y:Math.random()*400},type:"custom",data:{...D.data}}));d(S),v(u),R(!0)}},[i,l,u,d,v,x]);const $=f.useCallback(S=>{console.log("Connection created:",S),v(D=>Ra({...S,animated:!0,style:{stroke:"#555"}},D))},[v]),I=f.useCallback((S,D)=>{console.log("Node clicked:",D),b(D),E(!1)},[]),k=f.useCallback((S,D)=>{console.log("Node double clicked:",D),b(D),E(!0)},[]),A=f.useCallback((S,D)=>{console.log("Saving node data:",S,D),d(L=>L.map(N=>N.id===S?(console.log("업데이트 전 노드 data:",N.data),console.log("모달에서 받은 새 data:",D),{...N,data:D}):N)),b(null),E(!1),n(ze({_id:Date.now().toString(),message:`Node "${D.label}" updated.`,type:"success"}))},[d,n]),z=f.useCallback(()=>{if(!e||!r){console.error("Cannot save: Missing treeId or React Flow instance."),n(ze({_id:Date.now().toString(),message:"Error: Cannot save tree.",type:"error"}));return}const S=r.getNodes(),D=r.getEdges();console.log("Saving tree with ID:",e),console.log("Nodes to save:",S),console.log("Edges to save:",D);const L=S.map(({id:N,type:M,data:F,position:O})=>({id:N,type:M,data:F,position:O}));n(Cc({treeId:e,data:{nodes:L,edges:D}})).unwrap().then(()=>{n(ze({_id:Date.now().toString(),message:"Tree saved successfully!",type:"success"}))}).catch(N=>{console.error("Failed to save tree:",N),n(ze({_id:Date.now().toString(),message:`Failed to save tree: ${N.message||"Unknown error"}`,type:"error"}))})},[e,r,n]),P=f.useCallback(async()=>{if(!e)return;const S={label:"새 노드",content:"새 노드 내용",videoTitle:"",videoUrl:"",description:"",likes:[],comments:[],mediaImages:[],mediaVideos:[]};try{const D=Ti();if(!D){console.error("오류: 인증 토큰이 없습니다."),n(ze({_id:Date.now().toString(),message:"로그인이 필요합니다.",type:"error"}));return}const L=await $i.post(`/trees/${e}/nodes`,S,{headers:{Authorization:`Bearer ${D}`,"Content-Type":"application/json"}});console.log("[Add Node] API 응답 성공! 응답 데이터:",L.data);const N={id:L.data._id||L.data.nodeId,type:"custom",position:{x:100,y:100},data:L.data.data||S};if(!N.id){console.error("[Add Node] 오류: 백엔드 응답에서 노드 ID를 찾을 수 없습니다!");return}d(M=>[...M,N]),console.log("[Add Node] setNodes 호출 완료!")}catch(D){console.error("[Add Node] 노드 생성 실패:",D),n(ze({_id:Date.now().toString(),message:"노드 생성 실패",type:"error"}))}},[e,d,n]),B=f.useCallback(async S=>{if(console.log("handlePaneDoubleClick 함수 호출됨!",S),!r||!e)return;console.log("React Flow 인스턴스:",r);const D=r.screenToFlowPosition({x:S.clientX,y:S.clientY});console.log("계산된 노드 위치:",D);const L={label:"노드추가",content:"내용을 입력하세요",videoTitle:"",videoUrl:"",description:"",likes:[],comments:[],mediaImages:[],mediaVideos:[]};try{const N=Ti();if(!N){console.error("오류: 인증 토큰이 없습니다."),n(ze({_id:Date.now().toString(),message:"로그인이 필요합니다.",type:"error"}));return}const M=await $i.post(`/trees/${e}/nodes`,L,{headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"}});console.log("[Double Click] API 응답 성공! 응답 데이터:",M.data);const F={id:M.data._id||M.data.nodeId,type:"custom",position:D,data:M.data.data||L};if(console.log("[Double Click] setNodes 호출 직전, newNode 객체:",F),!F.id){console.error("[Double Click] 오류: 백엔드 응답에서 노드 ID를 찾을 수 없습니다!");return}d(O=>[...O,F])}catch(N){console.error("[Double Click] 노드 생성 실패:",N),n(ze({_id:Date.now().toString(),message:"노드 생성 실패",type:"error"}))}},[r,e,d,n]),H=f.useCallback(S=>{g(S)},[g]),m=f.useCallback(S=>{p(S)},[p]),T=f.useCallback(S=>{d(D=>D.filter(L=>L.id!==S)),v(D=>D.filter(L=>L.source!==S&&L.target!==S)),b(null),E(!1),n(ze({_id:Date.now().toString(),message:"Node deleted.",type:"info"}))},[d,v,n]);return s==="pending"?C.jsx("div",{className:"p-4 text-center",children:"Loading tree..."}):s==="failed"?C.jsxs("div",{className:"p-4 text-center text-red-500",children:["Error loading tree: ",a]}):i?C.jsxs("div",{className:"tree-edit-container h-[calc(100vh-60px)] p-2 sm:p-4 w-full max-w-full overflow-x-auto",children:[C.jsxs(dl,{nodes:c,edges:h,onNodesChange:H,onEdgesChange:m,onConnect:$,onNodeClick:I,onNodeDoubleClick:k,onDoubleClick:B,onInit:o,nodeTypes:pv,connectionMode:It.Loose,fitView:!0,fitViewOptions:{padding:.2},deleteKeyCode:["Backspace","Delete"],className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-lg min-w-0",children:[C.jsx(Ip,{color:"#aaa",gap:16}),C.jsx(Dp,{}),C.jsx(Qo,{position:"top-right",children:C.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-2 p-2 bg-white rounded-lg shadow min-w-0",children:[C.jsx("button",{onClick:P,className:"w-full sm:w-auto py-2 px-4 text-base bg-green-500 text-white rounded-lg hover:bg-green-600 transition",title:"노드 추가",children:"노드 추가"}),C.jsx("button",{onClick:z,className:"w-full sm:w-auto py-2 px-4 text-base bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition",title:"트리 저장",children:"트리 저장"}),C.jsx("button",{onClick:()=>t(`/trees/${e}`),className:"w-full sm:w-auto py-2 px-4 text-base bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition",title:"트리 보기",children:"트리 보기"})]})})]}),y&&C.jsx(nc,{node:y,onClose:()=>b(null),onSave:A,isEdit:w,onToggleEdit:()=>E(S=>!S),onDelete:T})]}):C.jsx("div",{className:"p-4 text-center",children:"Tree not found."})};export{wv as default};
//# sourceMappingURL=TreeEdit-B6cD8XCD.js.map

import{c as L,d as j,j as e,s as le,q as ce,r as f,t as de,R as b,v as _,w as ue,x as he,y as q,z as fe,L as Q,A as me,B as pe,C as xe,D as ge,E as B,u as ve,a as be,F as je,G as Y,H as Z,I as Ne,J as Ee}from"./index-Bv4-c3_I.js";const we=()=>{const t=L(),{sortBy:r}=j(s=>s.posts),c=s=>{t(le(s.target.value))};return e.jsx("div",{className:"mb-4",children:e.jsxs("select",{value:r,onChange:c,className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"latest",children:"최신순"}),e.jsx("option",{value:"popular",children:"인기순"}),e.jsx("option",{value:"oldest",children:"오래된순"})]})})},ye=[{value:"all",label:"전체"},{value:"일상",label:"일상"},{value:"여행",label:"여행"},{value:"음식",label:"음식"},{value:"취미",label:"취미"},{value:"스포츠",label:"스포츠"},{value:"IT",label:"IT"},{value:"기타",label:"기타"}],Ce=()=>{const t=L(),{category:r}=j(s=>s.posts),c=s=>{t(ce(s.target.value))};return e.jsx("div",{className:"mb-4",children:e.jsx("select",{value:r,onChange:c,className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:ye.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})})},ke=({post:t,onClose:r})=>{const c=L(),[s,a]=f.useState(t.content),[n,i]=f.useState(null),[o,l]=f.useState(t.image||null),d=f.useRef(null);f.useEffect(()=>{a(t.content),l(t.image||null)},[t]);const m=async g=>{if(g.preventDefault(),!s.trim())return;const x=new FormData;x.append("content",s),n&&x.append("image",n);try{await c(de({id:t.id,formData:x})).unwrap(),r()}catch(E){console.error("게시물 수정 실패:",E)}},p=g=>{var E;const x=(E=g.target.files)==null?void 0:E[0];if(x){i(x);const w=new FileReader;w.onloadend=()=>{l(w.result)},w.readAsDataURL(x)}},u=()=>{i(null),l(null),d.current&&(d.current.value="")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 w-full max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"게시물 수정"}),e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:m,children:[e.jsx("textarea",{value:s,onChange:g=>a(g.target.value),placeholder:"무슨 생각을 하고 계신가요?",className:"w-full p-2 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4}),o&&e.jsxs("div",{className:"relative mb-4",children:[e.jsx("img",{src:o,alt:"미리보기",className:"w-full rounded-lg",loading:"lazy"}),e.jsx("button",{type:"button",onClick:u,className:"absolute top-2 right-2 p-1 bg-black bg-opacity-50 rounded-full text-white hover:bg-opacity-70",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:p,ref:d,className:"hidden",id:"image-upload"}),e.jsx("label",{htmlFor:"image-upload",className:"p-2 text-gray-500 hover:text-blue-500 cursor-pointer",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"취소"}),e.jsx("button",{type:"submit",disabled:!s.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-300",children:"수정하기"})]})]})]})]})})};function Se({title:t,titleId:r,...c},s){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},c),t?f.createElement("title",{id:r},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Le=f.forwardRef(Se);function A(){return A=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var c=arguments[r];for(var s in c)({}).hasOwnProperty.call(c,s)&&(t[s]=c[s])}return t},A.apply(null,arguments)}function W(t,r){if(t==null)return{};var c={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(r.indexOf(s)!==-1)continue;c[s]=t[s]}return c}function z(t,r){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,s){return c.__proto__=s,c},z(t,r)}function G(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,z(t,r)}function Te(t,r){return t.classList?!!r&&t.classList.contains(r):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+r+" ")!==-1}function Oe(t,r){t.classList?t.classList.add(r):Te(t,r)||(typeof t.className=="string"?t.className=t.className+" "+r:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+r))}function K(t,r){return t.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Pe(t,r){t.classList?t.classList.remove(r):typeof t.className=="string"?t.className=K(t.className,r):t.setAttribute("class",K(t.className&&t.className.baseVal||"",r))}const ee={disabled:!1},$=b.createContext(null);var te=function(r){return r.scrollTop},R="unmounted",C="exited",k="entering",P="entered",V="exiting",N=function(t){G(r,t);function r(s,a){var n;n=t.call(this,s,a)||this;var i=a,o=i&&!i.isMounting?s.enter:s.appear,l;return n.appearStatus=null,s.in?o?(l=C,n.appearStatus=k):l=P:s.unmountOnExit||s.mountOnEnter?l=R:l=C,n.state={status:l},n.nextCallback=null,n}r.getDerivedStateFromProps=function(a,n){var i=a.in;return i&&n.status===R?{status:C}:null};var c=r.prototype;return c.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},c.componentDidUpdate=function(a){var n=null;if(a!==this.props){var i=this.state.status;this.props.in?i!==k&&i!==P&&(n=k):(i===k||i===P)&&(n=V)}this.updateStatus(!1,n)},c.componentWillUnmount=function(){this.cancelNextCallback()},c.getTimeouts=function(){var a=this.props.timeout,n,i,o;return n=i=o=a,a!=null&&typeof a!="number"&&(n=a.exit,i=a.enter,o=a.appear!==void 0?a.appear:i),{exit:n,enter:i,appear:o}},c.updateStatus=function(a,n){if(a===void 0&&(a=!1),n!==null)if(this.cancelNextCallback(),n===k){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:_.findDOMNode(this);i&&te(i)}this.performEnter(a)}else this.performExit();else this.props.unmountOnExit&&this.state.status===C&&this.setState({status:R})},c.performEnter=function(a){var n=this,i=this.props.enter,o=this.context?this.context.isMounting:a,l=this.props.nodeRef?[o]:[_.findDOMNode(this),o],d=l[0],m=l[1],p=this.getTimeouts(),u=o?p.appear:p.enter;if(!a&&!i||ee.disabled){this.safeSetState({status:P},function(){n.props.onEntered(d)});return}this.props.onEnter(d,m),this.safeSetState({status:k},function(){n.props.onEntering(d,m),n.onTransitionEnd(u,function(){n.safeSetState({status:P},function(){n.props.onEntered(d,m)})})})},c.performExit=function(){var a=this,n=this.props.exit,i=this.getTimeouts(),o=this.props.nodeRef?void 0:_.findDOMNode(this);if(!n||ee.disabled){this.safeSetState({status:C},function(){a.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:V},function(){a.props.onExiting(o),a.onTransitionEnd(i.exit,function(){a.safeSetState({status:C},function(){a.props.onExited(o)})})})},c.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},c.safeSetState=function(a,n){n=this.setNextCallback(n),this.setState(a,n)},c.setNextCallback=function(a){var n=this,i=!0;return this.nextCallback=function(o){i&&(i=!1,n.nextCallback=null,a(o))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},c.onTransitionEnd=function(a,n){this.setNextCallback(n);var i=this.props.nodeRef?this.props.nodeRef.current:_.findDOMNode(this),o=a==null&&!this.props.addEndListener;if(!i||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],d=l[0],m=l[1];this.props.addEndListener(d,m)}a!=null&&setTimeout(this.nextCallback,a)},c.render=function(){var a=this.state.status;if(a===R)return null;var n=this.props,i=n.children;n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef;var o=W(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return b.createElement($.Provider,{value:null},typeof i=="function"?i(a,o):b.cloneElement(b.Children.only(i),o))},r}(b.Component);N.contextType=$;N.propTypes={};function O(){}N.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:O,onEntering:O,onEntered:O,onExit:O,onExiting:O,onExited:O};N.UNMOUNTED=R;N.EXITED=C;N.ENTERING=k;N.ENTERED=P;N.EXITING=V;var De=function(r,c){return r&&c&&c.split(" ").forEach(function(s){return Oe(r,s)})},U=function(r,c){return r&&c&&c.split(" ").forEach(function(s){return Pe(r,s)})},H=function(t){G(r,t);function r(){for(var s,a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=t.call.apply(t,[this].concat(n))||this,s.appliedClasses={appear:{},enter:{},exit:{}},s.onEnter=function(o,l){var d=s.resolveArguments(o,l),m=d[0],p=d[1];s.removeClasses(m,"exit"),s.addClass(m,p?"appear":"enter","base"),s.props.onEnter&&s.props.onEnter(o,l)},s.onEntering=function(o,l){var d=s.resolveArguments(o,l),m=d[0],p=d[1],u=p?"appear":"enter";s.addClass(m,u,"active"),s.props.onEntering&&s.props.onEntering(o,l)},s.onEntered=function(o,l){var d=s.resolveArguments(o,l),m=d[0],p=d[1],u=p?"appear":"enter";s.removeClasses(m,u),s.addClass(m,u,"done"),s.props.onEntered&&s.props.onEntered(o,l)},s.onExit=function(o){var l=s.resolveArguments(o),d=l[0];s.removeClasses(d,"appear"),s.removeClasses(d,"enter"),s.addClass(d,"exit","base"),s.props.onExit&&s.props.onExit(o)},s.onExiting=function(o){var l=s.resolveArguments(o),d=l[0];s.addClass(d,"exit","active"),s.props.onExiting&&s.props.onExiting(o)},s.onExited=function(o){var l=s.resolveArguments(o),d=l[0];s.removeClasses(d,"exit"),s.addClass(d,"exit","done"),s.props.onExited&&s.props.onExited(o)},s.resolveArguments=function(o,l){return s.props.nodeRef?[s.props.nodeRef.current,o]:[o,l]},s.getClassNames=function(o){var l=s.props.classNames,d=typeof l=="string",m=d&&l?l+"-":"",p=d?""+m+o:l[o],u=d?p+"-active":l[o+"Active"],g=d?p+"-done":l[o+"Done"];return{baseClassName:p,activeClassName:u,doneClassName:g}},s}var c=r.prototype;return c.addClass=function(a,n,i){var o=this.getClassNames(n)[i+"ClassName"],l=this.getClassNames("enter"),d=l.doneClassName;n==="appear"&&i==="done"&&d&&(o+=" "+d),i==="active"&&a&&te(a),o&&(this.appliedClasses[n][i]=o,De(a,o))},c.removeClasses=function(a,n){var i=this.appliedClasses[n],o=i.base,l=i.active,d=i.done;this.appliedClasses[n]={},o&&U(a,o),l&&U(a,l),d&&U(a,d)},c.render=function(){var a=this.props;a.classNames;var n=W(a,["classNames"]);return b.createElement(N,A({},n,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},r}(b.Component);H.defaultProps={classNames:""};H.propTypes={};function Re(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X(t,r){var c=function(n){return r&&f.isValidElement(n)?r(n):n},s=Object.create(null);return t&&f.Children.map(t,function(a){return a}).forEach(function(a){s[a.key]=c(a)}),s}function Ie(t,r){t=t||{},r=r||{};function c(m){return m in r?r[m]:t[m]}var s=Object.create(null),a=[];for(var n in t)n in r?a.length&&(s[n]=a,a=[]):a.push(n);var i,o={};for(var l in r){if(s[l])for(i=0;i<s[l].length;i++){var d=s[l][i];o[s[l][i]]=c(d)}o[l]=c(l)}for(i=0;i<a.length;i++)o[a[i]]=c(a[i]);return o}function S(t,r,c){return c[r]!=null?c[r]:t.props[r]}function Me(t,r){return X(t.children,function(c){return f.cloneElement(c,{onExited:r.bind(null,c),in:!0,appear:S(c,"appear",t),enter:S(c,"enter",t),exit:S(c,"exit",t)})})}function _e(t,r,c){var s=X(t.children),a=Ie(r,s);return Object.keys(a).forEach(function(n){var i=a[n];if(f.isValidElement(i)){var o=n in r,l=n in s,d=r[n],m=f.isValidElement(d)&&!d.props.in;l&&(!o||m)?a[n]=f.cloneElement(i,{onExited:c.bind(null,i),in:!0,exit:S(i,"exit",t),enter:S(i,"enter",t)}):!l&&o&&!m?a[n]=f.cloneElement(i,{in:!1}):l&&o&&f.isValidElement(d)&&(a[n]=f.cloneElement(i,{onExited:c.bind(null,i),in:d.props.in,exit:S(i,"exit",t),enter:S(i,"enter",t)}))}}),a}var Ae=Object.values||function(t){return Object.keys(t).map(function(r){return t[r]})},$e={component:"div",childFactory:function(r){return r}},J=function(t){G(r,t);function r(s,a){var n;n=t.call(this,s,a)||this;var i=n.handleExited.bind(Re(n));return n.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},n}var c=r.prototype;return c.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},c.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(a,n){var i=n.children,o=n.handleExited,l=n.firstRender;return{children:l?Me(a,o):_e(a,i,o),firstRender:!1}},c.handleExited=function(a,n){var i=X(this.props.children);a.key in i||(a.props.onExited&&a.props.onExited(n),this.mounted&&this.setState(function(o){var l=A({},o.children);return delete l[a.key],{children:l}}))},c.render=function(){var a=this.props,n=a.component,i=a.childFactory,o=W(a,["component","childFactory"]),l=this.state.contextValue,d=Ae(this.state.children).map(i);return delete o.appear,delete o.enter,delete o.exit,n===null?b.createElement($.Provider,{value:l},d):b.createElement($.Provider,{value:l},b.createElement(n,o,d))},r}(b.Component);J.propTypes={};J.defaultProps=$e;const Fe=({postId:t})=>{const r=L(),{comments:c,status:s}=j(u=>u.comments),{user:a}=j(u=>u.auth),[n,i]=f.useState(""),o=b.useRef(null),l=b.useRef(null);f.useEffect(()=>{r(ue(t))},[r,t]);const d=async u=>{if(u.preventDefault(),!!n.trim())try{await r(he({content:n,postId:t})).unwrap(),i(""),q.success("댓글이 등록되었습니다!",{position:"bottom-right",autoClose:1200,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!1,progress:void 0,icon:"💬",style:{fontWeight:500,fontSize:"1rem"}}),o.current&&o.current.focus()}catch{q.error("댓글 등록에 실패했습니다.",{position:"bottom-right",autoClose:1500,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!1,progress:void 0,icon:"❌",style:{fontWeight:500,fontSize:"1rem"}})}},m=async u=>{window.confirm("댓글을 삭제하시겠습니까?")&&await r(fe(u))},p=u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),d(u))};return f.useEffect(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[c]),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"댓글"}),e.jsx("form",{onSubmit:d,className:"mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("input",{ref:o,type:"text",value:n,onChange:u=>i(u.target.value),onKeyDown:p,placeholder:"댓글을 입력하세요... (Enter: 전송, Shift+Enter: 줄바꿈)",className:"flex-1 border rounded-l-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200 shadow-sm bg-white"}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-r-lg hover:bg-blue-600 active:scale-95 transition-transform duration-150 shadow",children:"작성"})]})}),s==="loading"?e.jsx("div",{className:"text-center py-4",children:"댓글을 불러오는 중..."}):c.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"아직 댓글이 없습니다."}):e.jsx("div",{ref:l,className:"space-y-4 max-h-80 overflow-y-auto pr-2",children:e.jsx(J,{children:c.map(u=>e.jsx(H,{timeout:300,classNames:"fade",children:e.jsxs("div",{className:"flex items-start space-x-3 bg-gray-50 rounded-xl shadow p-3 transition-all duration-200 hover:shadow-md",children:[e.jsx("img",{src:u.author.profileImage||"/default-profile.png",alt:u.author.username,className:"w-8 h-8 rounded-full border border-gray-200 shadow-sm"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-blue-700",children:u.author.username}),e.jsx("p",{className:"mt-1 text-gray-800 break-words",children:u.content})]}),(a==null?void 0:a._id)===u.author._id&&e.jsx("button",{onClick:()=>m(u._id),className:"text-gray-400 hover:text-red-500 transition-colors duration-150","aria-label":"댓글 삭제",children:e.jsx(Le,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:new Date(u.createdAt).toLocaleString()})]})]})},u._id))})})]})},Ue=({post:t,currentUserId:r})=>{const c=L(),{user:s}=j(x=>x.auth),[a,n]=f.useState(!1),[i,o]=f.useState(!1),l=t.likes.includes((s==null?void 0:s._id)||""),d=async()=>{await c(xe(t.id))},m=()=>{window.confirm("정말로 이 게시물을 삭제하시겠습니까?")&&c(pe(t.id))},p=()=>{n(!0)},u=()=>{n(!1)},g=()=>{o(!i)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Q,{to:`/profile/${t.author.id}`,children:e.jsx("img",{src:t.author.profileImage||"/default-profile.png",alt:t.author.username,className:"w-10 h-10 rounded-full mr-3"})}),e.jsxs("div",{children:[e.jsx(Q,{to:`/profile/${t.author.id}`,className:"font-semibold hover:underline",children:t.author.username}),e.jsx("p",{className:"text-gray-500 text-sm",children:me(new Date(t.createdAt),{addSuffix:!0,locale:ge})})]}),t.author.id===r&&e.jsxs("div",{className:"ml-auto flex space-x-2",children:[e.jsx("button",{onClick:p,className:"text-blue-500 hover:text-blue-700",children:"수정"}),e.jsx("button",{onClick:m,className:"text-red-500 hover:text-red-700",children:"삭제"})]})]}),e.jsx("p",{className:"mb-4",children:t.content}),t.image&&e.jsx("img",{src:t.image,alt:"게시물 이미지",className:"w-full rounded-lg mb-4"}),e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsxs("button",{onClick:d,className:`flex items-center ${l?"text-red-500":"text-gray-500"}`,children:[e.jsx("svg",{className:"w-5 h-5 mr-1",fill:l?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),t.likes.length]}),e.jsxs("button",{onClick:g,className:"flex items-center hover:text-blue-500",children:[e.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),t.comments.length]})]}),i&&e.jsx(Fe,{postId:t.id,currentUserId:r})]}),a&&e.jsx(ke,{post:{id:t.id,content:t.content,image:t.image},onClose:u})]})},Be=()=>{const t=L(),{posts:r,currentPage:c,totalPages:s,sortBy:a,category:n,status:i}=j(l=>l.posts);f.useEffect(()=>{t(B({page:c,sortBy:a,category:n}))},[t,c,a,n]);const o=()=>{c<s&&t(B({page:c+1,sortBy:a,category:n}))};return i==="loading"&&r.length===0?e.jsx("div",{children:"로딩 중..."}):e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx(we,{}),e.jsx(Ce,{})]}),e.jsx("div",{className:"space-y-4",children:r.map(l=>e.jsx(Ue,{post:l},l._id))}),c<s&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:o,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"더 보기"})})]})},Ve=()=>{const{userId:t}=ve();be();const r=L(),{user:c}=j(h=>h.auth),{userPosts:s,status:a}=j(h=>h.posts),{followers:n,following:i,status:o}=j(h=>h.follow),[l,d]=f.useState(null),[m,p]=f.useState(!0),[u,g]=f.useState(null),[x,E]=f.useState("posts"),[w,F]=f.useState(!1),[I,D]=f.useState({username:"",bio:"",profileImage:""});f.useEffect(()=>{(async()=>{if(t){p(!0),g(null);try{console.log("프로필 데이터 로딩 시작:",t);const v=await fetch(`/api/users/${t}`);if(!v.ok)throw new Error("사용자 정보를 가져오는데 실패했습니다.");const y=await v.json();d(y),D({username:y.username,bio:y.bio||"",profileImage:y.profileImage||""}),await Promise.all([r(B({})),r(Y(t)),r(Z(t))]),console.log("프로필 데이터 로딩 완료")}catch(v){console.error("프로필 데이터 로딩 실패:",v),g(v instanceof Error?v.message:"알 수 없는 오류가 발생했습니다.")}finally{p(!1)}}})()},[r,t]);const se=async()=>{if(t)try{console.log("팔로우/언팔로우 시도:",{userId:t,isFollowing:M}),M?(await r(Ne(t)),console.log("언팔로우 성공")):(await r(Ee(t)),console.log("팔로우 성공")),await Promise.all([r(Y(t)),r(Z(t))])}catch(h){console.error("팔로우/언팔로우 실패:",h)}},ne=async()=>{if(t)try{const h=await fetch(`/api/users/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(I)});if(!h.ok)throw new Error("프로필 수정에 실패했습니다.");const v=await h.json();d(v),F(!1)}catch(h){console.error("프로필 수정 실패:",h),g(h instanceof Error?h.message:"프로필 수정 중 오류가 발생했습니다.")}},re=async h=>{if(!h.target.files||!h.target.files[0])return;const v=h.target.files[0],y=new FormData;y.append("image",v);try{const T=await fetch("/api/upload",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:y});if(!T.ok)throw new Error("이미지 업로드에 실패했습니다.");const ie=await T.json();D(oe=>({...oe,profileImage:ie.url}))}catch(T){console.error("이미지 업로드 실패:",T),g(T instanceof Error?T.message:"이미지 업로드 중 오류가 발생했습니다.")}};if(m)return e.jsxs("div",{className:"flex flex-col justify-center items-center h-screen",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"프로필을 불러오는 중..."})]});if(u)return e.jsx("div",{className:"flex flex-col justify-center items-center h-screen",children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"오류 발생!"}),e.jsxs("p",{className:"block sm:inline",children:[" ",u]})]})});if(!l)return e.jsx("div",{className:"flex flex-col justify-center items-center h-screen",children:e.jsxs("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded relative",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"알림"}),e.jsx("p",{className:"block sm:inline",children:" 사용자를 찾을 수 없습니다."})]})});const M=n.some(h=>h._id===(c==null?void 0:c._id)),ae=(c==null?void 0:c._id)===t;return e.jsx("div",{className:"profile-container min-h-screen w-full max-w-full p-2 sm:p-4 overflow-x-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 w-full max-w-2xl mx-auto flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:w?I.profileImage:je(l.profileImage),alt:l.username,className:"w-24 h-24 rounded-full mr-6 object-cover","data-type":"profile",loading:"lazy"}),w&&e.jsxs("label",{className:"absolute bottom-0 right-0 bg-blue-500 text-white p-1 rounded-full cursor-pointer hover:bg-blue-600",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:re,className:"hidden"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})]})]}),e.jsx("div",{className:"flex-1",children:w?e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:I.username,onChange:h=>D(v=>({...v,username:h.target.value})),className:"w-full px-3 py-2 border rounded-md",placeholder:"사용자 이름"}),e.jsx("textarea",{value:I.bio,onChange:h=>D(v=>({...v,bio:h.target.value})),className:"w-full px-3 py-2 border rounded-md",placeholder:"자기 소개",rows:3}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:ne,className:"w-full sm:w-auto py-2 px-4 text-base bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"저장"}),e.jsx("button",{onClick:()=>{F(!1),D({username:l.username,bio:l.bio||"",profileImage:l.profileImage||""})},className:"w-full sm:w-auto py-2 px-4 text-base bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"취소"})]})]}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:l.username}),e.jsx("p",{className:"text-gray-600 mb-4",children:l.bio||"소개글이 없습니다."}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:s.length})," 게시물"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:n.length})," 팔로워"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:i.length})," 팔로잉"]})]}),ae?e.jsx("button",{onClick:()=>F(!0),className:"w-full sm:w-auto py-2 px-4 text-base bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"프로필 편집"}):e.jsx("button",{onClick:se,className:`w-full sm:w-auto py-2 px-4 text-base rounded-lg ${M?"bg-gray-500 text-white hover:bg-gray-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:M?"언팔로우":"팔로우"})]})})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>E("posts"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${x==="posts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"게시물"}),e.jsx("button",{onClick:()=>E("followers"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${x==="followers"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"팔로워"}),e.jsx("button",{onClick:()=>E("following"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${x==="following"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"팔로잉"})]})}),x==="posts"&&(a==="loading"?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):e.jsx(Be,{posts:s})),x==="followers"&&(o==="loading"?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(h=>e.jsxs("div",{className:"flex items-center p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow duration-200",children:[e.jsx("img",{src:h.profileImage||"/default-profile.png",alt:h.username,className:"w-12 h-12 rounded-full mr-4 object-cover"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:h.username}),e.jsx("p",{className:"text-sm text-gray-500",children:h.bio?h.bio.substring(0,50)+"...":"소개글이 없습니다."})]})]},h._id))})),x==="following"&&(o==="loading"?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(h=>e.jsxs("div",{className:"flex items-center p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow duration-200",children:[e.jsx("img",{src:h.profileImage||"/default-profile.png",alt:h.username,className:"w-12 h-12 rounded-full mr-4 object-cover"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:h.username}),e.jsx("p",{className:"text-sm text-gray-500",children:h.bio?h.bio.substring(0,50)+"...":"소개글이 없습니다."})]})]},h._id))}))]})})};export{Ve as default};
//# sourceMappingURL=Profile-T5zxatCX.js.map
